(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[8],{74726:(e,t,r)=>{"use strict";r.d(t,{_c:()=>a,do:()=>c});var n=r(22122),o=r(92950),i=r.n(o),l=(r(20936),r(30586)),a=function(e){return i().createElement(l.TextInput,(0,n.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))},c=function(e){return i().createElement(l.TextArea,(0,n.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))}},25870:(e,t,r)=>{"use strict";r.d(t,{$9:()=>m,GC:()=>d,Jr:()=>b,zb:()=>E,KH:()=>O,PS:()=>P});var n=r(92950),o=r.n(n),i=r(45697),l=r.n(i),a=r(30586),c=r(68778),s=r(43047),u=r(69957),p=r(73479),f={title:l().string,identifier:l().object,profile:l().object,compliant:l().bool,remediationAvailable:l().bool,severity:l().string},m=function(e){var t=e.title,r=e.identifier;return o().createElement(a.TextContent,null,t,r?o().createElement(a.Text,{component:a.TextVariants.small},r.label):"")};m.propTypes=f;var d=function(e){return e.profile.name};d.propTypes=f;var h=function(){return o().createElement("span",null,o().createElement(s.ZP,{className:"ins-u-failed"})," High")},y=function(){return o().createElement("span",null,o().createElement(u.ZP,{className:"ins-u-warning"})," Medium")},b=function(){return o().createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",role:"img",style:{verticalAlign:"-0.125em"},xmlns:"http://www.w3.org/2000/svg"},o().createElement("path",{d:"M2 0h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm6.67 10.46a1.67 1.67 0 1 0 0 3.338 1.67 1.67 0 0 0 0-3.338zm-1.586-6l.27 4.935a.435.435 0 0 0 .434.411H9.55c.232 0 .422-.18.435-.411l.27-4.936A.435.435 0 0 0 9.818 4h-2.3c-.25 0-.448.21-.435.46z",fill:"#3A9CA6",fillRule:"evenodd"}))},v=function(){return o().createElement("span",null,o().createElement(b,null)," Low")},g=function(){return o().createElement("span",null,o().createElement(p.ZP,null)," Unknown")},E=function(e){var t=e.severity;return{high:o().createElement(h,null),medium:o().createElement(y,null),low:o().createElement(v,null)}[null==t?void 0:t.toLowerCase()]||o().createElement(g,null)};E.propTypes=f;var O=function(e){return e.compliant?o().createElement(c.ZP,{className:"ins-u-passed"}):o().createElement(s.ZP,{className:"ins-u-failed"})};O.propTypes=f;var P=function(e){return e.remediationAvailable?o().createElement(c.ZP,{className:"ins-u-passed"}):"No"};P.propTypes=f},94263:(e,t,r)=>{"use strict";r.d(t,{VG:()=>s,GC:()=>u,zb:()=>p,KH:()=>f,PS:()=>m});var n=r(92950),o=r.n(n),i=r(24985),l=r(16712),a=r(79886),c=r(25870),s={title:"Name",sortByProp:"title",renderFunc:(0,a.SO)(c.$9)},u={title:"Policy",sortByFunction:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderFunc:(0,a.SO)(c.GC)},p={title:"Severity",sortByProp:"severity",transforms:[i.fitContent],sortByArray:["high","medium","low","unknown"],renderFunc:(0,a.SO)(c.zb)},f={title:"Passed",sortByProp:"compliant",renderFunc:(0,a.SO)(c.KH)},m={title:o().createElement("span",null,o().createElement(l.ZP,null)," Ansible"),original:"Ansible",props:{tooltip:"Ansible"},transforms:[i.fitContent],sortByProp:"remediationAvailable",renderFunc:(0,a.SO)(c.PS)}},10530:(e,t,r)=>{"use strict";r.d(t,{Hv:()=>L,uU:()=>V,TB:()=>F,b4:()=>k});var n=r(85061),o=r(81253),i=r(92950),l=r.n(i),a=r(45697),c=r.n(a),s=r(30586),u=r(59722),p=r(22122),f=r(32465),m=r(46829),d=r(33121),h=r(91290),y=r(11443);const b=function(e){var t=e.profile,r=e.newOsMinorVersion;return"RHEL".concat(" ",t.osMajorVersion,".").concat(t.osMinorVersion||r)};var v,g=function(e){var t=e.count,r=void 0===t?0:t;return l().createElement(s.Badge,{isRead:!0},"".concat(r," ").concat((0,y._6)(r,"system")))};g.propTypes={profile:c().object,count:c().number};var E=function(e){var t=e.profile,r=e.newOsMinorVersion;return l().createElement(s.Text,{component:s.TextVariants.p},"SSG version: ",t.ssgVersion," ",l().createElement(s.Popover,{position:"right",bodyContent:l().createElement(O,{profile:t,newOsMinorVersion:r}),footerContent:l().createElement(u.bL,null)},l().createElement(h.ZP,{style:{cursor:"pointer"}})))};E.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var O=function(e){var t=e.profile,r=e.newOsMinorVersion;return l().createElement(s.TextContent,{style:{fontSize:"var(--pf-c-popover--FontSize)"}},l().createElement(s.Text,null,"This is the latest supported version of the SCAP Security Guide (SSG) for"," ",l().createElement(b,{profile:t,newOsMinorVersion:r})),l().createElement(s.Text,null,l().createElement(b,{profile:t,newOsMinorVersion:r})," systems assigned to this policy will report using this rule list."))};O.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var P=(0,d.ZP)(v||(v=(0,f.Z)(["\nquery benchmarkQuery($id: String!) {\n    benchmark(id: $id) {\n        id\n        osMajorVersion\n        rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n}\n"]))),w=function(e){var t,r,n=e.profile,o=e.columns,i=e.handleSelect,a=e.systemCount,c=e.selectedRuleRefIds,f=e.rulesTableProps,d=e.newOsMinorVersion,h=(0,m.useQuery)(P,{variables:{id:n.benchmark.id},skip:!i||!(null!==(t=n.benchmark)&&void 0!==t&&t.id)}),y=h.data,v=h.error,O=h.loading,w=i?null==y||null===(r=y.benchmark)||void 0===r?void 0:r.rules:null==n?void 0:n.rules;return l().createElement(l().Fragment,null,l().createElement(s.Grid,null,l().createElement(s.TextContent,{className:"pf-u-mt-md"},l().createElement(s.Text,{component:s.TextVariants.h3},l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(b,{profile:n,newOsMinorVersion:d})),l().createElement(g,{count:a})),l().createElement(E,{profile:n,newOsMinorVersion:d}))),l().createElement(u.tC,{stateValues:{error:v,loading:O,rules:w}},l().createElement(u.K7,{stateKey:"loading"},l().createElement(s.Spinner,null)),l().createElement(u.K7,{stateKey:"rules"},l().createElement(u.iK,(0,p.Z)({remediationAvailableFilter:!0,remediationsEnabled:!1,columns:o,profileRules:[{profile:n,rules:w||[]}],selectedRefIds:c,handleSelect:i&&function(e){return i(n,d,e)}},f)))))};w.propTypes={profile:c().object,newOsMinorVersion:c().string,columns:c().array,handleSelect:c().func,systemCount:c().object,selectedRuleRefIds:c().array,rulesTableProps:c().object};const j=w;var T=r(96156);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,T.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e,t,r){return e.id===t.id&&e.osMinorVersion===(r||t.osMinorVersion)},S=function(e,t,r){var n=(e||[]).find((function(e){return Z(e,t,r)}));return(null==n?void 0:n.ruleRefIds)||[]},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.only,i=e.map((function(e){var r,n=t.find((function(t){return Z(t,e)}));return n?o?n:void 0:(e.rules||console.error("Profile ".concat(e.id," is missing rules for selection!")),e.osMinorVersion||console.error("Profile ".concat(e.id," is missing osMinorVersion for selection!")),{id:e.id,osMinorVersion:e.osMinorVersion,ruleRefIds:(null===(r=e.rules)||void 0===r?void 0:r.map((function(e){return e.refId})))||[]})})).filter((function(e){return!!e}));return o?i:[].concat((0,n.Z)(t),(0,n.Z)(i))},k=function(e){var t={};return e.forEach((function(e){var r=e.profile,o=e.newOsMinorVersion;if(null!=r&&r.id){var i=o||r.osMinorVersion;t[r.id]=[].concat((0,n.Z)(t[r.id]||[]),[i])}})),t},V=function(e,t){return e.flatMap((function(e){return(t[e.id]||[void 0]).map((function(t){return C(C({},e),{},{osMinorVersion:t})}))}))},R=["tabsData","defaultTab","selectedRuleRefIds","setSelectedRuleRefIds","columns","level"],I=function(e,t){var r=e.id,n=e.osMinorVersion;return"rules-".concat(r,"-").concat(n||t)},B=function(e,t){if(e&&0!==e.length){if(!t){var r=e[0];t={id:r.profile.id,osMinorVersion:r.profile.osMinorVersion||r.newOsMinorVersion}}return I(t)}},D=function(e){var t=e.tabsData,r=e.defaultTab,i=e.selectedRuleRefIds,a=e.setSelectedRuleRefIds,c=e.columns,p=e.level,f=void 0===p?0:p,m=(0,o.Z)(e,R),d=function(e,t,r){var o=(i||[]).filter((function(r){return!Z(r,e,t)})),l={id:e.id,osMinorVersion:t||e.osMinorVersion,ruleRefIds:r};a([l].concat((0,n.Z)(o)))};return l().createElement(u.tn,{level:f,defaultTab:B(t,r)},null==t?void 0:t.map((function(e){var t=e.profile,r=e.newOsMinorVersion,n=e.systemCount;return l().createElement(s.Tab,{key:I(t,r),eventKey:I(t,r),title:l().createElement("span",null,l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(b,{profile:t,newOsMinorVersion:r})),l().createElement(s.Badge,{isRead:!0},n))},l().createElement(j,{profile:t,newOsMinorVersion:r,columns:c,rulesTableProps:m,systemCount:n,selectedRuleRefIds:S(i,t,r),handleSelect:a?d:void 0}))})))};D.propTypes={tabsData:c().arrayOf(c().shape({profile:c().object.isRequired,selectedRuleRefIds:c().arrayOf(c().string),newOsMinorVersion:c().string,systemCount:c().number})).isRequired,selectedRuleRefIds:c().arrayOf(c().shape({id:c().string,ruleRefIds:c().arrayOf(c().string)})),setSelectedRuleRefIds:c().func,columns:c().arrayOf(c().object),defaultTab:c().shape({id:c().string,osMinorVersion:c().string}),level:c().number};const L=D},59722:(e,t,r)=>{"use strict";r.d(t,{mR:()=>we,MU:()=>Ze,OF:()=>I,X8:()=>ne,mf:()=>E,AY:()=>P,Ir:()=>s,JS:()=>It,x$:()=>Vt,V_:()=>ut,xB:()=>ze,PL:()=>D,NP:()=>q,o$:()=>Ge,w8:()=>Ke,_z:()=>bt,yL:()=>Z,ko:()=>ee,Tq:()=>L,vu:()=>$,vm:()=>qe,Ek:()=>He,Jm:()=>ie,tn:()=>le,iK:()=>$r,Se:()=>se,K7:()=>ae,tC:()=>ue,Zr:()=>Ft,bL:()=>Et,UN:()=>de,Hv:()=>Rt.Hv,cT:()=>Zt,Vs:()=>pe,fz:()=>be,Oq:()=>R,fQ:()=>We});var n={};r.r(n),r.d(n,{mR:()=>we,MU:()=>Ze,OF:()=>I,X8:()=>ne,mf:()=>E,AY:()=>P,Ir:()=>s,JS:()=>It,x$:()=>Vt,V_:()=>ut,xB:()=>ze,PL:()=>D,NP:()=>q,o$:()=>Ge,w8:()=>Ke,_z:()=>bt,yL:()=>Z,ko:()=>ee,Tq:()=>L,vu:()=>$,vm:()=>qe,Ek:()=>He,Jm:()=>ie,tn:()=>le,iK:()=>$r,Se:()=>se,K7:()=>ae,tC:()=>ue,Zr:()=>Ft,bL:()=>Et,UN:()=>de,Hv:()=>Rt.Hv,cT:()=>Zt,Vs:()=>pe,fz:()=>be,Oq:()=>R,fQ:()=>We});var o=r(85061),i=r(92950),l=r.n(i),a=r(24985),c=r(96541);const s=function(){return l().createElement(a.Table,{"aria-label":"policies-table",ouiaId:"PoliciesTable",cells:[{title:"Policy name"},{title:"Operating system"},{title:"Systems"},{title:"Business initiative"},{title:"Compliance threshold"}],rows:(0,o.Z)(Array(5)).map((function(){return{cells:[{title:l().createElement(c.Z,null),colSpan:5}]}}))},l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null))};var u=r(22122),p=r(81253),f=r(45697),m=r.n(f),d=r(30586),h=r(43047),y=r(98446),b=r(27839),v=["error"],g=function(e){var t=e.error,r=(0,p.Z)(e,v);return t.networkError&&401===t.networkError.statusCode?(window.insights.chrome.auth.logout(!0),!1):t.networkError&&403===t.networkError.statusCode?l().createElement(b.Z,{serviceName:"Compliance"}):t.networkError&&404===t.networkError.statusCode?l().createElement(y.Z,null):l().createElement("section",(0,u.Z)({},r,{className:"pf-l-page__main-section pf-c-page__main-section ins-c-component_invalid-componet"}),l().createElement(h.ZP,{size:"xl",style:{color:"var(--pf-global--danger-color--100)"}}),l().createElement(d.Title,{headingLevel:"h1"},"There was an error"),l().createElement(d.Text,null,"If you need to contact Red Hat Support about this, this is the exact error:",l().createElement(d.Text,null,t.message)),l().createElement(d.Button,{variant:"link",ouiaId:"ErrorPageGoBackButton",onClick:history.goBack},"Go back"))};g.propTypes={error:m().object};const E=g;var O=function(e){var t=e.children;return l().createElement(d.Text,{style:{color:"var(--pf-global--Color--200)"},component:d.TextVariants.small},t)};O.propTypes={children:m().node};const P=O;var w=r(6455),j=function(e){var t=e.input,r=e.options,n=t.name,i=t.onChange,a=t.value;return l().createElement(l().Fragment,null,r.map((function(e,t){var r=e.label,c=e.value,s=e.defaultChecked;return l().createElement(d.Checkbox,{key:c,id:c,label:r,name:"".concat(n,"[").concat(t,"]"),value:c,isChecked:""===a?s:a.includes(c),onChange:function(e){return function(e,t){var r=(0,o.Z)(new Set(a));return e?r.push(t):r.splice(r.indexOf(t),1),i(r)}(e,c)}})})))};j.propTypes={input:m().shape({name:m().string.isRequired,onChange:m().func,value:m().string}),options:m().arrayOf(m().shape({label:m().string.isRequired,value:m().string.isRequired,defaultChecked:m().bool})).isRequired};m().arrayOf(m().shape({label:m().string.isRequired,value:m().string.isRequired,defaultChecked:m().bool})).isRequired;var T=r(50500),x=function(){return l().createElement(d.Tooltip,{position:"right",content:"A policy of this type is already in use. Only one policy per policy type can be created for a major release of RHEL."},l().createElement(d.Label,{style:{lineHeight:"1.5em"}},"In use"))},C=function(e){var t=e.profiles,r=e.onClick;return l().createElement(l().Fragment,null,0===(null==t?void 0:t.length)&&l().createElement(d.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(d.Text,null,"Select an operating system to view policy types.")),l().createElement(d.Grid,{hasGutter:!0},t.map((function(e){var t=e.description,n=e.name,o=e.id,i=e.disabled;return l().createElement(l().Fragment,{key:"profile-select-".concat(o)},l().createElement(d.GridItem,{span:8,rowSpan:2},l().createElement(d.TextContent,{style:{lineHeight:"2em",color:i?"var(--pf-c-content--blockquote--Color)":""}},l().createElement(d.Text,null,l().createElement(w.Z,{component:"input",type:"radio",name:"profile",value:JSON.stringify(e),onClick:function(){return r(JSON.stringify(e))},disabled:i})," ".concat(n," "),i&&l().createElement(x,null))),l().createElement(d.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(d.Text,{component:d.TextVariants.p},l().createElement(T.Z,{key:"profile-select-text-".concat(o),lines:3},t)))))}))))};C.propTypes={profiles:m().array,onClick:m().func},C.defaultProps={profiles:[],onClick:function(){return{}}};const Z=C;var S=r(73479),F=r(68778),k=r(11443),V=function(e){return e.rulesPassed+e.rulesFailed===0?l().createElement(S.ZP,{style:{color:"var(--pf-global--disabled-color--100)"}}):e.compliant?l().createElement(F.ZP,{style:{color:"var(--pf-global--success-color--200)"}}):l().createElement(h.ZP,{style:{color:"var(--pf-global--danger-color--100)"}})},R=function(e){return!1===e.supported?" Unsupported":e.rulesPassed+e.rulesFailed===0?" N/A":" "+(0,k.P0)(e.score)};const I=function(e){return l().createElement(l().Fragment,null,e.supported?l().createElement(d.Tooltip,{content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},l().createElement(V,(0,u.Z)({key:"system-compliance-icon-".concat(e.id)},e)),R(e)):R(e))};var B=r(24561);const D=function(){return l().createElement(B.ZP,{speed:2,width:1e3,height:400,viewBox:"0 0 1000 400",backgroundcolor:"#f3f3f3",foregroundcolor:"#ecebeb"},l().createElement("rect",{x:"-3",y:"7",rx:"3",ry:"3",width:"760",height:"19"}),l().createElement("rect",{x:"823",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"910",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"6",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"68",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"133",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"3",y:"110",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"1",y:"149",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"1",y:"185",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-1",y:"224",rx:"0",ry:"0",width:"187",height:"16"}),l().createElement("rect",{x:"-4",y:"267",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-6",y:"306",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"-6",y:"342",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-8",y:"381",rx:"0",ry:"0",width:"187",height:"16"}))},L=function(){return l().createElement(B.ZP,{height:320,width:1550,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},l().createElement("rect",{x:"18",y:"50",rx:"4",ry:"4",width:"478",height:"15"}),l().createElement("rect",{x:"19",y:"18",rx:"3",ry:"3",width:"220",height:"9"}),l().createElement("circle",{cx:"118",cy:"156",r:"73"}),l().createElement("rect",{x:"1002",y:"40",rx:"0",ry:"0",width:"69",height:"23"}),l().createElement("rect",{x:"47",y:"77",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"36",y:"77",rx:"0",ry:"0",width:"16",height:"0"}),l().createElement("rect",{x:"409",y:"149",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"214",y:"145",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"216",y:"119",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"526",y:"100",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"122",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"146",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"170",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"194",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"218",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"529",y:"275",rx:"0",ry:"0",width:"231",height:"7"}))};var A=r(67585),N=r(56163),H=r.n(N),M=function(e){var t=e.policy;return l().createElement(d.Card,{ouiaId:"PolicyDetailsCard"},l().createElement(d.CardHeader,null,l().createElement(d.Text,{style:{fontSize:20}},l().createElement("b",null,"Policy details"))),l().createElement(d.CardBody,null,l().createElement(d.TextContent,null,l().createElement(d.Text,{component:d.TextVariants.h5},"Compliance threshold",l().createElement(Ke,null)),l().createElement(d.Text,{className:"threshold-tooltip",component:d.TextVariants.p},(0,k.P0)(t.complianceThreshold,1)),l().createElement(d.Text,{component:d.TextVariants.h5},"Business objective",l().createElement(ze,null)),l().createElement(d.Text,{component:d.TextVariants.p},t.businessObjective&&t.businessObjective.title||"-"),l().createElement(d.Text,{component:d.TextVariants.h5},"Policy description"),l().createElement(d.Text,{component:d.TextVariants.p},l().createElement(A.Z,{text:H()(t.description||""),length:380,inline:!0})),l().createElement(d.Text,{component:d.TextVariants.h5},"Operating system"),l().createElement(d.Text,{component:d.TextVariants.p},"RHEL ",t.majorOsVersion),l().createElement(d.Text,{component:d.TextVariants.h5},"Policy type "),l().createElement(d.Text,{component:d.TextVariants.p},t.policyType),l().createElement(d.Text,{component:d.TextVariants.h5},"Reference ID"),l().createElement(d.Text,{component:d.TextVariants.p},t.refId))))};M.propTypes={policy:m().object};const q=M;var Y=r(334),_=["children"],G=["children"],K={children:m().node},z=function(e){var t=e.children,r=(0,p.Z)(e,_);return l().createElement(d.TextListItem,(0,u.Z)({},r,{component:d.TextListItemVariants.dt}),t)};z.propTypes=K;var U=function(e){var t=e.children,r=(0,p.Z)(e,G);return l().createElement(d.TextListItem,(0,u.Z)({},r,{component:d.TextListItemVariants.dd}),t)};U.propTypes=K;var J=function(e){var t=e.profile;return l().createElement(l().Fragment,null,l().createElement(d.TextList,{component:d.TextListVariants.dl},l().createElement(z,null,l().createElement(d.Text,{className:"ins-c-non-bold-h2"},"Policy details")),l().createElement(z,null,"Operating system"),l().createElement(U,null,"RHEL ",t.majorOsVersion),l().createElement(z,null,"Compliance threshold"),l().createElement(U,null,(0,k.P0)(t.complianceThreshold,1)),l().createElement(z,null,"Business objective"),l().createElement(U,null,t.businessObjective?t.businessObjective.title:"--")),l().createElement(Y.Link,{to:"/scappolicies/"+t.policy.id},"View policy"))};J.propTypes={profile:m().shape({id:m().string,complianceThreshold:m().number,businessObjective:m().object,majorOsVersion:m().string,policy:m().shape({id:m().string}),benchmark:m().shape({version:m().string})})};var W=function(e){var t=e.profile;return l().createElement(d.TextContent,{className:"policy-details"},l().createElement(J,{profile:t}))};W.propTypes={profile:m().object};const $=W;var Q=r(48273),X=function(e){var t,r,n=e.percent,o=e.failed;return 100===n?(r="Success",t=Q.ProgressVariant.success):o?(r="Error",t=Q.ProgressVariant.danger):(r="Progress",t=Q.ProgressVariant.info),l().createElement(Q.Progress,{id:"finished-create-policy",value:n,title:r,variant:t,className:"wizard-progress-bar"})};X.propTypes={percent:m().number,failed:m().bool};const ee=X;var te=r(52710),re=["children","defaultTab","level"],ne=function(e){return e.children},oe=function(e,t){var r=(0,te.Wb)(e).split("|");return{levels:r,currentAnchor:r[t]||e}};m().number,m().node;var ie=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=oe(r,n).currentAnchor;return t.map((function(e){return e.props.eventKey===o?e:void 0})).filter((function(e){return!!e}))};ie.propTypes={children:m().node,defaultTab:m().string,level:m().number},ie.defaultProps={level:0};var le=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=(0,p.Z)(e,re),i=(0,Y.useHistory)().push,a=(0,Y.useLocation)(),c=a.pathname,s=a.state,f=oe(r,n),m=f.currentAnchor,h=f.levels;return l().createElement(d.Tabs,(0,u.Z)({},o,{onSelect:function(e,t){e.preventDefault();var r=t.replace("#",""),o=h;o[n]=r,i({state:s,to:c,hash:o.slice(0,n+1).join("|")})},activeKey:m}),t)};le.defaultProps={level:0},le.propTypes={children:m().node,defaultTab:m().string,level:m().number};var ae=function(e){return e.children},ce={stateValues:m().object,children:m().node},se=function(e){var t=e.stateValues;return e.children.flatMap((function(e){return e})).filter((function(e){return t[e.props.stateKey]}))};se.propTypes=ce;var ue=function(e){var t=e.stateValues,r=e.children;return l().createElement(se,{stateValues:t},l().createElement(ae,{key:"error-state",stateKey:"error"},l().createElement(E,{error:t.error})),r)};ue.propTypes=ce;var pe="Policies without systems will not have reports.",fe=function(e){var t=e.showTooltip,r=e.children;return t?l().createElement(d.Tooltip,{position:d.TooltipPosition.bottom,content:pe},r):r};fe.propTypes={showTooltip:m().bool,children:m().node};var me=function(e){var t,r=e.count,n=e.variant;switch(n){case"count":t=r;break;case"compact":t="No Systems";break;case"full":t=pe;break;default:t=r}return l().createElement(fe,{showTooltip:"count"===n||"compact"===n},l().createElement(be,null,t))};me.defaultProps={variant:"compact"},me.propTypes={count:m().number.isRequired,variant:m().string};const de=me;var he=r(69957),ye=function(e){var t=e.children;return l().createElement(l().Fragment,null,l().createElement(he.ZP,{className:"ins-u-warning"}),l().createElement(d.Text,{component:"span",className:"ins-c-warning-text"}," ",t))};ye.propTypes={children:m().node};const be=ye;var ve=r(96156),ge=["to","hash","children","state","backgroundLocation"];function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pe=function(e){var t=e.to,r=e.hash,n=e.children,o=e.state,i=e.backgroundLocation,a=(0,p.Z)(e,ge),c=Oe(Oe({},(0,Y.useLocation)()),i),s=Oe(Oe({},o),{},{background:c});return l().createElement(Y.Link,(0,u.Z)({to:{pathname:t,state:s,hash:r}},a),n)};Pe.propTypes={backgroundLocation:m().object,children:m().node,hash:m().string,state:m().object,to:m().string.isRequired};const we=Pe;var je=["href"],Te=["children"],xe=function(e){var t=e.href,r=(0,p.Z)(e,je);return l().createElement(Y.Link,(0,u.Z)({},r,{to:t}))};xe.propTypes={href:m().string};var Ce=function(e){var t=e.children,r=(0,p.Z)(e,Te);return l().createElement(d.BreadcrumbItem,(0,u.Z)({},r,{component:xe}),t)};Ce.propTypes={children:m().node};const Ze=Ce;var Se=r(49629),Fe=r(17490),ke=r(28481),Ve=r(79886);var Re=function(e){return l().createElement(d.TextContent,null,l().createElement(Y.Link,{to:"/reports/"+e.id,style:{marginRight:".5rem"}},e.policy.name),l().createElement(l().Fragment,null,l().createElement(Ge,{profile:e,position:"right"}),l().createElement(P,null,e.policyType)))};Re.propTypes={profile:m().object};var Ie=function(e){var t=e.majorOsVersion,r=e.ssgVersion,n=e.unsupportedHostCount,o=e.policy,i=0===n;return r="SSG: "+r,l().createElement(l().Fragment,null,l().createElement(Vt,{majorOsVersion:t}),null===o&&r&&l().createElement(d.Text,null,l().createElement(P,null,i?r:l().createElement(Zt,null,r))))};Ie.propTypes={majorOsVersion:m().string,ssgVersion:m().string,unsupportedHostCount:m().number,policy:m().object};var Be=function(e){var t=e.testResultHostCount,r=void 0===t?0:t,n=e.compliantHostCount,o=void 0===n?0:n,i=e.unsupportedHostCount,a=void 0===i?0:i;return l().createElement(l().Fragment,null,l().createElement(d.Progress,{measureLocation:"outside",value:r?100/r*o:0}),l().createElement(P,null,"".concat(o," of ").concat(r," systems "),a>0&&l().createElement(Zt,{tooltipText:"Insights cannot provide a compliance score for systems running an unsupported version of the SSG at the time this report was created, as the SSG version was not supported by RHEL.",style:{marginLeft:".5em"}},l().createElement("strong",{className:"ins-c-warning-text"},a," unsupported"))))};Be.propTypes={testResultHostCount:m().number,compliantHostCount:m().number,unsupportedHostCount:m().number};var De=r(89421),Le=[{type:De.Yu.text,label:"Policy name",filter:function(e,t){var r=t.toLowerCase();return e.filter((function(e){return[e.name,e.policy.name].join().toLowerCase().includes(r)}))}}],Ae=[{type:De.Yu.checkbox,label:"Systems meeting compliance",filter:function(e,t){return e.filter((function(e){var r=e.testResultHostCount,n=e.compliantHostCount,o=Math.round(100/r*n);return t.map((function(e){var t=e.split("-"),r=(0,ke.Z)(t,2),n=r[0],i=r[1];return o>=n&&o<=i})).filter((function(e){return!!e})).length>0}))},items:[{label:"90 - 100%",value:"90-100"},{label:"70 - 89%",value:"70-89"},{label:"50 - 69%",value:"50-69"},{label:"Less than 50%",value:"0-49"}]}],Ne=function(e){var t=e.profiles,r=[{title:"Policy",transforms:[a.sortable],sortByProperty:"name",props:{width:55}},{title:"Operating system",transforms:[a.sortable,a.fitContent],sortByProperty:"majorOsVersion",props:{width:20}},{title:"Systems meeting compliance",transforms:[a.sortable,a.fitContent],sortByFunction:function(e){return 100/e.testResultHostCount*e.compliantHostCount},props:{width:25}}],n=(0,Ve.jj)(t.map((function(e){return e.policyType})).filter((function(e){return!!e}))),c=(0,Ve.jj)(t.map((function(e){return e.majorOsVersion})).filter((function(e){return!!e}))),s=(0,Fe.Z)([].concat((0,o.Z)(Le),(0,o.Z)(n.length>0&&function(e){return[{type:De.Yu.checkbox,label:"Policy type",filter:function(e,t){return e.filter((function(e){var r=e.policyType;return t.includes(r)}))},items:e.map((function(e){return{label:e,value:e}}))}]}(n)||[]),(0,o.Z)(c.length>0&&function(e){return[{type:De.Yu.checkbox,label:"Operating system",filter:function(e,t){return e.filter((function(e){var r=e.majorOsVersion;return t.includes(r)}))},items:e.map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]}(c)||[]),(0,o.Z)(Ae)),t),p=s.conditionalFilter,f=function(e,t){var r=(0,i.useState)({index:0,direction:"desc"}),n=(0,ke.Z)(r,2),o=n[0],l=n[1],a=t[o.index];return{tableSort:{onSort:function(e,t,r){return l({index:t,direction:r})},sortBy:o},sorted:(0,Ve.dY)((null==a?void 0:a.sortByProperty)||(null==a?void 0:a.sortByFunction),e,o.direction)}}(s.filtered,r),m=f.tableSort,d=f.sorted,h=d.length>0?d.map((function(e){return{cells:[{title:l().createElement(Re,e)},{title:l().createElement(Ie,e)},{title:l().createElement(Be,e)}]}})):We;return l().createElement(l().Fragment,null,l().createElement(Se.Z,p),l().createElement(a.Table,(0,u.Z)({"aria-label":"Reports",ouiaId:"ReportsTable",cells:r,rows:h},m),l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null)))};Ne.propTypes={profiles:m().array};const He=Ne;var Me=r(72858);const qe=function(){return l().createElement(Me.Z,{title:"No policies are reporting",mainButton:l().createElement(we,{to:"/scappolicies/new"},l().createElement(d.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))})};var Ye=r(91290),_e=function(e){var t=e.profile,r=e.position,n=void 0===r?"top":r,o=t.policy,i=t.policyType,a=t.complianceThreshold,c=t.majorOsVersion,s=t.businessObjective;return l().createElement(d.Popover,{position:n,headerContent:l().createElement(d.TextContent,null,o.name,l().createElement(d.Text,{component:d.TextVariants.small},i)),footerContent:l().createElement(Y.Link,{to:"/scappolicies/"+o.id},"View policy"),bodyContent:l().createElement(d.TextContent,{className:"policy-details"},l().createElement(d.TextList,{component:d.TextListVariants.dl},l().createElement(d.TextListItem,{component:d.TextListItemVariants.dt},"Operating system"),l().createElement(d.TextListItem,{component:d.TextListItemVariants.dd},"RHEL ",c),l().createElement(d.TextListItem,{component:d.TextListItemVariants.dt},"Compliance threshold"),l().createElement(d.TextListItem,{component:d.TextListItemVariants.dd},(0,k.P0)(a,1)),s&&l().createElement(l().Fragment,null,l().createElement(d.TextListItem,{component:d.TextListItemVariants.dt},"Business objective"),l().createElement(d.TextListItem,{component:d.TextListItemVariants.dd},s.title))))},l().createElement(d.Button,{variant:"link",ouiaId:"PopoverViewPolicyLink",isInline:!0},l().createElement(Ye.ZP,{className:"grey-icon"})))};_e.propTypes={profile:m().object,position:m().string};const Ge=_e,Ke=function(){return l().createElement(d.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,'The compliance threshold defines what percentage of rules must be met in order for a system to be determined "compliant".')},l().createElement("span",null," ",l().createElement(Ye.ZP,{className:"grey-icon"})))},ze=function(){return l().createElement(d.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,"This is an optional field that can be used to label policies that are related to specific business objectives.")},l().createElement("span",null," ",l().createElement(Ye.ZP,{className:"grey-icon"})))};var Ue=r(92223),Je=function(){return l().createElement(Ue.Z,null,l().createElement(d.Bullseye,null,l().createElement(d.EmptyState,{variant:d.EmptyStateVariant.full},l().createElement(d.Title,{headingLevel:"h5",size:"lg"},"No matching policies found"),l().createElement(d.EmptyStateBody,null,"This filter criteria matches no policies. ",l().createElement("br",null)," Try changing your filter settings."))))},We=[{cells:[{title:function(){return l().createElement(Je,null)},props:{colSpan:3}}]}],$e=r(6610),Qe=r(5991),Xe=r(63349),et=r(10379),tt=r(46070),rt=r(77608),nt=r(32875),ot=r(16703);function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var at=function(e){var t=e.profile;return l().createElement(d.TextContent,null,l().createElement(Y.Link,{to:"/scappolicies/"+t.id},t.policy.name),l().createElement(P,null,t.policyType))};at.propTypes={profile:m().object};var ct=[{type:De.Yu.text,label:"Name",filter:function(e,t){return e.filter((function(e){return e.name.includes(t)}))}}],st=function(e){(0,et.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,rt.Z)(t);if(r){var o=(0,rt.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,tt.Z)(this,e)});function o(){var e;(0,$e.Z)(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r)),(0,ve.Z)((0,Xe.Z)(e),"filterConfigBuilder",new ot.CN(ct)),(0,ve.Z)((0,Xe.Z)(e),"chipBuilder",e.filterConfigBuilder.getChipBuilder()),(0,ve.Z)((0,Xe.Z)(e),"filterBuilder",e.filterConfigBuilder.getFilterBuilder()),(0,ve.Z)((0,Xe.Z)(e),"columns",[{title:"Name"},{title:"Operating system"},{title:"Systems"},{title:"Business objective",transforms:[a.fitContent]},{title:"Compliance threshold",transforms:[a.fitContent]}]),(0,ve.Z)((0,Xe.Z)(e),"state",{page:1,itemsPerPage:10,activeFilters:{}}),(0,ve.Z)((0,Xe.Z)(e),"setPage",(function(t,r){return e.changePage(r,e.state.itemsPerPage)})),(0,ve.Z)((0,Xe.Z)(e),"setPerPage",(function(t,r){return e.changePage(1,r)})),(0,ve.Z)((0,Xe.Z)(e),"changePage",(function(t,r){return e.setState({page:t,itemsPerPage:r})})),(0,ve.Z)((0,Xe.Z)(e),"paginatedPolicies",(function(t){return t.slice((e.state.page-1)*e.state.itemsPerPage,e.state.page*e.state.itemsPerPage)})),(0,ve.Z)((0,Xe.Z)(e),"filteredPolicies",(function(){return e.filterConfigBuilder.applyFilterToObjectArray(e.props.policies,e.state.activeFilters)})),(0,ve.Z)((0,Xe.Z)(e),"onFilterUpdate",(function(t,r){e.setState({page:1,activeFilters:lt(lt({},e.state.activeFilters),{},(0,ve.Z)({},t,r))})})),(0,ve.Z)((0,Xe.Z)(e),"deleteFilter",(function(t){var r=e.filterConfigBuilder.removeFilterWithChip(t,e.state.activeFilters);e.setState({activeFilters:r})})),(0,ve.Z)((0,Xe.Z)(e),"clearAllFilter",(function(){return e.setState({activeFilters:e.filterConfigBuilder.initialDefaultState()})})),(0,ve.Z)((0,Xe.Z)(e),"onFilterDelete",(function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e.clearAllFilter():e.deleteFilter(r[0])})),(0,ve.Z)((0,Xe.Z)(e),"actionResolver",(function(){return[{title:"Delete policy",onClick:function(t,r,n){var o=n.policyId,i=e.props.policies.find((function(e){return e.id===o}));e.props.history.push("/scappolicies/".concat(o,"/delete"),{policy:i,background:e.props.location})}},{title:"Edit policy",onClick:function(t,r,n){var o=n.policyId,i=e.props.policies.find((function(e){return e.id===o}));e.props.history.push("/scappolicies/".concat(o,"/edit"),{policy:i,background:e.props.location,state:{policy:i}})}}]})),e}return(0,Qe.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.page,r=e.itemsPerPage,n=this.filteredPolicies(),o=this.chipBuilder.chipsFor(this.state.activeFilters),i=function(e){return e.map((function(e){return{policyId:e.id,cells:[{title:l().createElement(at,{profile:e})},{title:l().createElement(Vt,{majorOsVersion:e.majorOsVersion})},{title:e.totalHostCount>0?e.totalHostCount:l().createElement(de,{count:e.totalHostCount,variant:"count"})},e.businessObjective&&e.businessObjective.title||"--","".concat(e.complianceThreshold,"%")]}}))}(this.paginatedPolicies(n)),c=this.filterConfigBuilder.buildConfiguration(this.onFilterUpdate,this.state.activeFilters,{hideLabel:!0}),s={page:t,itemCount:n.length,dropDirection:"down",onSetPage:this.setPage,onPerPageSelect:this.setPerPage,perPage:r};return l().createElement(l().Fragment,null,l().createElement(Se.Z,{filterConfig:c,activeFiltersConfig:{filters:o,onDelete:this.onFilterDelete},pagination:lt(lt({},s),{},{dropDirection:"down",ouiaId:"PoliciesCompactPagination"})},l().createElement(d.ToolbarItem,null,l().createElement(we,{to:"/scappolicies/new"},l().createElement(d.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))),l().createElement(d.ToolbarItem,null,n.length," results")),l().createElement(a.Table,{"aria-label":"policies",ouiaId:"PoliciesTable",className:"compliance-policies-table",cells:this.columns,actionResolver:i.length>0&&this.actionResolver,rows:0===i.length?We:i},l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null)),l().createElement(nt.Z,{isFooter:!0,className:"ins-c-inventory__table--toolbar"},l().createElement(d.Pagination,(0,u.Z)({},s,{dropDirection:"up",ouiaId:"PoliciesPagination",variant:d.PaginationVariant.bottom}))))}}]),o}(l().Component);st.propTypes={policies:m().array.isRequired,history:m().object.isRequired,location:m().object.isRequired},st.defaultProps={policies:[]};const ut=(0,Y.withRouter)(st);var pt=r(46314),ft=r(74726),mt=r(59854),dt=r.n(mt),ht=r(70597);var yt=function(e){(0,et.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,rt.Z)(t);if(r){var o=(0,rt.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,tt.Z)(this,e)});function o(){var e;(0,$e.Z)(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r)),(0,ve.Z)((0,Xe.Z)(e),"state",{validThreshold:(0,ht.KJ)(e.props.previousThreshold),threshold:dt()(e.props.previousThreshold||100,1)}),(0,ve.Z)((0,Xe.Z)(e),"handleThresholdChange",(function(t){return e.setState({validThreshold:(0,ht.KJ)(t),threshold:dt()(t,1)})})),e}return(0,Qe.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.threshold,r=e.validThreshold;return l().createElement(l().Fragment,null,l().createElement(d.FormGroup,{fieldId:"policy-threshold",validated:r?"default":"error",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended",labelIcon:l().createElement(Ke,null),label:"Compliance threshold (%)"},l().createElement(w.Z,{name:"complianceThreshold",id:"complianceThreshold",isRequired:!0,onChange:this.handleThresholdChange,validated:r?"default":"error",defaultValue:t,"aria-label":"compliance threshold",component:ft._c,type:"number",style:{width:"60%",display:"block"}})))}}]),o}(l().Component);yt.propTypes={previousThreshold:m().number};const bt=(0,pt.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(yt);var vt=r(85600),gt=r(15265);const Et=function(){return l().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:vt.iK},"Supported SSG versions ",l().createElement(gt.ZP,null))};function Ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var wt=l().createElement(l().Fragment,null,l().createElement(d.Text,{variant:"p",style:{marginBottom:"1rem"}},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),l().createElement(d.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),jt=function(e){var t=e.children,r=e.variant,n=void 0===r?"plural":r;return l().createElement(d.Popover,{id:"unsupported-popover",maxWidth:"25rem",headerContent:"Unsupported SSG versions",bodyContent:"plural"===n?wt:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:l().createElement(Et,null)},t)};jt.propTypes={children:m().node,variant:m().oneOf(["singular","plural"])};var Tt=function(e){var t=e.children,r=e.content;return l().createElement(d.Tooltip,{content:r,position:"bottom"},t)};Tt.propTypes={content:m().string,children:m().node};var xt=function(e){var t=e.variant,r=e.children,n=e.tooltipProps,o={tooltip:{Component:Tt,componentProps:n},popover:{Component:jt,componentProps:{showHeader:n.showPopupHeader,variant:n.messageVariant}}}[t],i=o.Component,a=o.componentProps;return l().createElement(i,a,r)};xt.propTypes={children:m().node,variant:m().oneOf(["tooltip","popover"]),tooltipProps:m().object};var Ct=function(e){var t=e.children,r=e.showWarningIcon,n=void 0===r||r,o=e.showHelpIcon,i=void 0!==o&&o,a=e.style,c=e.tooltipText,s=e.messageVariant,u={variant:c?"tooltip":"popover",tooltipProps:Pt(Pt({},c&&{content:l().createElement("div",null,c)}),{},{messageVariant:s})},p=c?{}:{cursor:"pointer"};return l().createElement("span",{style:Pt(Pt({},a),{},{display:"inline-block"})},n&&l().createElement(xt,u,l().createElement(he.ZP,{className:"ins-u-warning",style:Pt(Pt({},p),{},{marginRight:".25em"})})),t,i&&l().createElement(xt,u,l().createElement(Ye.ZP,{style:Pt(Pt({},p),{},{marginLeft:".25em"})})))};Ct.propTypes={showWarningIcon:m().bool,showHelpIcon:m().bool,style:m().object,tooltipText:m().string,children:m().node,variant:m().string,messageVariant:m().string,showPopupHeader:m().bool};const Zt=Ct;var St=function(e){var t=e.children;return l().createElement(d.Text,{component:"h2",style:{color:"var(--pf-global--Color--200)",lineHeight:"2rem"}},t)};St.propTypes={children:m().node};const Ft=St;var kt=function(e){var t=e.majorOsVersion,r={default:"var(--pf-global--disabled-color--200)",7:"cyan",8:"purple"},n=r[t]||r.default;return l().createElement(d.Label,{color:n},"RHEL ",t)};kt.propTypes={majorOsVersion:m().string};const Vt=kt;var Rt=r(10530);const It=function(){return l().createElement(d.Bullseye,null,l().createElement(d.EmptyState,{variant:d.EmptyStateVariant.full},l().createElement(d.Title,{headingLevel:"h2",size:"lg",style:{fontWeight:"bold"}},"No systems on this policy"),l().createElement(d.EmptyStateBody,null,l().createElement(d.TextContent,null,l().createElement(d.Text,{component:d.TextVariants.p},"Add systems to this policy from the systems page"),l().createElement(d.Text,{style:{color:"var(--pf-global--warning-color--100)"}},l().createElement(he.ZP,null)," ",pe)))))};var Bt=r(22642),Dt=function(e){return e.split(" ").join("").toLowerCase()};const Lt=function e(t){var r=this;(0,$e.Z)(this,e),(0,ve.Z)(this,"buildFilterFilterString",(function(e,t){var r=e.type,n=e.filterString;if("hidden"!==r&&!t)return[];switch(r){case De.Yu.text:return[n(t)];case De.Yu.checkbox:return t.map((function(e){return n(e)}));case De.Yu.group:return n(t);case"hidden":return n();default:return[]}})),(0,ve.Z)(this,"combineFilterStrings",(function(e){var t=e.map((function(e){return e.length})).filter((function(e){return e>0})).length>=2;return e.map((function(e){return e.join(" or ")})).join(t?" and ":"")})),(0,ve.Z)(this,"buildFilterString",(function(e){var t=r.config.map((function(t){return r.buildFilterFilterString(t,e[Dt(t.label)])})).filter((function(e){return e.length>0}));return r.combineFilterStrings(t)})),this.filterConfig=t,this.config=this.filterConfig.config},At=function e(t){var r=this;(0,$e.Z)(this,e),(0,ve.Z)(this,"textFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:t}]}:null})),(0,ve.Z)(this,"checkboxFilterChip",(function(e,t){return t&&t.length>0?{category:e,chips:t.map((function(t){return{name:r.filterConfig.labelForValue(t,e)}}))}:null})),(0,ve.Z)(this,"radioFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:r.filterConfig.labelForValue(t,e)}]}:null})),(0,ve.Z)(this,"chipFor",(function(e,t){var n=r.filterConfig.getCategoryForLabel(e)||{label:e,type:null},o=n.label;switch(n.type){case De.Yu.text:return r.textFilterChip(o,t);case De.Yu.checkbox:return r.checkboxFilterChip(o,t);case De.Yu.radio:return r.radioFilterChip(o,t);default:return null}})),(0,ve.Z)(this,"chipsFor",(function(e){return Object.keys(e).map((function(t){return r.chipFor(t,e[t])})).filter((function(e){return!!e}))})),this.filterConfig=t,this.config=this.filterConfig.config};function Nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Mt=function(e){return"Filter by ".concat(e.toLowerCase())};const qt=function e(t){var r=this;(0,$e.Z)(this,e),(0,ve.Z)(this,"chipBuilder",null),(0,ve.Z)(this,"filterBuilder",null),(0,ve.Z)(this,"addConfigItem",(function(e){return r.config=r.config.filter((function(t){return t.label!==e.label})).concat(e)})),(0,ve.Z)(this,"getChipBuilder",(function(){return r.chipBuilder=r.chipBuilder?r.chipBuilder:new At(r)})),(0,ve.Z)(this,"getFilterBuilder",(function(){return r.filterBuilder=r.filterBuilder?r.filterBuilder:new Lt(r)})),(0,ve.Z)(this,"toTextFilterConfig",(function(e,t,r){return{type:De.Yu.text,label:e.label,placeholder:Mt(e.label),id:Dt(e.label),filterValues:(0,ve.Z)({value:r},e.event||"onChange",(function(r,n){t(Dt(e.label),n)}))}})),(0,ve.Z)(this,"toCheckboxFilterConfig",(function(e,t,r){return{type:De.Yu.checkbox,label:e.label,placeholder:Mt(e.label),id:Dt(e.label),filterValues:{value:r,items:e.items,onChange:function(r,n){t(Dt(e.label),n)}}}})),(0,ve.Z)(this,"toRadioFilterConfig",(function(e,t,r){return{type:De.Yu.radio,label:e.label,placeholder:Mt(e.label),id:Dt(e.label),filterValues:{value:r,items:e.items,onChange:function(r,n){t(Dt(e.label),n)}}}})),(0,ve.Z)(this,"toFilterConfigItem",(function(e,t,n){switch(e.type){case De.Yu.text:return r.toTextFilterConfig(e,t,n);case De.Yu.checkbox:return r.toCheckboxFilterConfig(e,t,n);case De.Yu.radio:return r.toRadioFilterConfig(e,t,n);default:return null}})),(0,ve.Z)(this,"buildConfiguration",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ht(Ht({},n),{},{items:r.config.map((function(n){return r.toFilterConfigItem(n,e,t[Dt(n.label)])})).filter((function(e){return!!e}))})})),(0,ve.Z)(this,"defaultValueForFilter",(function(e){switch(e.type){case De.Yu.text:return"";case De.Yu.checkbox:return[];case"hidden":return e.default||!1;default:return}})),(0,ve.Z)(this,"initialDefaultState",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return r.config.forEach((function(n){var o=Dt(n.key||n.label);t[o]=e[o]||r.defaultValueForFilter(n)})),t})),(0,ve.Z)(this,"categoryLabelForValue",(function(e){var t=r.config.filter((function(t){return!!t.items&&t.items.map((function(e){return e.value})).includes(e)}))[0];return t?t.label:e})),(0,ve.Z)(this,"getCategoryForLabel",(function(e){return r.config.filter((function(t){return Dt(t.key||t.label)===Dt(e)}))[0]||{}})),(0,ve.Z)(this,"getItemByLabelOrValue",(function(e,t){var n=(r.getCategoryForLabel(t).items||[]).filter((function(t){return t.value===e||t.label===e}));return 1===n.length?n[0]:n.length>1?(console.info("Multiple items found for ".concat(e," in ").concat(t,"! Returning first one.")),n[0]):void console.info("No item found for "+e+" in ",t)})),(0,ve.Z)(this,"labelForValue",(function(e,t){var n=r.getItemByLabelOrValue(e,t);return n?n.label:e})),(0,ve.Z)(this,"valueForLabel",(function(e,t){var n=r.getItemByLabelOrValue(e,t);return n?n.value:e})),(0,ve.Z)(this,"applyFilterToObjectArray",(function(e,t){var n=(0,o.Z)(e);return Object.keys(t).forEach((function(e){var o=r.getCategoryForLabel(e),i=t[e];o&&i&&(i.length>0||"hidden"===o.type&&"boolean"==typeof i)&&(n=o.filter(n,i))})),n})),(0,ve.Z)(this,"removeFilterFromFilterState",(function(e,t){return"string"==typeof e?"":e.filter((function(e){return e!==t}))})),(0,ve.Z)(this,"removeFilterWithChip",(function(e,t){var n=e.category,o=r.valueForLabel(e.chips[0].name,n),i=Dt(n),l=t[i],a=r.removeFilterFromFilterState(l,o);return Ht(Ht({},t),{},(0,ve.Z)({},i,a))})),this.config=t};var Yt=function(e){var t=e.isChecked,r=e.setActiveFilter;return l().createElement(d.Switch,{label:"Selected only",isChecked:t,onChange:function(){return r("selected",!t)}})};Yt.propTypes={isChecked:m().bool,setActiveFilter:m().func};const _t=Yt,Gt=function(e){var t=e.setActiveFilter,r=e.activeFilters,n=!!e.selectedFilter,o={type:"hidden",label:"selectFilter",key:"selected",default:!0,filter:function(e,t){return e.filter((function(e){var r;return(null==e||null===(r=e.rowProps)||void 0===r?void 0:r.selected)===t}))}},i=!0===r.selected;return n?{filterItem:o,toolbarProps:{dedicatedAction:function(){return l().createElement(_t,{setActiveFilter:t,isChecked:i})}}}:{}};function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function zt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.useMemo)((function(){return new qt([])}),[]),r=e.filters,n=e.setPage,l=e.selectedFilter,a=!!r,c=r||{},s=c.filterConfig,u=void 0===s?[]:s,p=c.activeFilters,f=(0,i.useState)({}),m=(0,ke.Z)(f,2),d=m[0],h=m[1],y=function(e,t){h(zt(zt({},d),{},(0,ve.Z)({},e,t))),n&&n(1)},b=function(){return t.buildConfiguration(y,d)},v=function(e){t.addConfigItem(e),h(t.initialDefaultState(d))},g=function(){return h(t.initialDefaultState())},E=function(e){return h(t.removeFilterWithChip(e,d))},O=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?g():E(t[0])},P=t.getChipBuilder(),w=P.chipsFor(d),j=function(e){return t.applyFilterToObjectArray(e,d)},T=Gt({activeFilters:d,setActiveFilter:y,selectedFilter:l}),x=T.toolbarProps,C=T.filterItem;return(0,i.useEffect)((function(){return t.config=[],[].concat((0,o.Z)(u),[C]).filter((function(e){return!!e})).forEach(v),h(t.initialDefaultState(p||[])),function(){t.config=[]}}),[]),a?{filter:j,selectedFilterToolbarProps:x,toolbarProps:{filterConfig:b(),activeFiltersConfig:{filters:w,onDelete:O}},setActiveFilter:y,activeFilters:d,addConfigItem:v,filterConfigBuilder:t}:{}};function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $t=function(e){return e.map((function(e){return Wt(Wt({},e),function(e){return e.sortByProp||e.sortByFunction}(e)?{transforms:(0,Ve.jj)([].concat((0,o.Z)((null==e?void 0:e.transforms)||[]),[a.sortable]))}:{})}))},Qt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return("function"==typeof e.onSelect)+(void 0!==e.detailsComponent)};const Xt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.useState)({index:0,direction:"desc"}),n=(0,ke.Z)(r,2),o=n[0],l=n[1],a=function(e,t,r){return l({index:t,direction:r})};return{sorter:function(r){var n=e[o.index-Qt(t)];return null!=n&&n.sortByArray?(0,Ve.qk)(r,null==n?void 0:n.sortByProp,null==n?void 0:n.sortByArray,o.direction):(0,Ve.dY)((null==n?void 0:n.sortByProp)||(null==n?void 0:n.sortByFunction),r,o.direction)},tableProps:{onSort:a,sortBy:o,cells:$t(e)}}};function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const rr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,r=void 0===t?10:t,n=!1!==(null==e?void 0:e.pagination),o=(0,i.useState)({perPage:r,page:1}),l=(0,ke.Z)(o,2),a=l[0],c=l[1],s=function(e){return c(tr(tr({},a),e))},u=function(e,t){return s(tr(tr({},a),{},{page:t}))},p=function(e,t){return s({page:1,perPage:t})},f=function(e){var t=a.page,r=a.perPage,n=(t-1)*r,o=n+r;return e.slice(n,o)},m=function(e){var t=e<0?a.page+e:e;s({page:t>0?t:1})};return n?{paginator:f,setPage:m,toolbarProps:{pagination:tr(tr({},a),{},{onSetPage:u,onPerPageSelect:p})}}:{}};var nr=function(e){var t=e.kind,r=void 0===t?"results":t;return l().createElement(Ue.Z,null,l().createElement(d.Bullseye,null,l().createElement(d.EmptyState,{variant:d.EmptyStateVariant.full},l().createElement(d.Title,{headingLevel:"h5",size:"lg"},"No matching ",r," found"),l().createElement(d.EmptyStateBody,null,"This filter criteria matches no ",r,".",l().createElement("br",null),"Try changing your filter settings."))))};nr.propTypes={kind:m().string};var or=[{cells:[{title:function(){return l().createElement(nr,null)},props:{colSpan:3}}]}];function ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ar=function(e){var t,r;return e.key||(null===(t=e.original)||void 0===t?void 0:t.toLowerCase())||(null===(r=e.title)||void 0===r?void 0:r.toLowerCase())},cr=function(e,t){var r=e;return t.forEach((function(e){e&&(r=e(r))})),r},sr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){return cr(e,t)}))},ur=function(e,t,r,n){return r.flatMap((function(r){var o=function(e,t){return lr(lr({},e.rowProps),{},{itemId:e.itemId,cells:t.map((function(t){return{title:t.renderFunc?t.renderFunc(void 0,void 0,e):e[ar(t)]}}))})}(e,t);return r?r(o,e,t,n):o}))};const pr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.transformer,o=void 0===n?[]:n,i=r.rowTransformer,l=void 0===i?[]:i,a=r.emptyRows||or,c=o?sr(e,o):e,s=null!=r&&r.filter?r.filter(c):c,u=null!=r&&r.sorter?r.sorter(s):s,p=null!=r&&r.paginator?null==r?void 0:r.paginator(u):u,f=p.length>0?p.flatMap((function(e,r){return ur(e,t,l,r)})).filter((function(e){return!!e})):a,m=null!=r&&r.pagination?lr(lr({},r.pagination),{},{itemCount:s.length}):void 0;return{tableProps:{rows:f},toolbarProps:{pagination:m}}};function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var dr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e)})).length===e.length},hr=function(e){return e?"Unselect":"Select"},yr=function(e){return e.map((function(e){return e.itemId}))};const br=function(e){var t=e.onSelect,r=e.items,n=e.filter,l=e.paginator,a=e.sorter,c=e.preselected,s=e.setPage,u=!!t,p=(0,i.useState)(c||[]),f=(0,ke.Z)(p,2),m=f[0],d=f[1],h=function(e){return mr(mr({},e),{},{rowProps:{selected:(m||[]).includes(e.itemId)}})},y=(a?a(r):r).map(h),b=y.length,v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e.itemId)}))}(y,m).length,g=0===v,E=n?n(y):y,O=E.length,P=O!==b,w=(null==m?void 0:m.length)>0&&dr(yr(E),m),j=l?l(E):E,T=j.length,x=function(e,t){return 0!==e.length&&dr(e,t)}(yr(j),m),C="".concat(v," selected"),Z=function(e,t){return 0!==e&&(e===t||null)}(v,b),S=P?O:b,F=v===S,k=0===S,V=function(e){var r=e();d(r),t&&t(r)},R=function(){return V((function(){return[]}))},I=function(e){return t=m,r=e,Array.from(new Set([].concat((0,o.Z)(t),(0,o.Z)(r))));var t,r},B=function(e){return m.filter((function(t){return!e.includes(t)}))},D=function(){return V((function(){var e=yr(j);return x?B(e):I(e)}))},L=(0,i.useMemo)((function(){return s}),[]);return(0,i.useEffect)((function(){0===T&&L(-1)}),[T,L]),(0,i.useEffect)((function(){d(c)}),[c]),u?{transformer:h,tableProps:{onSelect:T>0?function(e,t,r,n){return V((function(){return t?[].concat((0,o.Z)(m),[n.itemId]):m.filter((function(e){return e!==n.itemId}))}))}:void 0,canSelectAll:!1},selected:m,clearSelection:R,toolbarProps:{bulkSelect:{toggleProps:{children:[C]},isDisabled:k,items:[{title:"Select none",onClick:R,props:{isDisabled:g}},{title:"".concat(hr(x)," page (").concat(T," items)"),onClick:D},{title:"".concat(hr(P?w:F)," all (").concat(S," items)"),onClick:function(){return F?R():V(P?function(){var e=yr(E);return w?B(e):I(e)}:function(){return yr(y)})}}],checked:Z,onSelect:k?void 0:function(){return D()}}}}:{}};function vr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Er=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return e[t]},Or=function(e,t){return gr(gr({},e),{},"string"==typeof t?{itemId:Er(e,t)}:{itemId:t(e)})};const Pr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(null==t?void 0:t.identifier)||Er;return e.map((function(e){return Or(e,r)}))};function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Tr=function(e,t,r){return void 0!==(null==r?void 0:r.detailsComponent)&&function(e,t,r){return{parent:2*t,cells:[{title:l().createElement(r,{rule:e,key:"item-"+e.rowId})}]}}(e,t,r.detailsComponent)};const xr=function(e){var t=!!e.detailsComponent,r=(0,i.useState)([]),n=(0,ke.Z)(r,2),l=n[0],a=n[1];return t?{transformer:function(t,r,n,o){var i=l.includes(r.itemId);return[jr(jr({},t),{},{isOpen:i}),Tr(r,o,e)]},tableProps:{onCollapse:function(e,t,r,n){l.includes(n.itemId)?a(l.filter((function(e){return e!==n.itemId}))):a([].concat((0,o.Z)(l),[n.itemId]))}}}:{}},Cr=function(e){var t=!!e.dedicatedAction,r=e.dedicatedAction,n=e.additionalDedicatedActions,i=e.selected;return t?{toolbarProps:{dedicatedAction:[r].concat((0,o.Z)(n)).filter((function(e){return!!e})).map((function(e,t){return l().createElement(e,{key:"dedicated-table-action-".concat(t),selected:i})}))}}:{}};function Zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fr=["items","columns","filters","options","toolbarProps"];function kr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Vr=function(e){var t=e.items,r=void 0===t?[]:t,n=e.columns,o=void 0===n?[]:n,i=e.filters,c=void 0===i?[]:i,s=e.options,f=void 0===s?{}:s,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.toolbarProps,o=r.tableProps,i=Pr(e,r),l=Xt(t,r),a=l.tableProps,c=l.sorter,s=rr(r),u=s.toolbarProps,p=s.setPage,f=s.paginator,m=Ut(Sr(Sr({},r),{},{setPage:p})),d=m.toolbarProps,h=m.filter,y=m.selectedFilterToolbarProps,b=xr(r),v=b.transformer,g=b.tableProps,E=br(Sr(Sr({},r),{},{items:i,filter:h,paginator:f,sorter:c,setPage:p})),O=E.transformer,P=E.toolbarProps,w=E.tableProps,j=E.selected,T=Cr(Sr(Sr({},r),{},{additionalDedicatedActions:[null==y?void 0:y.dedicatedAction],selected:j})).toolbarProps,x=pr(i,a.cells,{emptyRows:r.emptyRows,transformer:[O],rowTransformer:[v],pagination:null==u?void 0:u.pagination,paginator:f,filter:h,sorter:c}),C=x.toolbarProps,Z=x.tableProps,S=Sr(Sr(Sr(Sr(Sr(Sr(Sr({},u),P),d),y),T),C),n),F=Sr(Sr(Sr(Sr(Sr({cells:t},Z),a),w),g),o);return{toolbarProps:S,tableProps:F}}(r,o,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(r),!0).forEach((function(t){(0,ve.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({filters:c,toolbarProps:e.toolbarProps,tableProps:(0,p.Z)(e,Fr)},f)),h=m.toolbarProps,y=m.tableProps;return l().createElement(l().Fragment,null,l().createElement(Se.Z,h),l().createElement(a.Table,y,l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null)),l().createElement(nt.Z,{isFooter:!0},l().createElement(d.Pagination,(0,u.Z)({variant:d.PaginationVariant.bottom},h.pagination))))};Vr.propTypes={items:m().array.isRequired,columns:m().arrayOf(m().shape({title:m().node,transforms:m().array,sortByProperty:m().string,sortByArray:m().array,sortByFunction:m().func,renderFunc:m().func})).isRequired,filters:m().object,options:m().object,toolbarProps:m().object};const Rr=Vr;var Ir=r(82176),Br=function(e){var t=e.rule,r=t.refId,o=t.description,i=t.identifier,a=t.references,c=t.rationale,s="rule-child-row-".concat(r);return l().createElement("div",{key:s,style:{marginTop:"var(--pf-global--spacer--lg)"}},l().createElement(d.Stack,{id:"rule-description-".concat(s),className:"margin-bottom-lg"},l().createElement(d.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},l().createElement(d.Text,{className:"pf-c-form__label",component:d.TextVariants.h5},l().createElement("b",null,"Description"))),l().createElement(d.StackItem,{isFilled:!0},o)),l().createElement(d.Stack,{id:"rule-identifiers-references-".concat(s),className:"margin-bottom-lg"},l().createElement(d.Grid,null,i&&i.length>0&&l().createElement(d.GridItem,{span:2},l().createElement(d.Text,{className:"pf-c-form__label",component:d.TextVariants.h5},l().createElement("b",null,"Identifier")),l().createElement(d.Text,null,i.map((function(e,t){return l().createElement(n.default,{href:e.system,target:"_blank",key:"".concat(r,"-identifier-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))),a&&a.length>0&&l().createElement(d.GridItem,{span:10},l().createElement(d.Text,{className:"pf-c-form__label",component:d.TextVariants.h5},l().createElement("b",null,"References")),l().createElement(d.Text,null,a.map((function(e,t){return l().createElement(n.default,{href:e.href,target:"_blank",key:"".concat(r,"-reference-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))))),c&&l().createElement(d.Stack,{id:"rule-rationale-".concat(s),style:{marginBottom:"var(--pf-global--spacer--lg)"}},l().createElement(d.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},l().createElement(d.Text,{className:"pf-c-form__label",component:d.TextVariants.h5},l().createElement("b",null,"Rationale"))),l().createElement(d.StackItem,{isFilled:!0},c)))};Br.propTypes={rule:m().object};const Dr=Br,Lr=function(e){return[{cells:[{title:l().createElement(Ue.Z,null,l().createElement(d.Bullseye,null,l().createElement(d.EmptyState,{variant:d.EmptyStateVariant.full},l().createElement(d.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),l().createElement(d.EmptyStateBody,null,"This filter criteria matches no rules. ",l().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:e.length}}]}]};var Ar=r(25870),Nr=l().createElement("span",null,l().createElement(h.ZP,{className:"ins-u-failed"})," High"),Hr=l().createElement("span",null,l().createElement(he.ZP,{className:"ins-u-warning"})," Medium"),Mr=l().createElement("span",null,l().createElement(Ar.Jr,null)," Low"),qr=l().createElement("span",null,l().createElement(S.ZP,null)," Unknown"),Yr=function(e,t,r){return e.filter((function(e){return t.map((function(t){return r(e,t)})).filter((function(e){return!!e})).length>0}))},_r=function(e,t,r){var n=[];return e.forEach((function(e){t.map((function(t){return r(e,t)})).filter((function(e){return!!e})).length>0&&n.push(e)})),n},Gr=[{type:De.Yu.text,label:"Name",filter:function(e,t){return Yr(e,[t],(function(e,t){return e.title.toLowerCase().includes(t.toLowerCase())||e.identifier&&e.identifier.label.toLowerCase().includes(t.toLowerCase())||e.references.filter((function(e){return e.label.toLowerCase().includes(t.toLowerCase())})).length>0}))}},{type:De.Yu.checkbox,label:"Severity",items:[{label:Nr,value:"high"},{label:Hr,value:"medium"},{label:Mr,value:"low"},{label:qr,value:"unknown"}],filter:function(e,t){return _r(e,t,(function(e,t){return e.severity===t}))}}],Kr={type:De.Yu.checkbox,label:"Passed",items:[{label:"Passed rules",value:"passed"},{label:"Failed rules",value:"failed"}],filter:function(e,t){return _r(e,t,(function(e,t){return e.compliant===("passed"===t)}))}},zr={type:De.Yu.checkbox,label:"Remediation available",items:[{label:"Remediation available",value:"true"}],filter:function(e,t){return e.filter((function(e){return"true"!==t[0]||!0===e.remediationAvailable}))}};const Ur=function(e){var t=e.showPassFailFilter,r=e.policies,n=e.remediationAvailableFilter,o=[].concat(Gr);return t&&o.push(Kr),r&&r.length>1&&o.push(function(e){return{type:De.Yu.checkbox,label:"Policy",items:e.map((function(e){return{label:e.name,value:e.id}})),filter:function(e,t){return Yr(e,t,(function(e,t){return(e.profile.policy?e.profile.policy.id:e.profile.id)===t}))}}}(r)),n&&o.push(zr),o};var Jr=r(94263),Wr=function(e){var t=e.system,r=e.profileRules,n=e.columns,o=void 0===n?[Jr.VG,Jr.GC,Jr.zb,Jr.KH,Jr.PS]:n,i=e.remediationsEnabled,a=void 0===i||i,c=e.remediationAvailableFilter,s=void 0!==c&&c,u=e.selectedFilter,p=void 0!==u&&u,f=e.handleSelect,m=e.selectedRefIds,d=void 0===m?[]:m,h=e.hidePassed,y=void 0!==h&&h,b=(0,Ir.uJ)(r),v=o.filter((function(e){return"Passed"===e.title})).length>0,g=r.filter((function(e){return!!e.profile})).map((function(e){var t=e.profile;return{id:t.policy?t.policy.id:t.id,name:t.name}}));return l().createElement(Rr,{"aria-label":"Rules Table",items:b,columns:o,filters:{filterConfig:Ur({showPassFailFilter:v,policies:g,remediationAvailableFilter:s}),activeFilters:{passed:y?"failed":void 0}},options:{identifier:function(e){return e.refId},selectable:!!f||a,onSelect:f,preselected:d,detailsComponent:Dr,emptyRows:Lr(o),selectedFilter:p,dedicatedAction:function(e){var r=e.selected;return a&&l().createElement(Bt.Z,{allSystems:[{id:t.id,profiles:t.testResultProfiles,ruleObjectsFailed:[],supported:t.supported}],selectedRules:(r||[]).filter((function(e){return e.remediationAvailable}))})}}})};Wr.propTypes={profileRules:m().array,loading:m().bool,hidePassed:m().bool,system:m().object,remediationsEnabled:m().bool,remediationAvailableFilter:m().bool,selectedRefIds:m().array,selectedFilter:m().bool,handleSelect:m().func,columns:m().array};const $r=Wr},70597:(e,t,r)=>{"use strict";r.d(t,{$H:()=>n,KJ:()=>o,Ay:()=>i,hT:()=>l,Qy:()=>a});var n=function(e,t,r){return!!(e&&t&&r)},o=function(e){return e<101&&e>=0},i=function(e,t,r){return!!(e&&t&&r&&o(r))},l=function(e){return(null==e?void 0:e.length)>0},a=function(e){return!!e&&e.length>0}},11443:(e,t,r)=>{"use strict";r.d(t,{P0:()=>n,_6:()=>o});var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=null==e?void 0:e.toFixed(t);return n?n+(r?"%":""):"N/A"},o=function(e,t,r){return r||(r=t+"s"),e>1||0===e?r:t}},79886:(e,t,r)=>{"use strict";r.d(t,{jj:()=>a,Sj:()=>c,SO:()=>s,dY:()=>p,qk:()=>f});var n=r(22122),o=r(85061),i=r(92950),l=r.n(i),a=function(e){return(0,o.Z)(new Set(e))},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(r,n){var o=r&&r[e]||"",i=n&&n[e]||"";return o===i?0:"asc"===t?o<i?-1:1:o<i?1:-1}},s=function(e,t){return function(r,o,i){return l().createElement(e,(0,n.Z)({},i,t))}},u=function(e,t){return"function"==typeof e?e(t):t[e]},p=function(e,t,r){return t.sort((function(t,n){return"asc"===r?String(u(e,t)).localeCompare(String(u(e,n))):-String(u(e,t)).localeCompare(String(u(e,n)))}))},f=function(e,t,r,n){return("asc"!==n?r.reverse():r).flatMap((function(r){return e.filter((function(e){return e[t]===r}))}))}},17490:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(96156),o=r(28481),i=r(90484),l=r(92950),a=r(16703);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=function(e){return Object.values(e).filter((function(e){return(0,i.Z)(e)===Object?Object.values(e).length>0:(0,i.Z)(e)===Array?(null==e?void 0:e.length)>0:!!e}))};const p=function(e,t){var r=new a.CN(e),i=(0,l.useState)(r.initialDefaultState()),c=(0,o.Z)(i,2),p=c[0],f=c[1],m=(0,l.useState)([]),d=(0,o.Z)(m,2),h=d[0],y=d[1],b=function(){return f(r.initialDefaultState())},v=function(e){var t=r.removeFilterWithChip(e,p);f(t),y(u(t))},g=r.getChipBuilder();return{conditionalFilter:{filterConfig:r.buildConfiguration((function(e,t){var r=s(s({},p),{},(0,n.Z)({},e,t));f(r),y(u(r))}),p),activeFiltersConfig:{filters:g.chipsFor(p),onDelete:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?b():v(t[0])}}},filtered:t?r.applyFilterToObjectArray(t,p):void 0,activeFilters:p,activeFilterValues:h,buildFilterString:function(){return r.getFilterBuilder().buildFilterString(p)}}}},82176:(e,t,r)=>{"use strict";r.d(t,{T4:()=>l,TU:()=>a,KI:()=>s,qN:()=>u,uJ:()=>p});var n=r(96156);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},a=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},c=function(e){return e.testResultProfiles?l(e.testResultProfiles):[]},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return e&&!!t.supported}),!0)},u=function(e){return e.map((function(e){return i(i({},e),{},{ruleObjectsFailed:c(e),supported:s(e.testResultProfiles),profiles:e.testResultProfiles})}))},p=function(e){return e.flatMap((function(e){return e.rules.map((function(t){var r=t.identifier&&JSON.parse(t.identifier);return i(i({},t),{},{references:t.references?JSON.parse(t.references):[],identifier:r&&r.label?r:null,profile:e.profile})}))}))}},22868:()=>{},95574:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/8.1bc11f7339abe6985939.js.map
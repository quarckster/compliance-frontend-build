(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[402],{44434:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComplianceSystems:()=>I,default:()=>S});var r,o=n(96156),i=n(32465),s=n(92950),a=n.n(s),c=n(557),l=n(44119),u=n.n(l),d=n(46829),p=n(48716),f=n(39173),m=n(86350),y=n(34171),h=n(58820),v=n(27803),b=n(99030),g=n(77346);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=u()(r||(r=(0,i.Z)(['\n{\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                name\n                refId\n                majorOsVersion\n            }\n        }\n    }\n}\n']))),I=function(){var e,t=(0,g.ZP)("newInventory"),n=(0,d.useQuery)(j),r=n.data,o=n.error,i=n.loading,l=(0,c.useDispatch)(),u=[O({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},t&&{key:"display_name",renderFunc:b.B3}),O({key:"facts.compliance.policies",title:"Policies",props:{width:40,isStatic:!0}},t&&{key:"policyNames",renderFunc:function(e){return((0,b.ek)({policyNames:e})||{title:""}).title}}),O({key:"facts.compliance.details_link",title:"",props:{width:20,isStatic:!0}},t&&{key:"testResultProfiles",renderFunc:function(e,t){return((0,b.rI)({testResultProfiles:e,id:t})||{title:""}).title}})],E=null==r||null===(e=r.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));(0,s.useLayoutEffect)((function(){l({type:"SELECT_ENTITIES",payload:{ids:[]}})}),[]);var I=t?h.e_:h.r0;return a().createElement(a().Fragment,null,a().createElement(p.Z,{className:"page-header"},a().createElement(f.Z,{title:"Systems"})),a().createElement(m.Z,null,a().createElement(y.tC,{stateValues:{error:o,data:r,loading:i}},a().createElement(y.K7,{stateKey:"data"},E&&a().createElement(I,{query:v.Ep,defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsFilter:!0,showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,columns:u,policies:E})))))};const S=I},54394:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreatePolicy:()=>Se,default:()=>we});var r,o=n(96156),i=n(28481),s=n(92950),a=n.n(s),c=n(334),l=n(33766),u=n(557),d=n(45697),p=n.n(d),f=n(32413),m=n(32465),y=n(42065),h=n(34171),v=n(44119),b=n.n(v),g=n(46829),E=n(6023),O=n(15113),j=n(46314),I=n(35592);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=b()(r||(r=(0,m.Z)(['\nquery benchmarksAndProfiles {\n    latestBenchmarks {\n        id\n        title\n        refId\n        version\n        osMajorVersion\n        profiles {\n            id\n            name\n            refId\n            description\n            complianceThreshold\n        }\n    }\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                refId\n                benchmark {\n                    refId\n                }\n            }\n        }\n    }\n}\n']))),T=function(){return a().createElement(f.Tooltip,{position:"right",content:"Policy types are OpenSCAP policies that are supported by RHEL. For each major version of RHEL, users can create one policy of each type."},a().createElement(y.ZP,{style:{opacity:.5}}))},V=function(e){var t=e.change,n=e.selectedBenchmarkId,r=(0,g.useQuery)(w,{fetchPolicy:"no-cache"}),o=r.data,i=r.error,s=r.loading,c=(0,u.useDispatch)();if(i)return i;if(s)return a().createElement(E.Z,null);var l,d,p,m,y=o.latestBenchmarks;if(n){l=y.find((function(e){return e.id===n}));var v=(p=o.profiles.edges,m=l,p.filter((function(e){return m.refId===e.node.benchmark.refId})).map((function(e){return e.node.refId})));d=l.profiles.map((function(e){return P(P({},e),{},{disabled:v.includes(e.refId)})}))}return a().createElement(a().Fragment,null,a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),a().createElement(f.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),a().createElement(f.Form,null,a().createElement(f.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},y&&y.sort((function(e,t){return e.refId.localeCompare(t.refId)})).map((function(e){var r=e.id,o=e.osMajorVersion;return a().createElement(f.Button,{key:r,onClick:function(){return function(e){var n,r=e.id,o=e.osMajorVersion;(null===(n=l)||void 0===n?void 0:n.osMajorVersion)!==o&&(t("systems",[]),c({type:"SELECT_ENTITIES",payload:{ids:[]}})),t("benchmark",r),t("osMajorVersion",o)}(e)},className:"wizard-os-button ".concat(n===r?"active-wizard-os-button":""),variant:"tertiary"},"RHEL ".concat(o))}))),a().createElement(f.FormGroup,{isRequired:!0,labelIcon:a().createElement(T,null),label:"Policy type",fieldId:"policy-type"},a().createElement(h.yL,{profiles:l&&d,onClick:function(){t("selectedRuleRefIds",null)}}))))};V.propTypes={selectedBenchmarkId:p().string,change:O.ZP.change};var Z=(0,l.Z)("policyForm");const R=(0,I.compose)((0,u.connect)((function(e){return{selectedBenchmarkId:Z(e,"benchmark")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(V);var k,C=n(2707),x=n(92223),M=n(77346),F=n(73277);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=b()(k||(k=(0,m.Z)(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),A=function(e){var t=e.policy,n=e.selectedRuleRefIds,r=e.change,o=e.osMajorVersion,i=e.osMinorVersionCounts,c=(0,C.eo)(["Name","Severity","Ansible"]),l=(0,F.Z)("benchmarks",{type:"benchmark",include:["profiles"],params:{search:"os_major_version = ".concat(o," ")+"and latest_supported_os_minor_version ^ (".concat(i.map((function(e){return e.osMinorVersion})).join(","),")")}}),u=l.data,d=l.loading,p=[],m=i.map((function(e){var r,o,i,s=e.osMinorVersion,a=e.count;if(s="".concat(s),u){var c,l,d,f,m=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(u.collection,s);m&&(o=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(m,t.refId))&&(o=_(_({},o),{},{rules:null===(c=o.relationships)||void 0===c||null===(l=c.rules)||void 0===l?void 0:l.data,benchmark:null===(d=o.relationships)||void 0===d||null===(f=d.benchmark)||void 0===f?void 0:f.data}),i=null==n?void 0:n.find((function(e){return e.id===o.id})),p.push(o.id))}return{profile:o,systemCount:a,newOsMinorVersion:s,selectedRuleRefIds:null===(r=i)||void 0===r?void 0:r.ruleRefIds}}));m=m.filter((function(e){return!!e.profile}));var y="".concat((p||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),v=d||0===y.length,b=(0,g.useQuery)(L,{variables:{filter:y},skip:v}),O=b.data,j=b.error,I=b.loading,S=(null==p?void 0:p.length)>0?O:void 0,P=!(!I&&!d)||void 0,w=!j&&!P&&0===(null==p?void 0:p.length),T=v?[]:null==O?void 0:O.profiles.edges.map((function(e){return e.node}));return(0,s.useLayoutEffect)((function(){P||r("selectedRuleRefIds",T.map((function(e){var t;return{id:e.id,ruleRefIds:(null==n||null===(t=n.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.ruleRefIds)||e.rules.map((function(e){return e.refId}))}})))}),[T,P]),a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-pb-md"},a().createElement(f.Text,{component:f.TextVariants.h1},"Rules"),a().createElement(f.Text,null,"Customize your ",a().createElement("b",null,t.name)," SCAP policy by including and excluding rules."),a().createElement(f.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),a().createElement(h.tC,{stateValues:{error:j,data:S,loading:P,noRuleSets:w}},a().createElement(h.K7,{stateKey:"noRuleSets"},a().createElement(f.EmptyState,null,a().createElement(f.Title,{headingLevel:"h1",size:"xl"},"No rules can be configured"),a().createElement(f.EmptyStateBody,null,"The policy type selected does not exist for the systems and OS versions selected in the previous steps."))),a().createElement(h.K7,{stateKey:"loading"},a().createElement(x.Z,null,a().createElement(E.Z,null))),a().createElement(h.K7,{stateKey:"data"},a().createElement(h.Hv,{tabsData:m,columns:c,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:function(e,t){var o=n.map((function(n){return n.id===e.id?{id:n.id,ruleRefIds:t}:n}));r("selectedRuleRefIds",o)}}))))};A.propTypes={policy:p().object,change:O.ZP.change,osMajorVersion:p().string,osMinorVersionCounts:p().arrayOf(p().shape({osMinorVersion:p().number,count:p().number})),selectedRuleRefIds:p().array};var N=(0,l.Z)("policyForm");const U=(0,I.compose)((0,u.connect)((function(e){return{policy:JSON.parse(N(e,"profile")),osMajorVersion:N(e,"osMajorVersion"),osMinorVersionCounts:N(e,"osMinorVersionCounts"),selectedRuleRefIds:N(e,"selectedRuleRefIds")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(A);var $,q=b()($||($=(0,m.Z)(["\nquery benchmarkAndProfile($benchmarkId: String!, $profileId: String!){\n    benchmark(id: $benchmarkId) {\n        id\n        rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n    profile(id: $profileId) {\n        id\n        name\n        refId\n        rules {\n            id\n            refId\n        }\n    }\n}\n"]))),B=function(e){var t,n,r=e.profileId,o=e.benchmarkId,c=e.osMajorVersion,l=e.osMinorVersionCounts,u=e.selectedRuleRefIds,d=e.change,p=(0,M.ZP)("multiversionTabs"),m=(0,C.eo)(["Name","Severity","Ansible"]),y=(0,g.useQuery)(q,{variables:{profileId:r,benchmarkId:o}}),v=y.data,b=y.error,O=y.loading,j=(0,s.useState)(null),I=(0,i.Z)(j,2),S=I[0],P=I[1],w=v&&[{profile:{refId:v.profile.refId,name:v.profile.name},rules:v.benchmark.rules}];return(0,s.useEffect)((function(){if(v){var e=v.profile.rules.map((function(e){return e.refId}));P(e),u||d("selectedRuleRefIds",e)}}),[v,d,u]),a().createElement(h.tC,{stateValues:{error:b,data:v,loading:O}},a().createElement(h.K7,{stateKey:"loading"},a().createElement(x.Z,null,a().createElement(E.Z,null))),a().createElement(h.K7,{stateKey:"data"},a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1},"Rules")),a().createElement(f.TextContent,null,a().createElement(f.Text,null,"Edit your policy by including and excluding rules."),a().createElement(f.Text,null,"Selected policy type ",a().createElement("strong",null,null==v?void 0:v.profile.name)," has ",null==S?void 0:S.length," rules.â€‚",u&&(n=null==(t=u)?void 0:t.filter((function(e){return null==S?void 0:S.includes(e)})),!(t&&S&&n.length===S.length))&&a().createElement(f.Button,{variant:"link",isInline:!0,onClick:function(){return d("selectedRuleRefIds",S)}},"Reset to default selection")),p&&l&&l.length>0&&a().createElement(f.Text,null,"Tailoring for"," ",l.map((function(e){var t=e.osMinorVersion,n=e.count;return"RHEL ".concat(c,".").concat(t," (").concat(n," systems)")})).join(", "))),a().createElement(C.ZP,{remediationsEnabled:!1,tailoringEnabled:!0,selectedFilter:!0,remediationAvailableFilter:!0,columns:m,loading:O,handleSelect:function(e){return d("selectedRuleRefIds",e)},profileRules:w,selectedRefIds:u||[]})))};B.propTypes={profileId:p().string,benchmarkId:p().string,change:O.ZP.change,osMajorVersion:p().string,osMinorVersionCounts:p().arrayOf(p().shape({osMinorVersion:p().number,count:p().number})),selectedRuleRefIds:p().array};var K=(0,l.Z)("policyForm"),H=(0,I.compose)((0,u.connect)((function(e){return{benchmarkId:K(e,"benchmark"),profile:JSON.parse(K(e,"profile")),profileId:JSON.parse(K(e,"profile")).id,osMajorVersion:K(e,"osMajorVersion"),osMinorVersionCounts:K(e,"osMinorVersionCounts"),selectedRuleRefIds:K(e,"selectedRuleRefIds")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(B);const G=function(){for(var e=(0,M.ZP)("multiversionTabs"),t=e?U:H,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a().createElement(t,r)};var z=n(58820),W=n(27803),Y=n(99030);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"You do not have any ",a().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.",a().createElement("br",null),"Policies must be created with at least one system.")),a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Choose a different operating system, or connect ",a().createElement("b",null,"RHEL ",t)," systems to Insights.")),a().createElement(f.WizardContextConsumer,null,(function(e){var t=e.goToStepById;return a().createElement(f.Button,{onClick:function(){return t(1)}},"Choose a different operating system")})))};X.propTypes={osMajorVersion:p().number};var ee=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Select which of your ",a().createElement("b",null,"RHEL ",t)," systems should be included in this policy.",a().createElement("br",null),"Systems can be added or removed at any time.")))};ee.propTypes={osMajorVersion:p().number};var te=function(e){var t=e.change,n=e.osMajorVersion,r=e.osMinorVersionCounts,o=e.selectedSystemIds,i=(0,M.ZP)("newInventory"),c=(0,M.ZP)("multiversionTabs"),l=[Q({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},i&&{key:"display_name",renderFunc:function(e,t,n){var r=n.name;return e||r}}),Q({key:"facts.compliance.osMinorVersion",title:"Operating system",props:{width:40,isStatic:!0}},i&&{key:"osMinorVersion",renderFunc:function(e,t,n){var r=n.osMajorVersion;return"RHEL ".concat(r,".").concat(e)}})];(0,s.useEffect)((function(){o&&t("systems",o),r&&t("osMinorVersionCounts",r)}),[o,r,t]);var u=i?z.e_:z.r0;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,{component:f.TextVariants.h1},"Systems")),a().createElement(f.Form,null,a().createElement(f.FormGroup,null,a().createElement(u,{showOsMinorVersionFilter:[n],prependComponent:a().createElement(ee,{osMajorVersion:n}),emptyStateComponent:c?a().createElement(X,{osMajorVersion:n}):void 0,columns:l,remediationsEnabled:!1,compact:!0,showActions:!1,query:W.Y0,defaultFilter:n&&"os_major_version = ".concat(n),enableExport:!1}))))};te.propTypes={osMajorVersion:p().string,osMinorVersionCounts:p().arrayOf(p().shape({osMinorVersion:p().number,count:p().number})),selectedSystemIds:p().array,change:O.ZP.change},te.defaultProps={selectedSystemIds:[],osMinorVersionCounts:[]};var ne=(0,l.Z)("policyForm");const re=(0,I.compose)((0,u.connect)((function(e){var t,n;return{osMajorVersion:ne(e,"osMajorVersion"),osMinorVersionCounts:(0,Y.Nw)(null===(t=e.entities)||void 0===t?void 0:t.selectedEntities),selectedSystemIds:((null===(n=e.entities)||void 0===n?void 0:n.selectedEntities)||[]).map((function(e){return e.id}))}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(te);var oe=n(6455),ie=n(74726),se=function(e){var t=e.change,n=e.policy,r=e.refId;return(0,s.useEffect)((function(){n&&n.refId!==r&&(t("name","".concat(n.name)),t("refId","".concat(n.refId)),t("description","".concat(n.description)))}),[n]),a().createElement(a().Fragment,null,a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1},"Details")),a().createElement("br",null),a().createElement(f.Form,{id:"editpolicydetails"},a().createElement(f.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},a().createElement(oe.Z,{component:ie._c,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),a().createElement(f.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},a().createElement(oe.Z,{type:"text",component:ie._c,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),a().createElement(f.FormGroup,{label:"Description",fieldId:"description"},a().createElement(oe.Z,{type:"text",component:ie.do,id:"description",name:"description","aria-describedby":"description"})),a().createElement(f.FormGroup,{label:"Business objective",fieldId:"businessObjective"},a().createElement(oe.Z,{type:"text",component:ie._c,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:n.businessObjective})),a().createElement(h._z,{showTitle:!1,previousThreshold:n.complianceThreshold})))},ae=(0,l.Z)("policyForm");se.propTypes={policy:p().object,refId:p().string,change:O.ZP.change};const ce=(0,I.compose)((0,u.connect)((function(e){var t=JSON.parse(ae(e,"profile"));return{policy:t,refId:ae(e,"refId"),initialValues:{name:"".concat(t.name),refId:"".concat(t.refId),description:"".concat(t.description),benchmark:ae(e,"benchmark"),osMajorVersion:ae(e,"osMajorVersion"),profile:ae(e,"profile")}}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(se);var le,ue=b()(le||(le=(0,m.Z)(["\nquery review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n        id\n        osMajorVersion\n    }\n}\n"]))),de=function(e){var t=e.benchmarkId,n=e.name,r=e.businessObjective,o=e.complianceThreshold,i=e.parentProfileName,s=e.osMinorVersionCounts,c=(0,g.useQuery)(ue,{variables:{benchmarkId:t}}),l=c.data,u=c.error,d=c.loading;if(u)return u;if(d)return a().createElement(E.Z,null);var p=l.benchmark.osMajorVersion;return a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1},"Review"),a().createElement(f.Text,null,"Review your SCAP policy before finishing."),a().createElement(f.Text,{component:f.TextVariants.h3,style:{marginTop:0}},n),a().createElement(f.TextList,{component:f.TextListVariants.dl},a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Policy type"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},i),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Compliance threshold"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},o,"%"),r&&a().createElement(a().Fragment,null,a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Business objective"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},r)),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Systems"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},a().createElement(f.TextList,{component:f.TextListVariants.dl},s.map((function(e){var t=e.osMinorVersion,n=e.count;return a().createElement(a().Fragment,{key:t},a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt,style:{"font-weight":"normal"}},"RHEL ",p,".",t),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},n," ",n>1?"systems":"system"))}))))))};de.propTypes={benchmarkId:p().string,refId:p().string,name:p().string,businessObjective:p().string,complianceThreshold:p().number,parentProfileName:p().string,osMinorVersionCounts:p().arrayOf(p().shape({osMinorVersion:p().number,count:p().number}))};var pe=(0,l.Z)("policyForm");const fe=(0,u.connect)((function(e){return{benchmarkId:pe(e,"benchmark"),refId:pe(e,"refId"),name:pe(e,"name"),businessObjective:pe(e,"businessObjective"),osMinorVersionCounts:pe(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(pe(e,"complianceThreshold"))||100,parentProfileName:JSON.parse(pe(e,"profile")).name,rulesCount:pe(e,"selectedRuleRefIds").length}}))(de);var me=n(5913),ye=n(92310),he=n(37089),ve=function(e){var t=e.errors;return t&&Array.isArray(t)&&t.length>0&&a().createElement(f.EmptyStateBody,{className:"wizard-failed-errors"},a().createElement(f.List,null,t.map((function(e){return a().createElement(f.ListItem,{key:e},e)}))))};ve.propTypes={errors:p().array};var be=function(e){var t=e.onWizardFinish,n=e.cloneFromProfileId,r=e.description,o=e.name,c=e.complianceThreshold,l=e.businessObjective,u=e.refId,d=e.benchmarkId,p=e.systemIds,m=e.selectedRuleRefIds,y=(0,s.useState)(0),v=(0,i.Z)(y,2),b=v[0],g=v[1],E=(0,s.useState)("This usually takes a minute or two."),O=(0,i.Z)(E,2),j=O[0],I=O[1],S=(0,s.useState)(null),P=(0,i.Z)(S,2),w=P[0],T=P[1],V=(0,s.useState)(!1),Z=(0,i.Z)(V,2),R=Z[0],k=Z[1],C=(0,he.Z)(),x=function(e){g(100*e)};return(0,s.useEffect)((function(){var e={cloneFromProfileId:n,description:r,name:o,complianceThreshold:c,businessObjective:{title:l},refId:u,benchmarkId:d,hosts:p.map((function(e){return{id:e}})),selectedRuleRefIds:m};C(null,e,x).then((function(){g(100),I()})).catch((function(e){var t,n,r;I(null===(t=e.networkError)||void 0===t?void 0:t.message),T(null===(n=e.networkError)||void 0===n||null===(r=n.result)||void 0===r?void 0:r.errors),k(!0)}))}),[]),a().createElement(f.Bullseye,null,a().createElement(f.EmptyState,{variant:f.EmptyStateVariant.full},a().createElement(f.EmptyStateIcon,{icon:me.ZP}),a().createElement("br",null),a().createElement(f.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),a().createElement(f.EmptyStateBody,null,a().createElement(h.ko,{percent:b,failed:R})),a().createElement(f.EmptyStateBody,{className:R&&"wizard-failed-message"},j),a().createElement(ve,{error:w}),a().createElement(f.EmptyStateSecondaryActions,null,(100===b||R)&&a().createElement(f.Button,{variant:"primary",onClick:function(){t()}},R?"Back":"Return to application"))))};be.propTypes={benchmarkId:p().string.isRequired,client:p().object.isRequired,businessObjective:p().object,cloneFromProfileId:p().string.isRequired,refId:p().string.isRequired,name:p().string.isRequired,description:p().string,systemIds:p().array,complianceThreshold:p().number,onWizardFinish:p().func,selectedRuleRefIds:p().arrayOf(p().string).isRequired};var ge=(0,l.Z)("policyForm");const Ee=(0,I.compose)((0,u.connect)((function(e){return{benchmarkId:ge(e,"benchmark"),businessObjective:ge(e,"businessObjective"),cloneFromProfileId:JSON.parse(ge(e,"profile")).id,refId:ge(e,"refId"),name:ge(e,"name"),description:ge(e,"description"),complianceThreshold:parseFloat(ge(e,"complianceThreshold"))||100,systemIds:ge(e,"systems"),selectedRuleRefIds:ge(e,"selectedRuleRefIds")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),ye.CG)(be);var Oe=n(70597);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(e){var t=e.benchmark,n=e.osMajorVersion,r=e.complianceThreshold,o=e.name,l=e.profile,u=e.refId,d=e.selectedRuleRefIds,p=e.systemIds,m=(0,c.useHistory)(),y=(0,s.useState)(1),h=(0,i.Z)(y,2),v=h[0],b=h[1],g=function(){var e=m.location;e.hash&&m.push(Ie(Ie({},e),{},{hash:""}))},E=function(){m.push("/scappolicies")},O=[{id:1,name:"Create SCAP policy",component:a().createElement(R,null),enableNext:(0,Oe.$H)(t,n,l)},{id:2,name:"Details",component:a().createElement(ce,null),canJumpTo:v>=2,enableNext:(0,Oe.Ay)(o,u,r)},{id:3,name:"Systems",component:a().createElement(re,null),canJumpTo:v>=3,enableNext:(0,Oe.Qy)(p)},{id:4,name:"Rules",component:a().createElement(G,null),canJumpTo:(null==p?void 0:p.length)>0&&v>=4,enableNext:(0,Oe.hT)(d)},{id:5,name:"Review",component:a().createElement(fe,null),nextButtonText:"Finish",canJumpTo:(0,Oe.hT)(d)&&(null==p?void 0:p.length)>0&&v>=5},{id:6,name:"Finished",component:a().createElement(Ee,{onWizardFinish:E}),isFinishedStep:!0,canJumpTo:(null==p?void 0:p.length)>0&&v>=6}];return a().createElement(a().Fragment,null,a().createElement(f.Wizard,{isOpen:!0,width:1220,onNext:function(e){var t=e.id;b(v<t?t:v),g()},onGoToStep:g,onBack:g,onClose:E,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:O}))};Se.propTypes={benchmark:p().string,osMajorVersion:p().string,osMinorVersionCounts:p().arrayOf(p().shape({osMinorVersion:p().number,count:p().number})),complianceThreshold:p().string,businessObjective:p().object,dispatch:p().func,isOpen:p().bool,name:p().string,onWizardFinish:p().func,profile:p().string,refId:p().string,selectedRuleRefIds:p().arrayOf(p().string),systemIds:p().arrayOf(p().string)},Se.defaultProps={isOpen:!1};var Pe=(0,l.Z)("policyForm");const we=(0,u.connect)((function(e){return{benchmark:Pe(e,"benchmark"),osMajorVersion:Pe(e,"osMajorVersion"),osMinorVersionCounts:Pe(e,"osMinorVersionCounts"),businessObjective:Pe(e,"businessObjective"),complianceThreshold:Pe(e,"complianceThreshold")||"100.0",name:Pe(e,"name"),profile:Pe(e,"profile"),refId:Pe(e,"refId"),selectedRuleRefIds:Pe(e,"selectedRuleRefIds"),systemIds:Pe(e,"systems")}}))(Se)},45613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EditPolicy:()=>Q,MULTIVERSION_QUERY:()=>Y,default:()=>X});var r=n(96156),o=n(85061),i=n(28481),s=n(32465),a=n(92950),c=n.n(a),l=n(45697),u=n.n(l),d=n(334),p=n(557),f=n(44119),m=n.n(f),y=n(46829),h=n(32413),v=n(34171),b=n(79886),g=n(52710),E=n(7648),O=n(70597);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,o=function(){var e=(0,a.useState)(!0),t=(0,i.Z)(e,2),n=t[0],r=t[1];return[n,function(e){var t=(0,O.KJ)(e);return r(t),t}]}(),s=(0,i.Z)(o,2),l=s[0],u=s[1];return c().createElement(c().Fragment,null,c().createElement(h.FormGroup,{label:"Policy description",isRequired:!0,fieldId:"description"},c().createElement(h.TextArea,{style:{width:800,height:110},isRequired:!0,type:"text",id:"description",name:"description","aria-describedby":"description",defaultValue:n.description,onChange:function(e){r((function(t){return I(I({},t),{},{description:e})}))}})),c().createElement(h.FormGroup,{label:"Business objective",fieldId:"business-objective"},c().createElement(h.TextInput,{type:"text",style:{width:300},id:"business-objective",name:"business-objective","aria-describedby":"business-objective",defaultValue:null==n||null===(t=n.businessObjective)||void 0===t?void 0:t.title,onChange:function(e){r((function(t){return I(I({},t),{},{businessObjective:I(I({},t.businessObjective),{},{title:e})})}))}})),c().createElement(h.FormGroup,{validated:l?"default":"error",label:"Compliance threshold (%)",fieldId:"policy-threshold",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended"},c().createElement(h.TextInput,{type:"number",style:{width:150},name:"compliance-threshold",id:"compliance-threshold",defaultValue:n.complianceThreshold,"aria-describedby":"policy-threshold",onChange:function(e){r((function(t){return I(I({},t),{},{complianceThreshold:e,complianceThresholdValid:u(e)})}))}})))};S.propTypes={policy:u().shape({description:u().string,businessObjective:u().object,complianceThreshold:u().oneOfType([u().string,u().number])}),setUpdatedPolicy:u().func};const P=S;var w,T=n(92223),V=n(6023),Z=n(73277);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=m()(w||(w=(0,s.Z)(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),x=function(){return c().createElement(h.EmptyState,null,c().createElement(h.Title,{headingLevel:"h5",size:"lg"},"No rules can be configured"),c().createElement(h.EmptyStateBody,null,"This policy has no associated systems, and therefore no rules can be configured."),c().createElement(h.EmptyStateBody,null,"Add at least one system to configure rules for this policy."))},M=function(e){var t,n=e.handleSelect,r=e.policy,o=e.selectedRuleRefIds,i=e.osMinorVersionCounts,s=null==r?void 0:r.osMajorVersion,l=Object.keys(i).sort(),u="os_major_version = ".concat(s," ")+"and latest_supported_os_minor_version ^ (".concat(l.join(","),")"),d=(0,Z.Z)("benchmarks",{type:"benchmark",include:["profiles"],params:{search:u},skip:0===l.length},[u]),p=d.data,f=d.loading,m=[],g=Object.values(i).sort((0,b.S)("osMinorVersion","desc")).map((function(e){var t,n=e.osMinorVersion,i=e.count;n="".concat(n);var s=r.policy.profiles.find((function(e){return e.osMinorVersion===n}));if(!s&&p){var a=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(p.collection,n);if(a){var c,l,u,d,f=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(a,r.refId);f&&(s=r.policy.profiles.find((function(e){return e.parentProfileId===f.id})),s=k(k({},f),{},{benchmark:null===(c=f.relationships)||void 0===c||null===(l=c.benchmark)||void 0===l?void 0:l.data,rules:null===(u=f.relationships)||void 0===u||null===(d=u.rules)||void 0===d?void 0:d.data},s))}}return{profile:s,systemCount:i,newOsMinorVersion:n,selectedRuleRefIds:null==o||null===(t=o.find((function(e){var t;return e.id===(null===(t=s)||void 0===t?void 0:t.id)})))||void 0===t?void 0:t.ruleRefIds}}));(g=g.filter((function(e){var t=e.profile,n=e.newOsMinorVersion;return!!t&&n}))).forEach((function(e){return m.push(e.profile.id)}));var E="".concat((m||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),O=(0,y.useQuery)(C,{variables:{filter:E},skip:0===E.length}),j=O.data,I=O.error,S=!(!O.loading&&!f)||void 0,P=!S&&(null===(t=g)||void 0===t?void 0:t.length)>0?j:void 0;return(0,a.useLayoutEffect)((function(){j&&((null==j?void 0:j.profiles.edges.map((function(e){return e.node})))||[]).forEach((function(e){if(!(null==o?void 0:o.find((function(t){return t.id===(null==e?void 0:e.id)})))){var t=e.rules.map((function(e){return e.refId}));n(e,t)}}))}),[j]),c().createElement(v.tC,{stateValues:{error:I,data:P,loading:S,empty:!S&&!P}},c().createElement(v.K7,{stateKey:"loading"},c().createElement(T.Z,null,c().createElement(V.Z,null))),c().createElement(v.K7,{stateKey:"data"},c().createElement(h.TextContent,null,c().createElement(h.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),c().createElement(v.Hv,{tabsData:g,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:n})),c().createElement(v.K7,{stateKey:"empty"},c().createElement(x,null)))};M.propTypes={handleSelect:u().func,policy:u().object,osMinorVersionCounts:u().shape({osMinorVersion:u().shape({osMinorVersion:u().number,count:u().number})}),selectedRuleRefIds:u().array};const F=M;var D=n(58820),_=n(27803);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(h.TextContent,{className:"pf-u-mb-md"},c().createElement(h.Text,null,"You do not have any ",c().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.")),c().createElement(h.TextContent,{className:"pf-u-mb-md"},c().createElement(h.Text,null,"Connect RHEL ",t," systems to Insights.")))};N.propTypes={osMajorVersion:u().number};var U=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(h.TextContent,{className:"pf-u-mb-md"},c().createElement(h.Text,null,"Select which of your ",c().createElement("b",null,"RHEL ",t)," systems should be included in this policy.")))};U.propTypes={osMajorVersion:u().number};var $=function(e){var t=e.osMajorVersion,n=e.policyOsMinorVersions,r=(0,d.useHistory)(),o=r.push,i=r.location,s=(0,p.useSelector)((function(e){var t,n;return null==e||null===(t=e.entities)||void 0===t||null===(n=t.selectedEntities)||void 0===n?void 0:n.map((function(e){return"".concat(e.osMinorVersion)}))}));return c().createElement(c().Fragment,null,c().createElement(D.e_,{showOsMinorVersionFilter:[t],prependComponent:c().createElement(U,{osMajorVersion:t}),emptyStateComponent:c().createElement(N,{osMajorVersion:t}),columns:[{key:"display_name",title:"Name",props:{width:40,isStatic:!0},renderFunc:function(e,t,n){var r=n.name;return e||r}},{key:"osMinorVersion",title:"Operating system",props:{width:40,isStatic:!0},renderFunc:function(e,t,n){var r=n.osMajorVersion;return"RHEL ".concat(r,".").concat(e)}}],compact:!0,showActions:!1,query:_.Y0,defaultFilter:t&&"os_major_version = ".concat(t),enableExport:!1,remediationsEnabled:!1}),(null==s?void 0:s.find((function(e){return!n.includes(e)})))&&c().createElement(h.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:c().createElement(h.AlertActionLink,{onClick:function(){return o(A(A({},i),{},{hash:"#rules"}))}},"Open rule editing")},c().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well.")))};$.propTypes={osMajorVersion:u().string,policyOsMinorVersions:u().arrayOf(u().number)};const q=$;var B,K=n(37089),H=n(77346),G=n(99030);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=m()(B||(B=(0,s.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        osMajorVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                parentProfileId\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n            osMajorVersion\n        }\n    }\n}\n"]))),J=function(e,t){return(e||[]).reduce((function(e,t){var n;return""!==t.osMinorVersion&&(e[n=t.osMinorVersion]||(e[n]={osMinorVersion:t.osMinorVersion,count:0})),e}),(0,G.UP)(t||[]))},Q=function(e){var t,n=e.route,r=(0,d.useParams)().policy_id,s=(0,y.useQuery)(Y,{variables:{policyId:r}}).data,l=null==s?void 0:s.profile,u=(null==l||null===(t=l.policy)||void 0===t?void 0:t.profiles)||[],f=(0,H.ZP)("newInventory"),m=(0,p.useDispatch)(),O=(0,g.Wb)(),j=(0,a.useState)(null),I=(0,i.Z)(j,2),S=I[0],w=I[1],T=(0,a.useState)([]),V=(0,i.Z)(T,2),Z=V[0],R=V[1],k=(0,a.useState)({}),C=(0,i.Z)(k,2),x=C[0],M=C[1],D=(0,K.Z)(),_=(0,g.C3)("/scappolicies"),L=(0,a.useState)(),A=(0,i.Z)(L,2),N=A[0],U=A[1],$=(0,p.useSelector)((function(e){var t;return null==e||null===(t=e.entities)||void 0===t?void 0:t.selectedEntities})),B=S&&!S.complianceThresholdValid,G=function(){f&&m({type:"SELECT_ENTITIES",payload:{ids:[]}}),_({hash:O})},z=[c().createElement(h.Button,{isDisabled:B,key:"save",variant:"primary",spinnerAriaValueText:"Saving",isLoading:N,onClick:function(){N||(U(!0),D(l,S).then((function(){U(!1),G()})).catch((function(){U(!1),G()})))}},"Save"),c().createElement(h.Button,{key:"cancel",variant:"link",onClick:function(){return G()}},"Cancel")],Q=function(){l&&R(u.map((function(e){return{id:e.id,ruleRefIds:e.rules.map((function(e){return e.refId}))}})))};return(0,a.useEffect)((function(){w(W(W({},S),{},{hosts:$||[]})),Q(),M(J(u,$))}),[$]),(0,a.useEffect)((function(){return w(W(W({},S),{},{selectedRuleRefIds:Z}))}),[Z]),(0,a.useEffect)((function(){if(l){var e=l.complianceThreshold<101&&l.complianceThreshold>0;w(W(W({},l),{},{complianceThresholdValid:e})),Q(),m({type:"SELECT_ENTITIES",payload:{ids:(null==l?void 0:l.hosts)||[]}}),M(J(u,l.hosts))}}),[l]),(0,E.a)(n,null==l?void 0:l.name),c().createElement(h.Modal,{isOpen:!0,style:{height:"768px"},width:1220,title:"Edit ".concat(l?l.name:""),onClose:function(){return G()},actions:z},l?c().createElement(h.Form,null,c().createElement(v.tn,{defaultTab:"details"},c().createElement(h.Tab,{eventKey:"details",title:c().createElement(h.TabTitleText,null,"Details")},c().createElement(P,{policy:l,setUpdatedPolicy:w})),c().createElement(h.Tab,{eventKey:"rules",title:c().createElement(h.TabTitleText,null,"Rules")},c().createElement(F,{policy:l,handleSelect:function(e,t){var n=Z.filter((function(t){return t.id!==e.id}));R([{id:e.id,ruleRefIds:t}].concat((0,o.Z)(n)))},selectedRuleRefIds:Z,osMinorVersionCounts:x})),c().createElement(h.Tab,{eventKey:"systems",title:c().createElement(h.TabTitleText,null,"Systems")},c().createElement(q,{osMajorVersion:l.osMajorVersion,policyOsMinorVersions:(0,b.j)(u.map((function(e){return e.osMinorVersion})))})))):c().createElement(h.Spinner,null))};Q.propTypes={route:u().object};const X=Q},37089:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(92137),o=n(28481),i=n(87757),s=n.n(i),a=n(46829),c=n(39859);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const d=function(){var e,t,n=(e=(0,a.useMutation)(c.Jd),t=(0,o.Z)(e,1)[0],function(){var e=(0,r.Z)(s().mark((function e(n,r){var o,i,a,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==n||null===(o=n.businessObjective)||void 0===o?void 0:o.title)!==(null==r?void 0:r.title)){e.next=4;break}return e.abrupt("return",null==n||null===(i=n.businessObjective)||void 0===i?void 0:i.id);case 4:if(""!==(null==r?void 0:r.title)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,t({variables:{input:{title:r.title}}});case 10:if(a=e.sent,c=a.data,!(l=a.error)){e.next=15;break}throw l;case 15:return e.abrupt("return",c.createBusinessObjective.businessObjective.id);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),i=(0,a.useMutation)(c.r0),u=(0,o.Z)(i,1)[0],d=(0,a.useMutation)(c.nT),p=(0,o.Z)(d,1)[0],f=function(){var e=(0,a.useMutation)(c.oI),t=(0,o.Z)(e,1)[0];return function(){var e=(0,r.Z)(s().mark((function e(n,r){var o,i,a,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.id,e.next=3,t({variables:{input:{id:i,systemIds:r.map((function(e){return e.id}))}}});case 3:if(a=e.sent,c=a.data,!(l=a.error)){e.next=8;break}throw l;case 8:return e.abrupt("return",null==c||null===(o=c.associateSystems)||void 0===o?void 0:o.profile);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}(),m=function(){var e=(0,a.useMutation)(c.Dy),t=(0,o.Z)(e,1)[0];return function(){var e=(0,r.Z)(s().mark((function e(n,r){var o,i,a,c,l,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.id,i=n.ruleRefIds,a=r.find((function(e){return e.id===o||e.parentProfileId===o})),c={id:null==a?void 0:a.id,ruleRefIds:i},e.next=5,t({variables:{input:c}});case 5:if(l=e.sent,!(u=l.error)){e.next=9;break}throw u;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}();return function(){var e=(0,r.Z)(s().mark((function e(t,r,o){var i,a,c,d,y,h,v,b,g,E,O,j,I,S,P,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(null==r?void 0:r.selectedRuleRefIds)||[],a=3+i.length,c=0,d=function(){o&&o(++c/a)},e.next=6,n(t,null==r?void 0:r.businessObjective);case 6:if(y=e.sent,d(),h={name:r.name,description:r.description,complianceThreshold:parseFloat(r.complianceThreshold)},y&&(h.businessObjectiveId=y),null!==t){e.next=25;break}return h.cloneFromProfileId=r.cloneFromProfileId,h.refId=r.refId,h.benchmarkId=r.benchmarkId,e.next=16,p({variables:{input:h}});case 16:if(v=e.sent,b=v.data.createProfile.profile.id,!(g=v.error)){e.next=21;break}throw g;case 21:d(),t={id:b},e.next=33;break;case 25:return h.id=t.id,e.next=28,u({variables:{input:h}});case 28:if(E=e.sent,!(O=E.error)){e.next=32;break}throw O;case 32:d();case 33:return e.next=35,f(t,r.hosts);case 35:j=e.sent,I=j.policy.profiles,d(),S=l(i),e.prev=39,S.s();case 41:if((P=S.n()).done){e.next=48;break}return w=P.value,e.next=45,m(w,I);case 45:d();case 46:e.next=41;break;case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(39),S.e(e.t0);case 53:return e.prev=53,S.f(),e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[39,50,53,56]])})));return function(t,n,r){return e.apply(this,arguments)}}()}},83324:(e,t,n)=>{"use strict";n.d(t,{n1:()=>_,ZP:()=>J});var r=n(22122),o=n(81253),i=n(6610),s=n(5991),a=n(63349),c=n(10379),l=n(46070),u=n(77608),d=n(96156),p=n(85061),f=n(32465),m=n(35937),y=n.n(m),h=n(92950),v=n.n(h),b=n(45697),g=n.n(b),E=n(92310),O=n(557),j=n(44119),I=n.n(j),S=n(75959),P=n(22642),w=n(67336),T=n(34171),V=n(22789),Z=n(82176),R=n(16703),k=n(99030),C=n(99373),x=n(66543),M=n(32413),F=n(33739),D=function(e){var t=e.supported,n=e.ssgVersion;return n||(n="Not available"),t?n:v().createElement(T.cT,{messageVariant:"singular"},n)};D.propTypes={supported:g().bool,ssgVersion:g().string};const _={SSGVersion:D};var L,A,N;function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=I()(L||(L=(0,f.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),B=I()(A||(A=(0,f.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),K=function(e){return y()(e.initialDefaultState(),(function(e){return!!e}))},H={page:1},G=function(e,t){return[].concat((0,p.Z)((0,C.RM)(e)),(0,p.Z)(t?(0,C.iz)(e):[]))},z=(0,w.ZP)()(N=function(e){(0,c.Z)(m,e);var t,n,f=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,u.Z)(t);if(n){var o=(0,u.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,l.Z)(this,e)});function m(){var e;(0,i.Z)(this,m);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=f.call.apply(f,[this].concat(n)),(0,d.Z)((0,a.Z)(e),"inventory",v().createRef()),(0,d.Z)((0,a.Z)(e),"filterConfig",new R.CN([].concat((0,p.Z)(C.qo),(0,p.Z)(e.props.compliantFilter?C.rN:[]),(0,p.Z)(e.props.policies&&e.props.policies.length>0?G(e.props.policies,e.props.showOsFilter):[])))),(0,d.Z)((0,a.Z)(e),"chipBuilder",e.filterConfig.getChipBuilder()),(0,d.Z)((0,a.Z)(e),"filterBuilder",e.filterConfig.getFilterBuilder()),(0,d.Z)((0,a.Z)(e),"state",$($({},H),{},{policyId:e.props.policyId,perPage:50,totalCount:0,activeFilters:K(e.filterConfig)})),(0,d.Z)((0,a.Z)(e),"componentDidMount",(function(){var t=e.props,n=t.clearAll,r=t.selectedEntities;r&&r.length>0&&n(),(e.props.preselectedSystems?Promise.resolve(e.props.selectEntities(e.props.preselectedSystems)):Promise.resolve()).then((function(){e.updateSystems()}))})),(0,d.Z)((0,a.Z)(e),"componentDidUpdate",(function(t){t.complianceThreshold!==e.props.complianceThreshold&&e.updateSystems()})),(0,d.Z)((0,a.Z)(e),"onRefresh",(function(t){var n=t.page,r=t.per_page,i=(0,o.Z)(t,["page","per_page"]);e.props.showAllSystems&&e.inventory&&e.inventory.current?e.setState({page:n,perPage:r},(function(){e.inventory.current.onRefreshData($($({page:n,perPage:r},i),{},{per_page:r}))})):e.setState({page:n,perPage:r},(function(){return e.updateSystems().then((function(){e.inventory&&e.inventory.current&&e.inventory.current.onRefreshData($($({page:n,perPage:r},i),{},{per_page:r}))}))}))})),(0,d.Z)((0,a.Z)(e),"fetchSystems",(function(){var t=e.props,n=t.defaultFilter,r=t.client,o=t.showOnlySystemsWithTestResults,i=t.remediationsEnabled,s=e.state,a=s.policyId,c=s.perPage,l=s.page,u=s.activeFilters,d={filter:[n,o&&"has_test_results = true",e.filterBuilder.buildFilterString(u)].filter((function(e){return!!e})).join(" and "),perPage:c,page:l,policyId:a};return r.query({query:i?q:B,fetchResults:!0,fetchPolicy:"no-cache",variables:d})})),(0,d.Z)((0,a.Z)(e),"updateSystems",(function(){var t=e.props.systems.map((function(e){return e.node.id})).sort();return e.fetchSystems().then((function(t){return e.props.updateSystems({systems:t.data.systems.edges,systemsCount:t.data.systems.totalCount})})).then((function(){var n=e.props.systems.map((function(e){return e.node.id})).sort();JSON.stringify(n)===JSON.stringify(t)&&e.props.updateRows()})).catch((function(t){e.setState((function(e){return $($({},e),{},{error:t})}))}))})),(0,d.Z)((0,a.Z)(e),"onExportSelect",(function(t,n){return e.props.exportFromState(n)})),(0,d.Z)((0,a.Z)(e),"onFilterUpdate",(function(t,n){e.props.updateSystems({systems:[],systemsCount:0}),e.setState($($({},H),{},{activeFilters:$($({},e.state.activeFilters),{},(0,d.Z)({},t,n))}),e.updateSystems)})),(0,d.Z)((0,a.Z)(e),"deleteFilter",(function(t){var n=e.filterConfig.removeFilterWithChip(t,e.state.activeFilters);e.setState($($({},H),{},{activeFilters:n}),e.updateSystems)})),(0,d.Z)((0,a.Z)(e),"clearAllFilter",(function(){e.setState($($({},H),{},{activeFilters:K(e.filterConfig)}),e.updateSystems)})),(0,d.Z)((0,a.Z)(e),"onFilterDelete",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?e.clearAllFilter():e.deleteFilter(n[0])})),(0,d.Z)((0,a.Z)(e),"onBulkSelect",(function(){var t=e.props,n=t.selectedEntities,r=t.selectAll,o=t.clearSelection,i=t.allSelectedOnPage;0===n.length||n.length>0&&!i?r():o()})),(0,d.Z)((0,a.Z)(e),"isExportDisabled",(function(){var t=e.props,n=t.total,r=t.selectedEntities;return 0===(n||0)&&0===r.length})),e}return(0,s.Z)(m,[{key:"render",value:function(){var e,t=this,n=this.props,o=n.remediationsEnabled,i=n.compact,s=n.enableExport,a=n.showAllSystems,c=n.showActions,l=n.showComplianceSystemsInfo,u=n.selectedEntities,d=n.selectedEntitiesIds,p=n.systems,f=n.total,m=n.policyId,y=n.systemProps,h=n.columns,b=this.state,g=b.page,E=b.perPage,O=b.activeFilters,j=b.error,I=this.filterConfig.buildConfiguration(this.onFilterUpdate,O,{hideLabel:!0}),w=this.chipBuilder.chipsFor(this.state.activeFilters),V=s?{isDisabled:this.isExportDisabled(),onSelect:this.onExportSelect}:{},R=$($({},y),{},{onRefresh:this.onRefresh,ref:this.inventory,page:g,perPage:E,exportConfig:V,tableProps:{canSelectAll:!1},bulkSelect:{checked:u.length>0&&(!!this.props.allSelectedOnPage||null),onSelect:this.onBulkSelect,count:u.length,label:u.length>0?"".concat(u.length," Selected"):void 0}});return c&&(R.actions=[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]),a||(R.total=f,R.items=p.map((function(e){return e.node.id})),R.filterConfig=I,R.activeFiltersConfig={filters:w,onDelete:this.onFilterDelete}),i&&(R.variant=x.TableVariant.compact),void 0===j&&(e=!0),m&&0===f&&0===Object.keys(O).length&&(R.tableProps.rows=[{cells:[{title:v().createElement(T.zT,null)}]}],R.tableProps.columns=[],R.hasItems=!1,R.hasCheckbox=!1),!a&&o&&(R.dedicatedAction=v().createElement(P.Z,{allSystems:(0,Z.qN)(p.filter((function(e){return d.includes(e.node.id)})).map((function(e){return e.node}))),selectedRules:[]})),v().createElement(T.Se,{stateValues:{error:j,noError:e}},v().createElement(T.K7,{stateKey:"error"},v().createElement(T.mf,{error:j})),v().createElement(T.K7,{stateKey:"noError"},l&&v().createElement(M.Alert,{isInline:!0,variant:"info",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems previously or currently associated with compliance policies are displayed."}),v().createElement(F.Z,(0,r.Z)({},R,{fallback:v().createElement(S.Z,{colSize:2,rowSize:15}),onLoad:function(e){var n=e.INVENTORY_ACTION_TYPES,r=e.mergeWithEntities;t.getRegistry().register($({},r((0,k.zw)(n,h,a))))}}))))}}]),m}(v().Component))||N;z.propTypes={allSelectedOnPage:g().bool,clearAll:g().func,clearInventoryFilter:g().func,clearSelection:g().func,client:g().object,columns:g().array,compact:g().bool,complianceThreshold:g().number,compliantFilter:g().bool,enableExport:g().bool,error:g().object,exportFromState:g().func,policies:g().array,policyId:g().string,defaultFilter:g().string,preselectedSystems:g().array,remediationsEnabled:g().bool,selectAll:g().func,selectEntities:g().func,selectedEntities:g().array,selectedEntitiesIds:g().array,showActions:g().bool,showAllSystems:g().bool,showOnlySystemsWithTestResults:g().bool,showOsFilter:g().bool,systems:g().array,total:g().number,updateRows:g().func,updateSystems:g().func,systemProps:g().shape({isFullView:g().bool}),showComplianceSystemsInfo:g().bool},z.defaultProps={remediationsEnabled:!0,compact:!1,enableExport:!0,showAllSystems:!1,complianceThreshold:0,showOnlySystemsWithTestResults:!1,showActions:!0,compliantFilter:!1,selectedEntities:[],selectedEntitiesIds:[],systems:[],clearAll:function(){return{}},exportFromState:function(){return{}},systemProps:{},showComplianceSystemsInfo:!1};var W=(0,h.memo)((function(e){return v().createElement(z,e)})),Y=(0,E.CG)(W);const J=(0,O.connect)((function(e){return void 0===e.entities||void 0===e.entities.rows?{selectedEntities:[],systems:[]}:{allSelectedOnPage:0===e.entities.rows.filter((function(t){return!(e.entities.selectedEntities||[]).map((function(e){return e.id})).includes(t.id)})).length,selectedEntities:e.entities.selectedEntities,selectedEntitiesIds:(e.entities.selectedEntities||[]).map((function(e){return e.id})),systems:e.entities.systems,total:e.entities.total}}),(function(e){return{clearInventoryFilter:function(){return e({type:"CLEAR_FILTERS"})},exportFromState:function(t){return e((0,V.k6)(t))},updateSystems:function(t){e($({type:"UPDATE_SYSTEMS"},t))},updateRows:function(){return e({type:"UPDATE_ROWS"})},selectAll:function(){return e((0,V.td)())},clearSelection:function(){return e((0,V.MO)())},clearAll:function(){return e({type:V.pr,payload:{clearAll:!0}})},selectEntities:function(t){return e({type:"SELECT_ENTITIES",payload:{ids:t}})}}}))(Y)},27803:(e,t,n)=>{"use strict";n.d(t,{Ep:()=>u,Y0:()=>d,UD:()=>p,F4:()=>f});var r,o,i=n(85061),s=n(32465),a=n(44119),c=n.n(a),l=(n(35937),n(99373)),u=c()(r||(r=(0,s.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    majorOsVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),d=c()(o||(o=(0,s.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),p=function(e,t){return[].concat((0,i.Z)((0,l.RM)(e)),(0,i.Z)(t?(0,l.iz)(e):[]))},f=function(){return l.n3.apply(void 0,arguments)}},58820:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>E,e_:()=>H,r0:()=>O.ZP}),n(44434);var r,o=n(96156),i=n(6610),s=n(5991),a=n(10379),c=n(46070),l=n(77608),u=n(92950),d=n.n(u),p=n(45697),f=n.n(p),m=n(56455),y=n(67336),h=n(38775),v=n(6363);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=(0,y.gu)()(r=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,s.Z)(u,[{key:"render",value:function(){var e=this;return d().createElement(h.Z,{onLoad:function(t){var n=t.mergeWithDetail;return e.getRegistry().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n()))}},d().createElement(v.Z,{fallback:d().createElement(m.Z,{size:m.i.md}),hideBack:!0}))}}]),u}(d().Component))||r;g.propTypes={entity:f().object};const E=function(e){return d().createElement(g,e)};var O=n(83324),j=(n(54394),n(57481),n(45613),n(89671),n(22122)),I=n(85061),S=n(28481),P=n(92310),w=n(557),T=n(75959),V=n(27803),Z=n(99030),R=n(22789),k=n(19947),C=n(99373),x=n(23279),M=n.n(x),F=n(34171),D=n(32413),_=n(66543),L=n(22642),A=n(82176),N=n(17490),U=n(33739),$=n(73277);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t,n,r=e.columns,o=e.showAllSystems,i=e.policyId,s=e.query,a=e.client,c=e.showActions,l=e.enableExport,p=e.compliantFilter,f=e.policies,m=e.showOnlySystemsWithTestResults,h=e.showOsFilter,v=e.error,b=e.showComplianceSystemsInfo,g=e.compact,E=e.remediationsEnabled,O=e.systemProps,P=e.defaultFilter,x=e.emptyStateComponent,q=e.prependComponent,K=e.showOsMinorVersionFilter,H=(0,w.useStore)(),G=(0,w.useDispatch)(),z=(0,u.useRef)(null),W=(0,u.useState)({perPage:50,page:1}),Y=(0,S.Z)(W,2),J=Y[0],Q=Y[1],X=(0,u.useState)(!1),ee=(0,S.Z)(X,2),te=ee[0],ne=ee[1],re=(0,u.useState)(!1),oe=(0,S.Z)(re,2),ie=oe[0],se=oe[1],ae=(t=K,n=(0,$.Z)("supported_ssgs",{type:"supportedSsg",skip:!t}).data,t?(0,V.F4)(function(){var e=arguments.length>1?arguments[1]:void 0,t=function(t){return!(e.length>0)||Array(e).map(String).includes(String(t))};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,n){return t(n.osMajorVersion)&&(e[String(n.osMajorVersion)]=(0,I.Z)(new Set([].concat((0,I.Z)(e[n.osMajorVersion]||[]),[n.osMinorVersion])))),e}),[])}(null==n?void 0:n.collection,t)):[]),ce=(0,N.Z)([].concat((0,I.Z)(C.qo),(0,I.Z)(p?C.rN:[]),(0,I.Z)((null==f?void 0:f.length)>0?(0,V.UD)(f,h):[]),(0,I.Z)(ae))),le=ce.conditionalFilter,ue=ce.activeFilters,de=ce.buildFilterString,pe=(0,w.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.systemsCount}))||0,fe=(0,w.useSelector)((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.entities;return(null==n||null===(e=n.systems)||void 0===e?void 0:e.map((function(e){var t;return null==e||null===(t=e.node)||void 0===t?void 0:t.id})))||[]}),w.shallowEqual),me=(0,w.useSelector)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.entities;return(null==t?void 0:t.selectedEntities)||[]}),w.shallowEqual),ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ne(!1);var n=de(),r=[].concat((0,I.Z)(m?["has_test_results = true"]:[]),(0,I.Z)((null==n?void 0:n.length)>0?[n]:[])).join(" and "),o=P?"(".concat(P,") and (").concat(r,")"):r;return G({type:"GET_SYSTEMS_PENDING"}),a.query({query:s,fetchResults:!0,fetchPolicy:"no-cache",variables:B({filter:o,perPage:e,page:t},i&&{policyId:i})}).then((function(n){var o=n.data,i=n.loading;return G({type:"GET_SYSTEMS_FULFILLED",systems:o.systems.edges,systemsCount:o.systems.totalCount}),ne(!0),Q((function(){return{page:t,perPage:e}})),x&&!i&&0===o.systems.totalCount&&0===r.length&&se(!0),{data:o,loading:i}}))},he=(0,u.useCallback)(M()(ye,800),[le.activeFiltersConfig.filters]);return(0,u.useEffect)((function(){le.activeFiltersConfig.filters&&he(J.perPage,1)}),[ue]),d().createElement(F.Se,{stateValues:{error:v,noError:void 0===v&&!ie,empty:ie}},d().createElement(F.K7,{stateKey:"error"},!!q&&q,d().createElement(F.mf,{error:v})),d().createElement(F.K7,{stateKey:"empty"},x),d().createElement(F.K7,{stateKey:"noError"},!!q&&te&&q,b&&d().createElement(D.Alert,{isInline:!0,variant:"info",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),d().createElement(U.Z,(0,j.Z)({},O,{onLoad:function(e){var t=e.INVENTORY_ACTION_TYPES,n=e.mergeWithEntities;(0,y.JH)().register(B({},n((0,Z.Q_)(t,r,o,i))))},fallback:d().createElement(T.Z,{colSize:2,rowSize:15}),tableProps:{canSelectAll:!1},variant:g?_.TableVariant.compact:"",ref:z,onRefresh:function(e,t){s&&ye(e.per_page,e.page),!t&&z&&z.current?z.current.onRefreshData(e):t&&t(e)},bulkSelect:{checked:me.length>0&&(!(null==fe||!fe.every((function(e){return null==me?void 0:me.find((function(t){return(null==t?void 0:t.id)===e}))})))||null),onSelect:function(e){return G(e?(0,R.td)():(0,R.MO)())},count:me.length,label:me.length>0?"".concat(me.length," Selected"):void 0}},!o&&B(B(B({},J),{},{isLoaded:te,items:fe,total:pe},le),E&&{dedicatedAction:d().createElement(L.Z,{allSystems:(0,A.qN)(me),selectedRules:[]})}),l&&{exportConfig:{isDisabled:0===pe&&0===me.length,onSelect:function(e,t){var n;return(0,k.k6)(null===(n=H.getState())||void 0===n?void 0:n.entities,t)}}},c&&{actions:[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]}))))};K.propTypes={columns:f().arrayOf(f().shape({})),policies:f().arrayOf(f().shape({})),client:f().object,showAllSystems:f().bool,policyId:f().string,query:f().string,showActions:f().bool,enableExport:f().bool,compliantFilter:f().bool,showOnlySystemsWithTestResults:f().bool,showOsFilter:f().bool,showComplianceSystemsInfo:f().bool,error:f().object,compact:f().bool,remediationsEnabled:f().bool,defaultFilter:f().string,systemProps:f().shape({isFullView:f().bool}),emptyStateComponent:f().node,prependComponent:f().node,showOsMinorVersionFilter:f().oneOfType([f().bool,f().arrayOf(f().number)])},K.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0};const H=(0,P.CG)(K)},19947:(e,t,n)=>{"use strict";n.d(t,{k6:()=>s});var r=n(90484),o=function(e,t){return t.split(".").reduce((function(e,t){return e&&"undefined"!==e[t]?e[t]:void 0}),e)},i=function(e,t){var n=o(e,t);return n.exportValue&&(n=n.exportValue),"object"===(0,r.Z)(n)&&(n=o(e,t+"_text")),"string"==typeof n&&n.includes(",")&&(n='"'+n+'"'),n},s=function(e,t){var n;"csv"===t?n=function(e){var t=e.rows,n=e.columns,r=e.selectedEntities;if(t){var o=[n.map((function(e){return e.title})).join(",")];return o=o.concat((r||t).map((function(t){return e.columns.map((function(e){return e.noExport?"":i(t,e.key)})).join(",")}))),encodeURI("data:text/csv;charset=utf-8,"+o.join("\n"))}}(e):"json"===t&&(n=function(e){var t,n=e.rows,r=e.columns,o=e.selectedEntities;if(n)return t=(o||n).map((function(e){var t={};return r.forEach((function(n){var r=n.key.split("."),o=r[r.length-1];t[o]=i(e,n.key)})),t})),encodeURI("data:application/json;charset=utf-8,"+JSON.stringify(t))}(e)),function(e,t){if(e){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}(n,function(e){return"compliance-export-"+(new Date).toISOString()+"."+e}(t))}},73277:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var r=n(85061),o=n(92137),i=n(28481),s=n(96156),a=n(87757),c=n.n(a),l=n(92950),u=n(99373),d=n(41800),p=n.n(d),f=n(6610),m=n(5991);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,f.Z)(this,e),(0,s.Z)(this,"DEFAULT_API_HEADERS",{"Content-Type":"application/vnd.api+json",Accept:"application/json"}),this.apiBase=t.apiBase||"/api",this.path=t.path||"",this.authenticate=t.authenticate||function(){return Promise.resolve({})},this.onUnauthorised=t.onUnauthorised||function(){return Promise.resolve({})},this.defaultHeaders=t.headers||this.DEFAULT_API_HEADERS}var t;return(0,m.Z)(e,[{key:"request",value:(t=(0,o.Z)(c().mark((function e(t,n,r){var o,i=this,s=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:{},e.next=3,this.callAuthenticate().then((function(){return i.fetch(t,n,r,o)})).then(this.checkForEmptyResponse).then((function(e){return i.checkForErrors(e,o)})).then((function(e){return e.json()})).catch(this.finalCatch);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"finalCatch",value:function(e){return void 0===e.errors?Promise.reject({title:"Error parsing"}):Promise.reject(h({},e))}},{key:"fetch",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o={method:n||"get",headers:this.defaultHeaders,credentials:"include"},i="".concat(this.apiBase).concat(this.path?this.path:"").concat(e||""),s=new URL(i,window.location.origin);if(r.params){var a=Object.keys(r.params).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r.params[e])})).join("&");s.search=new URLSearchParams(a)}return t&&(o.body=JSON.stringify(t)),fetch(s,o)}))},{key:"checkForEmptyResponse",value:function(e){return 204===e.status?{json:function(){return{}}}:e}},{key:"checkForErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(404===e.status&&t.ignore404)return{json:function(){return{}}};if(401===e.status)return this.onUnauthorised();var n=e.clone?e.clone().json():e;return 422===e.status?n.then((function(e){return Promise.reject(h(h({},e),{},{title:"Validation error"}))})):e.status>=400&&e.status<=600?n.then((function(e){return Promise.reject(e.errors[0])})):e}},{key:"callAuthenticate",value:function(){return Promise.resolve(this.authenticate()||!0)}},{key:"create",value:function(e,t){return this.request(e,t,"post")}},{key:"update",value:function(e,t){return this.request(e,t,"put")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,null,"get",t)}},{key:"destroy",value:function(e){return this.request(e,null,"delete")}}]),e}();function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const g=function(e){return new v(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){return e&&function(e,t){var n=e[t],r=e;return delete r[t],O(O({},r),n)}(e,"attributes")},I=function(e,t){var n,r=p()(e);return null===(n=Object.values(r[t]||{}))||void 0===n?void 0:n.map((function(e){return function(e,t){var n={};return Object.entries((null==e?void 0:e.relationships)||[]).forEach((function(e){var r=(0,i.Z)(e,2),o=r[0],s=r[1];n[o]=null==s?void 0:s.data.map((function(e){var n;return j(null==t||null===(n=t[e.type])||void 0===n?void 0:n[e.id])})).filter((function(e){return!!e}))})),delete e.relationships,O(O({},e),n)}(j(e),r)}))},S=function(){var e=(0,o.Z)(c().mark((function e(t,n){var r,o,i,s,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},o=a.length>3&&void 0!==a[3]?a[3]:{},e.next=4,t.get("/".concat(n),{params:r});case 4:return i=e.sent,e.next=7,I(i,(null==o?void 0:o.type)||n);case 7:return s=e.sent,e.abrupt("return",{collection:s,meta:i.meta,total:i.meta.total,json:i});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();const P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=(0,l.useState)({data:void 0,loading:!1,error:void 0}),s=(0,i.Z)(o,2),a=s[0],c=s[1],d=g({apiBase:u.dT}),p=O(O({},(null==t?void 0:t.params)||{}),{},{include:(null==t?void 0:t.include)||[]});return(0,l.useEffect)((function(){null!=t&&t.skip||(c({data:void 0,loading:!0,error:void 0}),S(d,e,p,t).then((function(e){c({data:e,loading:!1,error:void 0})})))}),[].concat((0,r.Z)(n),[null==t?void 0:t.skip])),a}},82176:(e,t,n)=>{"use strict";n.d(t,{T4:()=>s,TU:()=>a,qN:()=>l});var r=n(96156);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},a=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},c=function(e){return e.testResultProfiles?s(e.testResultProfiles):[]},l=function(e){return e.map((function(e){return i(i({},e),{},{ruleObjectsFailed:c(e),profiles:e.testResultProfiles})}))}},22789:(e,t,n)=>{"use strict";n.d(t,{xM:()=>r,pr:()=>o,k6:()=>i,td:()=>s,MO:()=>a});var r="@@COMPLIANCE/EXPORT",o="SELECT_ENTITY",i=function(e){return{type:r,payload:{format:e}}},s=function(){return{type:o,payload:{id:0,selected:!0}}},a=function(){return{type:o,payload:{id:0,selected:!1}}}},99030:(e,t,n)=>{"use strict";n.d(t,{ek:()=>S,rI:()=>P,B3:()=>V,UP:()=>k,Nw:()=>C,Q_:()=>U,zw:()=>$});var r=n(96156),o=n(92950),i=n.n(o),s=n(18546),a=n(62410),c=n(334),l=n(22789),u=n(19947),d=n(34171),p=n(32413),f=n(82176),m=n(50500),y=n(79886);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b="Never",g=function(e){var t=e.testResultProfiles,n=(void 0===t?[]:t).map((function(e){return new Date(e.lastScanned)})),r=new Date(Math.max.apply(null,n.filter((function(e){return isFinite(e)}))));return r instanceof Date&&isFinite(r)?r:b},E=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).every((function(e){return e.lastScanned===b||!0===e.compliant}))},O=function(e){var t=e.testResultProfiles,n=void 0===t?[]:t,r=n.reduce((function(e,t){return e+t.score}),0),o=n.reduce((function(e,t){return(0,f.TU)([t]).length+(0,f.T4)([t]).length>0?e+1:e}),0);return o?r/o:0},j=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).reduce((function(e,t){return e&&t.supported}),!0)},I=function(e){return e==={}?"":e.policies.map((function(e){return e.name})).join(", ")},S=function(e){var t=e.policyNames;return{title:t?i().createElement(p.Tooltip,{content:t},i().createElement(m.Z,{lines:2,width:540},t)):i().createElement(p.Text,{className:"grey-icon"},"No policies"),exportValue:t}},P=function(e){if(e.testResultProfiles&&e.testResultProfiles.length>0)return{title:i().createElement(c.Link,{to:{pathname:"/systems/".concat(e.id)}},"View report")}},w=function(e){return void 0!==e.osMajorVersion&&void 0!==e.osMinorVersion&&null!==e.osMajorVersion&&null!==e.osMinorVersion&&!(0===e.osMajorVersion&&0===e.osMinorVersion)},T=function(e,t){return{title:i().createElement(p.TextContent,null,t.name?i().createElement(c.Link,{to:{pathname:"/systems/".concat(t.id)}},t.name):e.display_name,w(t)&&i().createElement(p.Text,{component:p.TextVariants.small},"RHEL ",t.osMajorVersion,".",t.osMinorVersion)),exportValue:e.display_name||t.name}},V=function(e,t,n){var r=n.osMajorVersion,o=n.osMinorVersion,s=n.name;return i().createElement(p.TextContent,null,i().createElement(c.Link,{to:{pathname:"/systems/".concat(t)}},e||s),w({osMajorVersion:r,osMinorVersion:o})&&i().createElement(p.Text,{component:p.TextVariants.small},"RHEL ",r,".",o))},Z=function(e,t){return!!(t||[]).find((function(t){return t.id===e}))},R=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).map((function(e){return e.ssgVersion})).filter((function(e){return!!e})).join(", ")},k=function(e){return e?e.reduce((function(e,t){var n=t.osMinorVersion;return null!=n&&(e[n]=e[n]||{osMinorVersion:n,count:0}).count++,e}),{}):{}},C=function(e){return Object.values(k(e)).sort((0,y.S)("osMinorVersion","desc"))},x=function(e,t,n,r){return t.map((function(t){void 0===t.facts&&(t.facts={});var o=e.map((function(e){return e.node})).find((function(e){return t.id===e.id}));if(void 0===o){if(!n)return;o={testResultProfiles:[],policies:[]}}return o.policyNames=I(o),o.rulesPassed=(0,f.TU)(o.testResultProfiles).length,o.rulesFailed=(0,f.T4)(o.testResultProfiles).length,o.lastScanned=g(o),o.compliant=E(o),o.score=O(o),o.supported=j(o),{id:t.id,selected:Z(t.id,r),account:t.account,bios_uuid:t.bios_uuid,created:t.created,display_name:t.display_name||o.name,fqdn:t.fqdn,insights_id:t.insights_id,ip_addresses:t.ip_addresses,mac_addresses:t.mac_addresses,rhel_machine_id:t.rhel_machine_id,satellite_id:t.satellite_id,subscription_manager_id:t.subscription_manager_id,tags:t.tags,updated:t.updated,facts:{inventory:{hostname:void 0!==t.facts.inventory?t.facts.inventory.hostname:t.facts.hostname,machine_id:void 0!==t.facts.inventory?t.facts.inventory.machine_id:t.facts.machine_id,release:void 0!==t.facts.inventory?t.facts.inventory.release:t.facts.release},compliance:{display_name:T(t,o),policies:S(o),details_link:P(o),rules_passed:o.rulesPassed,rules_failed:{title:i().createElement(c.Link,{to:{pathname:"/systems/".concat(o.id),query:{hidePassed:!0}}},o.rulesFailed)},rules_failed_text:o.rulesFailed,compliance_score:(0,d.OF)(o),compliance_score_text:(0,d.Oq)(o),last_scanned:o.lastScanned instanceof Date?{title:i().createElement(a.Z,{date:Date.parse(o.lastScanned),type:"relative"})}:o.lastScanned,last_scanned_text:o.lastScanned,ssg_version:R(o),supported:o.supported}}}})).filter((function(e){return!!e}))},M=function(e){return e.map((function(e){var t=e.node;return v(v({},t),{},{policyNames:I({policies:null==t?void 0:t.policies,testResultProfiles:[]}),rulesPassed:(0,f.TU)(t.testResultProfiles).length,rulesFailed:(0,f.T4)(t.testResultProfiles).length,lastScanned:g(t),compliant:E(t),display_name:t.name,score:O(t),supported:j(t),ssgVersion:R(t),detailsLink:P(t)})}))},F=function(e,t){var n=e.rows.filter((function(n){return t.includes(n.id)&&!(e.selectedEntities||[]).map((function(e){return e.id})).includes(n.id)}));return v(v({},e),{},{selectedEntities:(e.selectedEntities||[]).concat(n)})},D=function(e,t){return v(v({},e),{},{selectedEntities:(e.selectedEntities||[]).filter((function(e){return!t.includes(e.id)}))})},_=function(e){return F(e,e.rows.map((function(e){return e.id})))},L=function(e){return D(e,e.rows.map((function(e){return e.id})))},A=function(e,t){return F(e,[t])},N=function(e,t){return D(e,[t])},U=function(e,t){var n;return(0,s.Gg)((n={},(0,r.Z)(n,"GET_SYSTEMS_PENDING",(function(e){return v(v({},e),{},{rows:[],systems:void 0,systemsCount:void 0,columns:t,loaded:!1})})),(0,r.Z)(n,"GET_SYSTEMS_FULFILLED",(function(e,n){var r=n.systems,o=n.systemsCount;return v(v({},e),{},{systems:r,systemsCount:o,total:o,rows:M(r).map((function(t){return v(v({},t),{},{selected:Z(t.id,e.selectedEntities)})})),columns:t,loaded:!0})})),(0,r.Z)(n,e.LOAD_ENTITIES_PENDING,(function(e){return v(v({},e),{},{total:e.systemsCount,rows:void 0!==e.systems?M(e.systems).map((function(t){return v(v({},t),{},{selected:Z(t.id,e.selectedEntities)})})):[],columns:t,loaded:void 0!==e.systemsCount})})),(0,r.Z)(n,e.LOAD_ENTITIES_FULFILLED,(function(e){return v(v({},e),{},{total:e.systemsCount,rows:void 0!==e.systems?M(e.systems).map((function(t){return v(v({},t),{},{selected:Z(t.id,e.selectedEntities)})})):[],columns:t,loaded:void 0!==e.systemsCount})})),(0,r.Z)(n,l.pr,(function(e,t){var n,r=t.payload,o=r.id,i=r.selected,s=r.clearAll;return(0===(n=0===o?i?_(e):L(e):i?A(e,o):N(e,o)).selectedEntities.length||s)&&(n.selectedEntities=void 0),n})),(0,r.Z)(n,"SELECT_ENTITIES",(function(e,t){return{selectedEntities:t.payload.ids}})),n))},$=function(e,t,n){var o;return(0,s.Gg)((o={},(0,r.Z)(o,"UPDATE_SYSTEMS",(function(e,t){var n=t.systems,r=t.systemsCount;return v(v({},e),{},{systems:n,systemsCount:r})})),(0,r.Z)(o,"UPDATE_ROWS",(function(e){return v(v({},e),{},{loaded:!0,rows:x(e.systems||[],e.rows||[],n,e.selectedEntities)})})),(0,r.Z)(o,e.LOAD_ENTITIES_FULFILLED,(function(e){return v(v({},e),{},{rows:x(e.systems||[],e.rows,n,e.selectedEntities),total:n?e.total:e.systemsCount,columns:e.total>0?t:[{title:""}]})})),(0,r.Z)(o,l.xM,(function(e,t){var n=t.payload.format;return(0,u.k6)(e,n),e})),(0,r.Z)(o,l.pr,(function(e,t){var n,r=t.payload,o=r.id,i=r.selected,s=r.clearAll;return(0===(n=0===o?i?_(e):L(e):i?A(e,o):N(e,o)).selectedEntities.length||s)&&(n.selectedEntities=void 0),n})),(0,r.Z)(o,"SELECT_ENTITIES",(function(e,t){return{selectedEntities:t.payload.ids}})),o))}}}]);
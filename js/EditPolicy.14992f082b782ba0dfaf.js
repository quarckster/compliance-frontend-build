(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[402],{82813:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComplianceSystems:()=>P,default:()=>w});var r,o=n(59713),i=n.n(o),s=n(28655),a=n.n(s),c=n(77865),l=n.n(c),u=n(61084),d=n(44119),p=n.n(d),f=n(46829),m=n(48716),y=n(39173),h=n(86350),v=n(5705),b=n(93188),g=n(55186),E=n(49690),O=n(42564);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=p()(r||(r=a()(['\n{\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                name\n                refId\n                majorOsVersion\n            }\n        }\n    }\n}\n']))),P=function(){var e,t=(0,O.ZP)("newInventory"),n=(0,f.useQuery)(S),r=n.data,o=n.error,i=n.loading,s=(0,u.useDispatch)(),a=[I({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},t&&{key:"display_name",renderFunc:E.B3}),I({key:"facts.compliance.policies",title:"Policies",props:{width:40,isStatic:!0}},t&&{key:"policyNames",renderFunc:function(e){return((0,E.ek)({policyNames:e})||{title:""}).title}}),I({key:"facts.compliance.details_link",title:"",props:{width:20,isStatic:!0}},t&&{key:"testResultProfiles",renderFunc:function(e,t){return((0,E.rI)({testResultProfiles:e,id:t})||{title:""}).title}})],d=null==r||null===(e=r.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));(0,c.useLayoutEffect)((function(){s({type:"SELECT_ENTITIES",payload:{ids:[]}})}),[]);var p=t?b.e_:b.r0;return l().createElement(l().Fragment,null,l().createElement(m.Z,{className:"page-header"},l().createElement(y.Z,{title:"Systems"})),l().createElement(h.Z,null,l().createElement(v.tC,{stateValues:{error:o,data:r,loading:i}},l().createElement(v.K7,{stateKey:"data"},d&&l().createElement(p,{query:g.Ep,defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsFilter:!0,showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,columns:a,policies:d})))))};const w=P},37489:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreatePolicy:()=>je,default:()=>Se});var r,o=n(59713),i=n.n(o),s=n(63038),a=n.n(s),c=n(77865),l=n.n(c),u=n(334),d=n(33766),p=n(61084),f=n(45697),m=n.n(f),y=n(4092),h=n(28655),v=n.n(h),b=n(5705),g=n(44119),E=n.n(g),O=n(46829),j=n(6023),I=n(15113),S=n(46314),P=n(35592);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=E()(r||(r=v()(['\nquery benchmarksAndProfiles {\n    latestBenchmarks {\n        id\n        title\n        refId\n        version\n        osMajorVersion\n        profiles {\n            id\n            name\n            refId\n            description\n            complianceThreshold\n        }\n    }\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                refId\n                benchmark {\n                    refId\n                }\n            }\n        }\n    }\n}\n']))),R=function(e){var t=e.change,n=e.selectedBenchmarkId,r=(0,O.useQuery)(V,{fetchPolicy:"no-cache"}),o=r.data,i=r.error,s=r.loading,a=(0,p.useDispatch)();if(i)return i;if(s)return l().createElement(j.Z,null);var c,u,d,f,m=o.latestBenchmarks;if(n){c=m.find((function(e){return e.id===n}));var h=(d=o.profiles.edges,f=c,d.filter((function(e){return f.refId===e.node.benchmark.refId})).map((function(e){return e.node.refId})));u=c.profiles.map((function(e){return T(T({},e),{},{disabled:h.includes(e.refId)})}))}return l().createElement(l().Fragment,null,l().createElement(y.TextContent,null,l().createElement(y.Text,{component:y.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),l().createElement(y.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),l().createElement(y.Form,null,l().createElement(y.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},m&&m.sort((function(e,t){return e.refId.localeCompare(t.refId)})).map((function(e){var r=e.id,o=e.osMajorVersion;return l().createElement(y.Button,{key:r,onClick:function(){return function(e){var n,r=e.id,o=e.osMajorVersion;(null===(n=c)||void 0===n?void 0:n.osMajorVersion)!==o&&(t("systems",[]),a({type:"SELECT_ENTITIES",payload:{ids:[]}})),t("benchmark",r),t("osMajorVersion",o)}(e)},className:"wizard-os-button ".concat(n===r?"active-wizard-os-button":""),variant:"tertiary"},"RHEL ".concat(o))}))),l().createElement(y.FormGroup,{label:"Policy type",isRequired:!0,fieldId:"policy-type"},l().createElement(b.yL,{profiles:c&&u,onClick:function(){t("selectedRuleRefIds",null)}}))))};R.propTypes={selectedBenchmarkId:m().string,change:I.ZP.change};var k=(0,d.Z)("policyForm");const x=(0,P.compose)((0,p.connect)((function(e){return{selectedBenchmarkId:k(e,"benchmark")}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(R);var C,M=n(2707),F=n(92223),D=n(42564),_=n(92515);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=E()(C||(C=v()(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),Z=function(e){var t=e.policy,n=e.selectedRuleRefIds,r=e.change,o=e.osMajorVersion,i=e.osMinorVersionCounts,s=(0,M.eo)(["Name","Severity","Ansible"]),a=(0,_.Z)("benchmarks",{type:"benchmark",include:["profiles"],params:{search:"os_major_version = ".concat(o," ")+"and latest_supported_os_minor_version ^ (".concat(i.map((function(e){return e.osMinorVersion})).join(","),")")}}),u=a.data,d=a.loading,p=[],f=i.map((function(e){var r,o,i,s=e.osMinorVersion,a=e.count;if(s="".concat(s),u){var c,l,d,f,m=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(u.collection,s);m&&(o=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(m,t.refId))&&(o=L(L({},o),{},{rules:null===(c=o.relationships)||void 0===c||null===(l=c.rules)||void 0===l?void 0:l.data,benchmark:null===(d=o.relationships)||void 0===d||null===(f=d.benchmark)||void 0===f?void 0:f.data}),i=null==n?void 0:n.find((function(e){return e.id===o.id})),p.push(o.id))}return{profile:o,systemCount:a,newOsMinorVersion:s,selectedRuleRefIds:null===(r=i)||void 0===r?void 0:r.ruleRefIds}}));f=f.filter((function(e){return!!e.profile}));var m="".concat((p||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),h=(0,O.useQuery)(N,{variables:{filter:m},skip:0===m.length}),v=h.data,g=h.error,E=h.loading,I=(null==p?void 0:p.length)>0?v:void 0,S=!(!E&&!d)||void 0;return(0,c.useLayoutEffect)((function(){if(v){var e=null==v?void 0:v.profiles.edges.map((function(e){return e.node}));r("selectedRuleRefIds",e.map((function(e){var t;return{id:e.id,ruleRefIds:(null==n||null===(t=n.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.ruleRefIds)||e.rules.map((function(e){return e.refId}))}})))}}),[v]),l().createElement(l().Fragment,null,l().createElement(y.TextContent,{className:"pf-u-pb-md"},l().createElement(y.Text,{component:y.TextVariants.h1},"Rules"),l().createElement(y.Text,null,"Customize your ",l().createElement("b",null,t.name)," SCAP policy by including and excluding rules."),l().createElement(y.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),l().createElement(b.tC,{stateValues:{error:g,data:I,loading:S}},l().createElement(b.K7,{stateKey:"loading"},l().createElement(F.Z,null,l().createElement(j.Z,null))),l().createElement(b.K7,{stateKey:"data"},l().createElement(b.Hv,{tabsData:f,columns:s,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:function(e,t){var o=n.map((function(n){return n.id===e.id?{id:n.id,ruleRefIds:t}:n}));r("selectedRuleRefIds",o)}}))))};Z.propTypes={policy:m().object,change:I.ZP.change,osMajorVersion:m().string,osMinorVersionCounts:m().arrayOf(m().shape({osMinorVersion:m().number,count:m().number})),selectedRuleRefIds:m().array};var U=(0,d.Z)("policyForm");const $=(0,P.compose)((0,p.connect)((function(e){return{policy:JSON.parse(U(e,"profile")),osMajorVersion:U(e,"osMajorVersion"),osMinorVersionCounts:U(e,"osMinorVersionCounts"),selectedRuleRefIds:U(e,"selectedRuleRefIds")}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(Z);var q,B=E()(q||(q=v()(["\nquery benchmarkAndProfile($benchmarkId: String!, $profileId: String!){\n    benchmark(id: $benchmarkId) {\n        id\n        rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n    profile(id: $profileId) {\n        id\n        name\n        refId\n        rules {\n            id\n            refId\n        }\n    }\n}\n"]))),H=function(e){var t,n,r=e.profileId,o=e.benchmarkId,i=e.osMajorVersion,s=e.osMinorVersionCounts,u=e.selectedRuleRefIds,d=e.change,p=(0,D.ZP)("multiversionTabs"),f=(0,M.eo)(["Name","Severity","Ansible"]),m=(0,O.useQuery)(B,{variables:{profileId:r,benchmarkId:o}}),h=m.data,v=m.error,g=m.loading,E=(0,c.useState)(null),I=a()(E,2),S=I[0],P=I[1],w=h&&[{profile:{refId:h.profile.refId,name:h.profile.name},rules:h.benchmark.rules}];return(0,c.useEffect)((function(){if(h){var e=h.profile.rules.map((function(e){return e.refId}));P(e),u||d("selectedRuleRefIds",e)}}),[h,d,u]),l().createElement(b.tC,{stateValues:{error:v,data:h,loading:g}},l().createElement(b.K7,{stateKey:"loading"},l().createElement(F.Z,null,l().createElement(j.Z,null))),l().createElement(b.K7,{stateKey:"data"},l().createElement(y.TextContent,null,l().createElement(y.Text,{component:y.TextVariants.h1},"Rules")),l().createElement(y.TextContent,null,l().createElement(y.Text,null,"Edit your policy by including and excluding rules."),l().createElement(y.Text,null,"Selected policy type ",l().createElement("strong",null,null==h?void 0:h.profile.name)," has ",null==S?void 0:S.length," rules.â€‚",u&&(n=null==(t=u)?void 0:t.filter((function(e){return null==S?void 0:S.includes(e)})),!(t&&S&&n.length===S.length))&&l().createElement(y.Button,{variant:"link",isInline:!0,onClick:function(){return d("selectedRuleRefIds",S)}},"Reset to default selection")),p&&s&&s.length>0&&l().createElement(y.Text,null,"Tailoring for"," ",s.map((function(e){var t=e.osMinorVersion,n=e.count;return"RHEL ".concat(i,".").concat(t," (").concat(n," systems)")})).join(", "))),l().createElement(M.ZP,{remediationsEnabled:!1,tailoringEnabled:!0,selectedFilter:!0,remediationAvailableFilter:!0,columns:f,loading:g,handleSelect:function(e){return d("selectedRuleRefIds",e)},profileRules:w,selectedRefIds:u||[]})))};H.propTypes={profileId:m().string,benchmarkId:m().string,change:I.ZP.change,osMajorVersion:m().string,osMinorVersionCounts:m().arrayOf(m().shape({osMinorVersion:m().number,count:m().number})),selectedRuleRefIds:m().array};var K=(0,d.Z)("policyForm"),G=(0,P.compose)((0,p.connect)((function(e){return{benchmarkId:K(e,"benchmark"),profile:JSON.parse(K(e,"profile")),profileId:JSON.parse(K(e,"profile")).id,osMajorVersion:K(e,"osMajorVersion"),osMinorVersionCounts:K(e,"osMinorVersionCounts"),selectedRuleRefIds:K(e,"selectedRuleRefIds")}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(H);const z=function(){for(var e=(0,D.ZP)("multiversionTabs"),t=e?$:G,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return l().createElement(t,r)};var W=n(93188),Y=n(55186),J=n(49690);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(e){var t=e.change,n=e.osMajorVersion,r=e.osMinorVersionCounts,o=e.selectedSystemIds,i=(0,D.ZP)("newInventory"),s=(0,D.ZP)("multiversionTabs"),a=[X({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},i&&{key:"display_name",renderFunc:function(e,t,n){var r=n.name;return e||r}}),X({key:"facts.compliance.osMinorVersion",title:"Operating system",props:{width:40,isStatic:!0}},i&&{key:"osMinorVersion",renderFunc:function(e,t,n){var r=n.osMajorVersion;return"RHEL ".concat(r,".").concat(e)}})];(0,c.useEffect)((function(){o&&t("systems",o),r&&t("osMinorVersionCounts",r)}),[o,r,t]);var u=l().createElement(l().Fragment,null,l().createElement(y.TextContent,{className:"pf-u-mb-md"},l().createElement(y.Text,null,"You do not have any ",l().createElement("b",null,"RHEL ",n)," systems connected to Insights and enabled for Compliance.",l().createElement("br",null),"Policies must be created with at least one system.")),l().createElement(y.TextContent,{className:"pf-u-mb-md"},l().createElement(y.Text,null,"Choose a different operating system, or connect ",l().createElement("b",null,"RHEL ",n)," systems to Insights.")),l().createElement(y.WizardContextConsumer,null,(function(e){var t=e.goToStepById;return l().createElement(y.Button,{onClick:function(){return t(1)}},"Choose a different operating system")}))),d=l().createElement(l().Fragment,null,l().createElement(y.TextContent,{className:"pf-u-mb-md"},l().createElement(y.Text,null,"Select which of your ",l().createElement("b",null,"RHEL ",n)," systems should be included in this policy.",l().createElement("br",null),"Systems can be added or removed at any time."))),p=i?W.e_:W.r0;return l().createElement(l().Fragment,null,l().createElement(y.TextContent,{className:"pf-u-mb-md"},l().createElement(y.Text,{component:y.TextVariants.h1},"Systems")),l().createElement(y.Form,null,l().createElement(y.FormGroup,null,l().createElement(p,{prependComponent:d,emptyStateComponent:s?u:void 0,columns:a,remediationsEnabled:!1,compact:!0,showActions:!1,query:Y.Y0,defaultFilter:n&&"os_major_version = ".concat(n),enableExport:!1}))))};ee.propTypes={osMajorVersion:m().string,osMinorVersionCounts:m().arrayOf(m().shape({osMinorVersion:m().number,count:m().number})),selectedSystemIds:m().array,change:I.ZP.change},ee.defaultProps={selectedSystemIds:[],osMinorVersionCounts:[]};var te=(0,d.Z)("policyForm");const ne=(0,P.compose)((0,p.connect)((function(e){var t,n;return{osMajorVersion:te(e,"osMajorVersion"),osMinorVersionCounts:(0,J.Nw)(null===(t=e.entities)||void 0===t?void 0:t.selectedEntities),selectedSystemIds:((null===(n=e.entities)||void 0===n?void 0:n.selectedEntities)||[]).map((function(e){return e.id}))}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(ee);var re=n(6455),oe=n(53426),ie=function(e){var t=e.change,n=e.policy,r=e.refId;return(0,c.useEffect)((function(){n&&n.refId!==r&&(t("name","".concat(n.name)),t("refId","".concat(n.refId)),t("description","".concat(n.description)))}),[n]),l().createElement(l().Fragment,null,l().createElement(y.TextContent,null,l().createElement(y.Text,{component:y.TextVariants.h1},"Details")),l().createElement("br",null),l().createElement(y.Form,{id:"editpolicydetails"},l().createElement(y.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},l().createElement(re.Z,{component:oe._c,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),l().createElement(y.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},l().createElement(re.Z,{type:"text",component:oe._c,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),l().createElement(y.FormGroup,{label:"Description",fieldId:"description"},l().createElement(re.Z,{type:"text",component:oe.do,id:"description",name:"description","aria-describedby":"description"})),l().createElement(y.FormGroup,{label:"Business objective",fieldId:"businessObjective"},l().createElement(re.Z,{type:"text",component:oe._c,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:n.businessObjective})),l().createElement(b._z,{showTitle:!1,previousThreshold:n.complianceThreshold})))},se=(0,d.Z)("policyForm");ie.propTypes={policy:m().object,refId:m().string,change:I.ZP.change};const ae=(0,P.compose)((0,p.connect)((function(e){var t=JSON.parse(se(e,"profile"));return{policy:t,refId:se(e,"refId"),initialValues:{name:"".concat(t.name),refId:"".concat(t.refId),description:"".concat(t.description),benchmark:se(e,"benchmark"),osMajorVersion:se(e,"osMajorVersion"),profile:se(e,"profile")}}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(ie);var ce,le=E()(ce||(ce=v()(["\nquery review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n        id\n        osMajorVersion\n    }\n}\n"]))),ue=function(e){var t=e.benchmarkId,n=e.name,r=e.businessObjective,o=e.complianceThreshold,i=e.parentProfileName,s=e.osMinorVersionCounts,a=(0,O.useQuery)(le,{variables:{benchmarkId:t}}),c=a.data,u=a.error,d=a.loading;if(u)return u;if(d)return l().createElement(j.Z,null);var p=c.benchmark.osMajorVersion;return l().createElement(y.TextContent,null,l().createElement(y.Text,{component:y.TextVariants.h1},"Review"),l().createElement(y.Text,null,"Review your SCAP policy before finishing."),l().createElement(y.Text,{component:y.TextVariants.h3},n),l().createElement(y.TextList,{component:y.TextListVariants.dl},l().createElement(y.TextListItem,{component:y.TextListItemVariants.dt},"Policy type"),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dd},i),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dt},"Compliance threshold"),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dd},o,"%"),r&&l().createElement(l().Fragment,null,l().createElement(y.TextListItem,{component:y.TextListItemVariants.dt},"Business objective"),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dd},r)),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dt},"Systems"),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dd},l().createElement(y.TextList,{component:y.TextListVariants.dl},s.map((function(e){var t=e.osMinorVersion,n=e.count;return l().createElement(l().Fragment,{key:t},l().createElement(y.TextListItem,{component:y.TextListItemVariants.dt,style:{"font-weight":"normal"}},"RHEL ",p,".",t),l().createElement(y.TextListItem,{component:y.TextListItemVariants.dd},n))}))))))};ue.propTypes={benchmarkId:m().string,refId:m().string,name:m().string,businessObjective:m().string,complianceThreshold:m().number,parentProfileName:m().string,osMinorVersionCounts:m().arrayOf(m().shape({osMinorVersion:m().number,count:m().number}))};var de=(0,d.Z)("policyForm");const pe=(0,p.connect)((function(e){return{benchmarkId:de(e,"benchmark"),refId:de(e,"refId"),name:de(e,"name"),businessObjective:de(e,"businessObjective"),osMinorVersionCounts:de(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(de(e,"complianceThreshold"))||100,parentProfileName:JSON.parse(de(e,"profile")).name,rulesCount:de(e,"selectedRuleRefIds").length}}))(ue);var fe=n(5913),me=n(98467),ye=n(38393),he=function(e){var t,n,r=e.onWizardFinish,o=e.cloneFromProfileId,i=e.description,s=e.name,u=e.complianceThreshold,d=e.businessObjective,p=e.refId,f=e.benchmarkId,m=e.systemIds,h=e.selectedRuleRefIds,v=(0,c.useState)(0),g=a()(v,2),E=g[0],O=g[1],j=(0,c.useState)("This usually takes a minute or two."),I=a()(j,2),S=I[0],P=I[1],w=(0,c.useState)(null),T=a()(w,2),V=T[0],R=T[1],k=(0,c.useState)(!1),x=a()(k,2),C=x[0],M=x[1],F=(0,ye.Z)(),D=function(e){O(100*e)};return(0,c.useEffect)((function(){var e={cloneFromProfileId:o,description:i,name:s,complianceThreshold:u,businessObjective:{title:d},refId:p,benchmarkId:f,hosts:m.map((function(e){return{id:e}})),selectedRuleRefIds:h};F(null,e,D).then((function(){O(100),P()})).catch((function(e){var t,n,r;P(null===(t=e.networkError)||void 0===t?void 0:t.message),R(null===(n=e.networkError)||void 0===n||null===(r=n.result)||void 0===r?void 0:r.errors),M(!0)}))}),[]),V&&Array.isArray(V)&&V.length>0&&(t=V.map((function(e){return l().createElement(y.ListItem,{key:e},e)}))),(100===E||C)&&(n=l().createElement(y.Button,{variant:"primary",onClick:function(){r()}},C?"Back":"Return to application")),l().createElement(y.Bullseye,null,l().createElement(y.EmptyState,{variant:y.EmptyStateVariant.full},l().createElement(y.EmptyStateIcon,{icon:fe.ZP}),l().createElement("br",null),l().createElement(y.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),l().createElement(y.EmptyStateBody,null,l().createElement(b.ko,{percent:E,failed:C})),l().createElement(y.EmptyStateBody,{className:C&&"wizard-failed-message"},S),t&&l().createElement(y.EmptyStateBody,{className:"wizard-failed-errors"},l().createElement(y.List,null,t)),l().createElement(y.EmptyStateSecondaryActions,null,n)))};he.propTypes={benchmarkId:m().string.isRequired,client:m().object.isRequired,businessObjective:m().object,cloneFromProfileId:m().string.isRequired,refId:m().string.isRequired,name:m().string.isRequired,description:m().string,systemIds:m().array,complianceThreshold:m().number,onWizardFinish:m().func,selectedRuleRefIds:m().arrayOf(m().string).isRequired};var ve=(0,d.Z)("policyForm");const be=(0,P.compose)((0,p.connect)((function(e){return{benchmarkId:ve(e,"benchmark"),businessObjective:ve(e,"businessObjective"),cloneFromProfileId:JSON.parse(ve(e,"profile")).id,refId:ve(e,"refId"),name:ve(e,"name"),description:ve(e,"description"),complianceThreshold:parseFloat(ve(e,"complianceThreshold"))||100,systemIds:ve(e,"systems"),selectedRuleRefIds:ve(e,"selectedRuleRefIds")}})),(0,S.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),me.withApollo)(he);var ge=n(62560);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je=function(e){var t=e.benchmark,n=e.osMajorVersion,r=e.complianceThreshold,o=e.name,i=e.profile,s=e.refId,d=e.selectedRuleRefIds,p=e.systemIds,f=(0,u.useHistory)(),m=(0,c.useState)(1),h=a()(m,2),v=h[0],b=h[1],g=function(){var e=f.location;e.hash&&f.push(Oe(Oe({},e),{},{hash:""}))},E=function(){f.push("/scappolicies")},O=[{id:1,name:"Create SCAP policy",component:l().createElement(x,null),enableNext:(0,ge.$H)(t,n,i)},{id:2,name:"Details",component:l().createElement(ae,null),canJumpTo:v>=2,enableNext:(0,ge.Ay)(o,s,r)},{id:3,name:"Systems",component:l().createElement(ne,null),canJumpTo:v>=3,enableNext:(0,ge.Qy)(p)},{id:4,name:"Rules",component:l().createElement(z,null),canJumpTo:(null==p?void 0:p.length)>0&&v>=4,enableNext:(0,ge.hT)(d)},{id:5,name:"Review",component:l().createElement(pe,null),nextButtonText:"Finish",canJumpTo:(null==p?void 0:p.length)>0&&v>=5},{id:6,name:"Finished",component:l().createElement(be,{onWizardFinish:E}),isFinishedStep:!0,canJumpTo:(null==p?void 0:p.length)>0&&v>=6}];return l().createElement(l().Fragment,null,l().createElement(y.Wizard,{isOpen:!0,width:1220,onNext:function(e){var t=e.id;b(v<t?t:v),g()},onGoToStep:g,onBack:g,onClose:E,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:O}))};je.propTypes={benchmark:m().string,osMajorVersion:m().string,osMinorVersionCounts:m().arrayOf(m().shape({osMinorVersion:m().number,count:m().number})),complianceThreshold:m().string,businessObjective:m().object,dispatch:m().func,isOpen:m().bool,name:m().string,onWizardFinish:m().func,profile:m().string,refId:m().string,selectedRuleRefIds:m().arrayOf(m().string),systemIds:m().arrayOf(m().string)},je.defaultProps={isOpen:!1};var Ie=(0,d.Z)("policyForm");const Se=(0,p.connect)((function(e){return{benchmark:Ie(e,"benchmark"),osMajorVersion:Ie(e,"osMajorVersion"),osMinorVersionCounts:Ie(e,"osMinorVersionCounts"),businessObjective:Ie(e,"businessObjective"),complianceThreshold:Ie(e,"complianceThreshold")||"100.0",name:Ie(e,"name"),profile:Ie(e,"profile"),refId:Ie(e,"refId"),selectedRuleRefIds:Ie(e,"selectedRuleRefIds"),systemIds:Ie(e,"systems")}}))(je)},59661:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EditPolicy:()=>X,MULTIVERSION_QUERY:()=>J,default:()=>ee});var r=n(59713),o=n.n(r),i=n(319),s=n.n(i),a=n(63038),c=n.n(a),l=n(28655),u=n.n(l),d=n(77865),p=n.n(d),f=n(45697),m=n.n(f),y=n(334),h=n(61084),v=n(44119),b=n.n(v),g=n(46829),E=n(4092),O=n(5705),j=n(61156),I=n(50437),S=n(52998),P=n(62560);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,o=function(){var e=(0,d.useState)(!0),t=c()(e,2),n=t[0],r=t[1];return[n,function(e){var t=(0,P.KJ)(e);return r(t),t}]}(),i=c()(o,2),s=i[0],a=i[1];return p().createElement(p().Fragment,null,p().createElement(E.FormGroup,{label:"Policy description",isRequired:!0,fieldId:"description"},p().createElement(E.TextArea,{style:{width:800,height:110},isRequired:!0,type:"text",id:"description",name:"description","aria-describedby":"description",defaultValue:n.description,onChange:function(e){r((function(t){return T(T({},t),{},{description:e})}))}})),p().createElement(E.FormGroup,{label:"Business objective",fieldId:"business-objective"},p().createElement(E.TextInput,{type:"text",style:{width:300},id:"business-objective",name:"business-objective","aria-describedby":"business-objective",defaultValue:null==n||null===(t=n.businessObjective)||void 0===t?void 0:t.title,onChange:function(e){r((function(t){return T(T({},t),{},{businessObjective:T(T({},t.businessObjective),{},{title:e})})}))}})),p().createElement(E.FormGroup,{validated:s?"default":"error",label:"Compliance threshold (%)",fieldId:"policy-threshold",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended"},p().createElement(E.TextInput,{type:"number",style:{width:150},name:"compliance-threshold",id:"compliance-threshold",defaultValue:n.complianceThreshold,"aria-describedby":"policy-threshold",onChange:function(e){r((function(t){return T(T({},t),{},{complianceThreshold:e,complianceThresholdValid:a(e)})}))}})))};V.propTypes={policy:m().shape({description:m().string,businessObjective:m().object,complianceThreshold:m().oneOfType([m().string,m().number])}),setUpdatedPolicy:m().func};const R=V;var k,x=n(92223),C=n(6023),M=n(92515);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=b()(k||(k=u()(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),A=function(e){var t,n=e.handleSelect,r=e.policy,o=e.selectedRuleRefIds,i=e.osMinorVersionCounts,s=null==r?void 0:r.osMajorVersion,a="os_major_version = ".concat(s," ")+"and latest_supported_os_minor_version ^ (".concat(Object.keys(i).sort().join(","),")"),c=(0,M.Z)("benchmarks",{type:"benchmark",include:["profiles"],params:{search:a}},[a]),l=c.data,u=c.loading,f=[],m=Object.values(i).sort((0,j.S)("osMinorVersion","desc")).map((function(e){var t,n=e.osMinorVersion,i=e.count;n="".concat(n);var s=r.policy.profiles.find((function(e){return e.osMinorVersion===n}));if(!s&&l){var a=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(l.collection,n);if(a){var c,u,d,p,f=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(a,r.refId);s=r.policy.profiles.find((function(e){return e.parentProfileId===f.id})),s=D(D({},f),{},{benchmark:null===(c=f.relationships)||void 0===c||null===(u=c.benchmark)||void 0===u?void 0:u.data,rules:null===(d=f.relationships)||void 0===d||null===(p=d.rules)||void 0===p?void 0:p.data},s)}}return{profile:s,systemCount:i,newOsMinorVersion:n,selectedRuleRefIds:null==o||null===(t=o.find((function(e){var t;return e.id===(null===(t=s)||void 0===t?void 0:t.id)})))||void 0===t?void 0:t.ruleRefIds}}));(m=m.filter((function(e){var t=e.profile,n=e.newOsMinorVersion;return!!t&&n}))).forEach((function(e){return f.push(e.profile.id)}));var y="".concat((f||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),h=(0,g.useQuery)(_,{variables:{filter:y},skip:0===y.length}),v=h.data,b=h.error,I=h.loading,S=(null===(t=m)||void 0===t?void 0:t.length)>0?v:void 0,P=!(!I&&!u)||void 0;return(0,d.useLayoutEffect)((function(){v&&((null==v?void 0:v.profiles.edges.map((function(e){return e.node})))||[]).forEach((function(e){if(!(null==o?void 0:o.find((function(t){return t.id===(null==e?void 0:e.id)})))){var t=e.rules.map((function(e){return e.refId}));n(e,t)}}))}),[v]),p().createElement(O.tC,{stateValues:{error:b,data:S,loading:P}},p().createElement(O.K7,{stateKey:"loading"},p().createElement(x.Z,null,p().createElement(C.Z,null))),p().createElement(O.K7,{stateKey:"data"},p().createElement(E.TextContent,null,p().createElement(E.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),p().createElement(O.Hv,{tabsData:m,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:n})))};A.propTypes={handleSelect:m().func,policy:m().object,osMinorVersionCounts:m().shape({osMinorVersion:m().shape({osMinorVersion:m().number,count:m().number})}),selectedRuleRefIds:m().array};const L=A;var N=n(93188),Z=n(55186);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.osMajorVersion,n=e.policyOsMinorVersions,r=(0,y.useHistory)(),o=r.push,i=r.location,s=(0,h.useSelector)((function(e){var t,n;return null==e||null===(t=e.entities)||void 0===t||null===(n=t.selectedEntities)||void 0===n?void 0:n.map((function(e){return"".concat(e.osMinorVersion)}))})),a=p().createElement(p().Fragment,null,p().createElement(E.TextContent,{className:"pf-u-mb-md"},p().createElement(E.Text,null,"You do not have any ",p().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.")),p().createElement(E.TextContent,{className:"pf-u-mb-md"},p().createElement(E.Text,null,"Connect RHEL ",t," systems to Insights."))),c=p().createElement(p().Fragment,null,p().createElement(E.TextContent,{className:"pf-u-mb-md"},p().createElement(E.Text,null,"Select which of your ",p().createElement("b",null,"RHEL ",t)," systems should be included in this policy.")));return p().createElement(p().Fragment,null,p().createElement(N.e_,{prependComponent:c,emptyStateComponent:a,columns:[{key:"display_name",title:"Name",props:{width:40,isStatic:!0},renderFunc:function(e,t,n){var r=n.name;return e||r}},{key:"osMinorVersion",title:"Operating system",props:{width:40,isStatic:!0},renderFunc:function(e,t,n){var r=n.osMajorVersion;return"RHEL ".concat(r,".").concat(e)}}],compact:!0,showActions:!1,query:Z.Y0,defaultFilter:t&&"os_major_version = ".concat(t),enableExport:!1,remediationsEnabled:!1}),(null==s?void 0:s.find((function(e){return!n.includes(e)})))&&p().createElement(E.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:p().createElement(E.AlertActionLink,{onClick:function(){return o($($({},i),{},{hash:"#rules"}))}},"Open rule editing")},p().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well.")))};q.propTypes={osMajorVersion:m().string,policyOsMinorVersions:m().arrayOf(m().number)};const B=q;var H,K=n(38393),G=n(42564),z=n(49690);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=b()(H||(H=u()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        osMajorVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                parentProfileId\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n            osMajorVersion\n        }\n    }\n}\n"]))),Q=function(e,t){return(e||[]).reduce((function(e,t){var n;return""!==t.osMinorVersion&&(e[n=t.osMinorVersion]||(e[n]={osMinorVersion:t.osMinorVersion,count:0})),e}),(0,z.UP)(t||[]))},X=function(e){var t,n=e.route,r=(0,y.useParams)().policy_id,o=(0,g.useQuery)(J,{variables:{policyId:r}}).data,i=null==o?void 0:o.profile,a=(null==i||null===(t=i.policy)||void 0===t?void 0:t.profiles)||[],l=(0,G.ZP)("newInventory"),u=(0,h.useDispatch)(),f=(0,I.Wb)(),m=(0,d.useState)(null),v=c()(m,2),b=v[0],P=v[1],w=(0,d.useState)([]),T=c()(w,2),V=T[0],k=T[1],x=(0,d.useState)({}),C=c()(x,2),M=C[0],F=C[1],D=(0,K.Z)(),_=(0,I.C3)("/scappolicies"),A=(0,d.useState)(),N=c()(A,2),Z=N[0],U=N[1],$=(0,h.useSelector)((function(e){var t;return null==e||null===(t=e.entities)||void 0===t?void 0:t.selectedEntities})),q=b&&!b.complianceThresholdValid,H=function(){l&&u({type:"SELECT_ENTITIES",payload:{ids:[]}}),_({hash:f})},z=[p().createElement(E.Button,{isDisabled:q,key:"save",variant:"primary",spinnerAriaValueText:"Saving",isLoading:Z,onClick:function(){Z||(U(!0),D(i,b).then((function(){U(!1),H()})).catch((function(){U(!1),H()})))}},"Save"),p().createElement(E.Button,{key:"cancel",variant:"secondary",onClick:function(){return H()}},"Cancel")],W=function(){i&&k(a.map((function(e){return{id:e.id,ruleRefIds:e.rules.map((function(e){return e.refId}))}})))};return(0,d.useEffect)((function(){P(Y(Y({},b),{},{hosts:$||[]})),W(),F(Q(a,$))}),[$]),(0,d.useEffect)((function(){return P(Y(Y({},b),{},{selectedRuleRefIds:V}))}),[V]),(0,d.useEffect)((function(){if(i){var e=i.complianceThreshold<101&&i.complianceThreshold>0;P(Y(Y({},i),{},{complianceThresholdValid:e})),W(),u({type:"SELECT_ENTITIES",payload:{ids:(null==i?void 0:i.hosts)||[]}}),F(Q(a,i.hosts))}}),[i]),(0,S.a)(n,null==i?void 0:i.name),p().createElement(E.Modal,{isOpen:!0,style:{height:"400px"},width:1e3,title:"Edit ".concat(i?i.name:""),onClose:function(){return H()},actions:z},i?p().createElement(E.Form,null,p().createElement(O.tn,{defaultTab:"details"},p().createElement(E.Tab,{eventKey:"details",title:p().createElement(E.TabTitleText,null,"Details")},p().createElement(R,{policy:i,setUpdatedPolicy:P})),p().createElement(E.Tab,{eventKey:"rules",title:p().createElement(E.TabTitleText,null,"Rules")},p().createElement(L,{policy:i,handleSelect:function(e,t){var n=V.filter((function(t){return t.id!==e.id}));k([{id:e.id,ruleRefIds:t}].concat(s()(n)))},selectedRuleRefIds:V,osMinorVersionCounts:M})),p().createElement(E.Tab,{eventKey:"systems",title:p().createElement(E.TabTitleText,null,"Systems")},p().createElement(B,{osMajorVersion:i.osMajorVersion,policyOsMinorVersions:(0,j.j)(a.map((function(e){return e.osMinorVersion})))})))):p().createElement(E.Spinner,null))};X.propTypes={route:m().object};const ee=X},38393:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(87757),o=n.n(r),i=n(48926),s=n.n(i),a=n(63038),c=n.n(a),l=n(46829),u=n(13173);function d(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const f=function(){var e,t,n=(e=(0,l.useMutation)(u.Jd),t=c()(e,1)[0],function(){var e=s()(o().mark((function e(n,r){var i,s,a,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==n||null===(i=n.businessObjective)||void 0===i?void 0:i.title)!==(null==r?void 0:r.title)){e.next=4;break}return e.abrupt("return",null==n||null===(s=n.businessObjective)||void 0===s?void 0:s.id);case 4:if(""!==(null==r?void 0:r.title)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,t({variables:{input:{title:r.title}}});case 10:if(a=e.sent,c=a.data,!(l=a.error)){e.next=15;break}throw l;case 15:return e.abrupt("return",c.createBusinessObjective.businessObjective.id);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),r=(0,l.useMutation)(u.r0),i=c()(r,1)[0],a=(0,l.useMutation)(u.nT),p=c()(a,1)[0],f=function(){var e=(0,l.useMutation)(u.oI),t=c()(e,1)[0];return function(){var e=s()(o().mark((function e(n,r){var i,s,a,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.id,e.next=3,t({variables:{input:{id:s,systemIds:r.map((function(e){return e.id}))}}});case 3:if(a=e.sent,c=a.data,!(l=a.error)){e.next=8;break}throw l;case 8:return e.abrupt("return",null==c||null===(i=c.associateSystems)||void 0===i?void 0:i.profile);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}(),m=function(){var e=(0,l.useMutation)(u.Dy),t=c()(e,1)[0];return function(){var e=s()(o().mark((function e(n,r){var i,s,a,c,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.id,s=n.ruleRefIds,a=r.find((function(e){return e.id===i||e.parentProfileId===i})),c={id:null==a?void 0:a.id,ruleRefIds:s},e.next=5,t({variables:{input:c}});case 5:if(l=e.sent,!(u=l.error)){e.next=9;break}throw u;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}();return function(){var e=s()(o().mark((function e(t,r,s){var a,c,l,u,y,h,v,b,g,E,O,j,I,S,P,w;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(null==r?void 0:r.selectedRuleRefIds)||[],c=3+a.length,l=0,u=function(){s&&s(++l/c)},e.next=6,n(t,null==r?void 0:r.businessObjective);case 6:if(y=e.sent,u(),h={name:r.name,description:r.description,complianceThreshold:parseFloat(r.complianceThreshold)},y&&(h.businessObjectiveId=y),null!==t){e.next=25;break}return h.cloneFromProfileId=r.cloneFromProfileId,h.refId=r.refId,h.benchmarkId=r.benchmarkId,e.next=16,p({variables:{input:h}});case 16:if(v=e.sent,b=v.data.createProfile.profile.id,!(g=v.error)){e.next=21;break}throw g;case 21:u(),t={id:b},e.next=33;break;case 25:return h.id=t.id,e.next=28,i({variables:{input:h}});case 28:if(E=e.sent,!(O=E.error)){e.next=32;break}throw O;case 32:u();case 33:return e.next=35,f(t,r.hosts);case 35:j=e.sent,I=j.policy.profiles,u(),S=d(a),e.prev=39,S.s();case 41:if((P=S.n()).done){e.next=48;break}return w=P.value,e.next=45,m(w,I);case 45:u();case 46:e.next=41;break;case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(39),S.e(e.t0);case 53:return e.prev=53,S.f(),e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[39,50,53,56]])})));return function(t,n,r){return e.apply(this,arguments)}}()}},21157:(e,t,n)=>{"use strict";n.d(t,{n1:()=>z,ZP:()=>ce});var r=n(67154),o=n.n(r),i=n(6479),s=n.n(i),a=n(34575),c=n.n(a),l=n(93913),u=n.n(l),d=n(81506),p=n.n(d),f=n(2205),m=n.n(f),y=n(78585),h=n.n(y),v=n(29754),b=n.n(v),g=n(59713),E=n.n(g),O=n(319),j=n.n(O),I=n(28655),S=n.n(I),P=n(35937),w=n.n(P),T=n(77865),V=n.n(T),R=n(45697),k=n.n(R),x=n(98467),C=n(61084),M=n(44119),F=n.n(M),D=n(75959),_=n(22642),A=n(67336),L=n(5705),N=n(59088),Z=n(33660),U=n(16703),$=n(49690),q=n(31222),B=n(43349),H=n(4092),K=n(33739),G=function(e){var t=e.supported,n=e.ssgVersion;return n||(n="Not available"),t?n:V().createElement(L.cT,{messageVariant:"singular"},n)};G.propTypes={supported:k().bool,ssgVersion:k().string};const z={SSGVersion:G};var W,Y,J;function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=F()(W||(W=S()(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),te=F()(Y||(Y=S()(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),ne=function(e){return w()(e.initialDefaultState(),(function(e){return!!e}))},re={page:1},oe=function(e,t){return[].concat(j()((0,q.RM)(e)),j()(t?(0,q.iz)(e):[]))},ie=(0,A.ZP)()(J=function(e){m()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=b()(t);if(n){var o=b()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return h()(this,e)});function i(){var e;c()(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),E()(p()(e),"inventory",V().createRef()),E()(p()(e),"filterConfig",new U.CN([].concat(j()(q.qo),j()(e.props.compliantFilter?q.rN:[]),j()(e.props.policies&&e.props.policies.length>0?oe(e.props.policies,e.props.showOsFilter):[])))),E()(p()(e),"chipBuilder",e.filterConfig.getChipBuilder()),E()(p()(e),"filterBuilder",e.filterConfig.getFilterBuilder()),E()(p()(e),"state",X(X({},re),{},{policyId:e.props.policyId,perPage:50,totalCount:0,activeFilters:ne(e.filterConfig)})),E()(p()(e),"componentDidMount",(function(){var t=e.props,n=t.clearAll,r=t.selectedEntities;r&&r.length>0&&n(),(e.props.preselectedSystems?Promise.resolve(e.props.selectEntities(e.props.preselectedSystems)):Promise.resolve()).then((function(){e.updateSystems()}))})),E()(p()(e),"componentDidUpdate",(function(t){t.complianceThreshold!==e.props.complianceThreshold&&e.updateSystems()})),E()(p()(e),"onRefresh",(function(t){var n=t.page,r=t.per_page,o=s()(t,["page","per_page"]);e.props.showAllSystems&&e.inventory&&e.inventory.current?e.setState({page:n,perPage:r},(function(){e.inventory.current.onRefreshData(X(X({page:n,perPage:r},o),{},{per_page:r}))})):e.setState({page:n,perPage:r},(function(){return e.updateSystems().then((function(){e.inventory&&e.inventory.current&&e.inventory.current.onRefreshData(X(X({page:n,perPage:r},o),{},{per_page:r}))}))}))})),E()(p()(e),"fetchSystems",(function(){var t=e.props,n=t.defaultFilter,r=t.client,o=t.showOnlySystemsWithTestResults,i=t.remediationsEnabled,s=e.state,a=s.policyId,c=s.perPage,l=s.page,u=s.activeFilters,d={filter:[n,o&&"has_test_results = true",e.filterBuilder.buildFilterString(u)].filter((function(e){return!!e})).join(" and "),perPage:c,page:l,policyId:a};return r.query({query:i?ee:te,fetchResults:!0,fetchPolicy:"no-cache",variables:d})})),E()(p()(e),"updateSystems",(function(){var t=e.props.systems.map((function(e){return e.node.id})).sort();return e.fetchSystems().then((function(t){return e.props.updateSystems({systems:t.data.systems.edges,systemsCount:t.data.systems.totalCount})})).then((function(){var n=e.props.systems.map((function(e){return e.node.id})).sort();JSON.stringify(n)===JSON.stringify(t)&&e.props.updateRows()})).catch((function(t){e.setState((function(e){return X(X({},e),{},{error:t})}))}))})),E()(p()(e),"onExportSelect",(function(t,n){return e.props.exportFromState(n)})),E()(p()(e),"onFilterUpdate",(function(t,n){e.props.updateSystems({systems:[],systemsCount:0}),e.setState(X(X({},re),{},{activeFilters:X(X({},e.state.activeFilters),{},E()({},t,n))}),e.updateSystems)})),E()(p()(e),"deleteFilter",(function(t){var n=e.filterConfig.removeFilterWithChip(t,e.state.activeFilters);e.setState(X(X({},re),{},{activeFilters:n}),e.updateSystems)})),E()(p()(e),"clearAllFilter",(function(){e.setState(X(X({},re),{},{activeFilters:ne(e.filterConfig)}),e.updateSystems)})),E()(p()(e),"onFilterDelete",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?e.clearAllFilter():e.deleteFilter(n[0])})),E()(p()(e),"onBulkSelect",(function(){var t=e.props,n=t.selectedEntities,r=t.selectAll,o=t.clearSelection,i=t.allSelectedOnPage;0===n.length||n.length>0&&!i?r():o()})),E()(p()(e),"isExportDisabled",(function(){var t=e.props,n=t.total,r=t.selectedEntities;return 0===(n||0)&&0===r.length})),e}return u()(i,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.remediationsEnabled,i=n.compact,s=n.enableExport,a=n.showAllSystems,c=n.showActions,l=n.showComplianceSystemsInfo,u=n.selectedEntities,d=n.selectedEntitiesIds,p=n.systems,f=n.total,m=n.policyId,y=n.systemProps,h=n.columns,v=this.state,b=v.page,g=v.perPage,E=v.activeFilters,O=v.error,j=this.filterConfig.buildConfiguration(this.onFilterUpdate,E,{hideLabel:!0}),I=this.chipBuilder.chipsFor(this.state.activeFilters),S=s?{isDisabled:this.isExportDisabled(),onSelect:this.onExportSelect}:{},P=X(X({},y),{},{onRefresh:this.onRefresh,ref:this.inventory,page:b,perPage:g,exportConfig:S,tableProps:{canSelectAll:!1},bulkSelect:{checked:u.length>0&&(!!this.props.allSelectedOnPage||null),onSelect:this.onBulkSelect,count:u.length,label:u.length>0?"".concat(u.length," Selected"):void 0}});return c&&(P.actions=[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]),a||(P.total=f,P.items=p.map((function(e){return e.node.id})),P.filterConfig=j,P.activeFiltersConfig={filters:I,onDelete:this.onFilterDelete}),i&&(P.variant=B.TableVariant.compact),void 0===O&&(e=!0),m&&0===f&&0===Object.keys(E).length&&(P.tableProps.rows=[{cells:[{title:V().createElement(L.zT,null)}]}],P.tableProps.columns=[],P.hasItems=!1,P.hasCheckbox=!1),!a&&r&&(P.dedicatedAction=V().createElement(_.Z,{allSystems:(0,Z.qN)(p.filter((function(e){return d.includes(e.node.id)})).map((function(e){return e.node}))),selectedRules:[]})),V().createElement(L.Se,{stateValues:{error:O,noError:e}},V().createElement(L.K7,{stateKey:"error"},V().createElement(L.mf,{error:O})),V().createElement(L.K7,{stateKey:"noError"},l&&V().createElement(H.Alert,{isInline:!0,variant:"info",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems previously or currently associated with compliance policies are displayed."}),V().createElement(K.Z,o()({},P,{fallback:V().createElement(D.Z,{colSize:2,rowSize:15}),onLoad:function(e){var n=e.INVENTORY_ACTION_TYPES,r=e.mergeWithEntities;t.getRegistry().register(X({},r((0,$.zw)(n,h,a))))}}))))}}]),i}(V().Component))||J;ie.propTypes={allSelectedOnPage:k().bool,clearAll:k().func,clearInventoryFilter:k().func,clearSelection:k().func,client:k().object,columns:k().array,compact:k().bool,complianceThreshold:k().number,compliantFilter:k().bool,enableExport:k().bool,error:k().object,exportFromState:k().func,policies:k().array,policyId:k().string,defaultFilter:k().string,preselectedSystems:k().array,remediationsEnabled:k().bool,selectAll:k().func,selectEntities:k().func,selectedEntities:k().array,selectedEntitiesIds:k().array,showActions:k().bool,showAllSystems:k().bool,showOnlySystemsWithTestResults:k().bool,showOsFilter:k().bool,systems:k().array,total:k().number,updateRows:k().func,updateSystems:k().func,systemProps:k().shape({isFullView:k().bool}),showComplianceSystemsInfo:k().bool},ie.defaultProps={remediationsEnabled:!0,compact:!1,enableExport:!0,showAllSystems:!1,complianceThreshold:0,showOnlySystemsWithTestResults:!1,showActions:!0,compliantFilter:!1,selectedEntities:[],selectedEntitiesIds:[],systems:[],clearAll:function(){return{}},exportFromState:function(){return{}},systemProps:{},showComplianceSystemsInfo:!1};var se=(0,T.memo)((function(e){return V().createElement(ie,e)})),ae=(0,x.withApollo)(se);const ce=(0,C.connect)((function(e){return void 0===e.entities||void 0===e.entities.rows?{selectedEntities:[],systems:[]}:{allSelectedOnPage:0===e.entities.rows.filter((function(t){return!(e.entities.selectedEntities||[]).map((function(e){return e.id})).includes(t.id)})).length,selectedEntities:e.entities.selectedEntities,selectedEntitiesIds:(e.entities.selectedEntities||[]).map((function(e){return e.id})),systems:e.entities.systems,total:e.entities.total}}),(function(e){return{clearInventoryFilter:function(){return e({type:"CLEAR_FILTERS"})},exportFromState:function(t){return e((0,N.k6)(t))},updateSystems:function(t){e(X({type:"UPDATE_SYSTEMS"},t))},updateRows:function(){return e({type:"UPDATE_ROWS"})},selectAll:function(){return e((0,N.td)())},clearSelection:function(){return e((0,N.MO)())},clearAll:function(){return e({type:N.pr,payload:{clearAll:!0}})},selectEntities:function(t){return e({type:"SELECT_ENTITIES",payload:{ids:t}})}}}))(ae)},55186:(e,t,n)=>{"use strict";n.d(t,{Ep:()=>p,Y0:()=>f,UD:()=>m});var r,o,i=n(319),s=n.n(i),a=n(28655),c=n.n(a),l=n(44119),u=n.n(l),d=(n(35937),n(31222)),p=u()(r||(r=c()(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    majorOsVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),f=u()(o||(o=c()(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),m=function(e,t){return[].concat(s()((0,d.RM)(e)),s()(t?(0,d.iz)(e):[]))}},93188:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>w,e_:()=>ee,r0:()=>T.ZP}),n(82813);var r,o=n(59713),i=n.n(o),s=n(34575),a=n.n(s),c=n(93913),l=n.n(c),u=n(2205),d=n.n(u),p=n(78585),f=n.n(p),m=n(29754),y=n.n(m),h=n(77865),v=n.n(h),b=n(45697),g=n.n(b),E=n(56455),O=n(67336),j=n(38775),I=n(6363);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var P=(0,O.gu)()(r=function(e){d()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var o=y()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return f()(this,e)});function o(e){return a()(this,o),r.call(this,e)}return l()(o,[{key:"render",value:function(){var e=this;return v().createElement(j.Z,{onLoad:function(t){var n=t.mergeWithDetail;return e.getRegistry().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n()))}},v().createElement(I.Z,{fallback:v().createElement(E.Z,{size:E.i.md}),hideBack:!0}))}}]),o}(v().Component))||r;P.propTypes={entity:g().object};const w=function(e){return v().createElement(P,e)};var T=n(21157),V=(n(37489),n(5499),n(59661),n(62103),n(67154)),R=n.n(V),k=n(319),x=n.n(k),C=n(63038),M=n.n(C),F=n(98467),D=n(61084),_=n(75959),A=n(55186),L=n(49690),N=n(59088),Z=n(83194),U=n(31222),$=n(23279),q=n.n($),B=n(5705),H=n(4092),K=n(43349),G=n(22642),z=n(33660),W=n(39303),Y=n(33739);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t=e.columns,n=e.showAllSystems,r=e.policyId,o=e.query,i=e.client,s=e.showActions,a=e.enableExport,c=e.compliantFilter,l=e.policies,u=e.showOnlySystemsWithTestResults,d=e.showOsFilter,p=e.error,f=e.showComplianceSystemsInfo,m=e.compact,y=e.remediationsEnabled,b=e.systemProps,g=e.defaultFilter,E=e.emptyStateComponent,j=e.prependComponent,I=(0,D.useStore)(),S=(0,D.useDispatch)(),P=(0,h.useRef)(null),w=(0,h.useState)({perPage:50,page:1}),T=M()(w,2),V=T[0],k=T[1],C=(0,h.useState)(!1),F=M()(C,2),$=F[0],J=F[1],X=(0,h.useState)(!1),ee=M()(X,2),te=ee[0],ne=ee[1],re=(0,W.Z)([].concat(x()(U.qo),x()(c?U.rN:[]),x()((null==l?void 0:l.length)>0?(0,A.UD)(l,d):[]))),oe=re.conditionalFilter,ie=re.activeFilters,se=re.buildFilterString,ae=(0,D.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.systemsCount}))||0,ce=(0,D.useSelector)((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.entities;return(null==n||null===(e=n.systems)||void 0===e?void 0:e.map((function(e){var t;return null==e||null===(t=e.node)||void 0===t?void 0:t.id})))||[]}),D.shallowEqual),le=(0,D.useSelector)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.entities;return(null==t?void 0:t.selectedEntities)||[]}),D.shallowEqual),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;J(!1);var n=se(),s=[].concat(x()(u?["has_test_results = true"]:[]),x()((null==n?void 0:n.length)>0?[n]:[])).join(" and "),a=g?"(".concat(g,") and (").concat(s,")"):s;return S({type:"GET_SYSTEMS_PENDING"}),i.query({query:o,fetchResults:!0,fetchPolicy:"no-cache",variables:Q({filter:a,perPage:e,page:t},r&&{policyId:r})}).then((function(n){var r=n.data,o=n.loading;return S({type:"GET_SYSTEMS_FULFILLED",systems:r.systems.edges,systemsCount:r.systems.totalCount}),J(!0),k((function(){return{page:t,perPage:e}})),E&&!o&&0===r.systems.totalCount&&ne(!0),{data:r,loading:o}}))},de=(0,h.useCallback)(q()(ue,800),[oe.activeFiltersConfig.filters]);return(0,h.useEffect)((function(){oe.activeFiltersConfig.filters&&de(V.perPage,1)}),[ie]),v().createElement(B.Se,{stateValues:{error:p,noError:void 0===p&&!te,empty:te}},v().createElement(B.K7,{stateKey:"error"},!!j&&j,v().createElement(B.mf,{error:p})),v().createElement(B.K7,{stateKey:"empty"},E),v().createElement(B.K7,{stateKey:"noError"},!!j&&$&&j,f&&v().createElement(H.Alert,{isInline:!0,variant:"info",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),v().createElement(Y.Z,R()({},b,{onLoad:function(e){var o=e.INVENTORY_ACTION_TYPES,i=e.mergeWithEntities;(0,O.JH)().register(Q({},i((0,L.Q_)(o,t,n,r))))},fallback:v().createElement(_.Z,{colSize:2,rowSize:15}),tableProps:{canSelectAll:!1},variant:m?K.TableVariant.compact:"",ref:P,onRefresh:function(e,t){o&&ue(e.per_page,e.page),!t&&P&&P.current?P.current.onRefreshData(e):t&&t(e)},bulkSelect:{checked:le.length>0&&(!(null==ce||!ce.every((function(e){return null==le?void 0:le.find((function(t){return(null==t?void 0:t.id)===e}))})))||null),onSelect:function(e){return S(e?(0,N.td)():(0,N.MO)())},count:le.length,label:le.length>0?"".concat(le.length," Selected"):void 0}},!n&&Q(Q(Q({},V),{},{isLoaded:$,items:ce,total:ae},oe),y&&{dedicatedAction:v().createElement(G.Z,{allSystems:(0,z.qN)(le),selectedRules:[]})}),a&&{exportConfig:{isDisabled:0===ae&&0===le.length,onSelect:function(e,t){var n;return(0,Z.k6)(null===(n=I.getState())||void 0===n?void 0:n.entities,t)}}},s&&{actions:[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]}))))};X.propTypes={columns:g().arrayOf(g().shape({})),policies:g().arrayOf(g().shape({})),client:g().object,showAllSystems:g().bool,policyId:g().string,query:g().string,showActions:g().bool,enableExport:g().bool,compliantFilter:g().bool,showOnlySystemsWithTestResults:g().bool,showOsFilter:g().bool,showComplianceSystemsInfo:g().bool,error:g().object,compact:g().bool,remediationsEnabled:g().bool,defaultFilter:g().string,systemProps:g().shape({isFullView:g().bool}),emptyStateComponent:g().node,prependComponent:g().node},X.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0};const ee=(0,F.withApollo)(X)},83194:(e,t,n)=>{"use strict";n.d(t,{k6:()=>a});var r=n(50008),o=n.n(r),i=function(e,t){return t.split(".").reduce((function(e,t){return e&&"undefined"!==e[t]?e[t]:void 0}),e)},s=function(e,t){var n=i(e,t);return n.exportValue&&(n=n.exportValue),"object"===o()(n)&&(n=i(e,t+"_text")),"string"==typeof n&&n.includes(",")&&(n='"'+n+'"'),n},a=function(e,t){var n;"csv"===t?n=function(e){var t=e.rows,n=e.columns,r=e.selectedEntities;if(t){var o=[n.map((function(e){return e.title})).join(",")];return o=o.concat((r||t).map((function(t){return e.columns.map((function(e){return e.noExport?"":s(t,e.key)})).join(",")}))),encodeURI("data:text/csv;charset=utf-8,"+o.join("\n"))}}(e):"json"===t&&(n=function(e){var t,n=e.rows,r=e.columns,o=e.selectedEntities;if(n)return t=(o||n).map((function(e){var t={};return r.forEach((function(n){var r=n.key.split("."),o=r[r.length-1];t[o]=s(e,n.key)})),t})),encodeURI("data:application/json;charset=utf-8,"+JSON.stringify(t))}(e)),function(e,t){if(e){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}(n,function(e){return"compliance-export-"+(new Date).toISOString()+"."+e}(t))}},92515:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var r=n(87757),o=n.n(r),i=n(48926),s=n.n(i),a=n(63038),c=n.n(a),l=n(59713),u=n.n(l),d=n(77865),p=n(31222),f=n(41800),m=n.n(f),y=n(34575),h=n.n(y),v=n(93913),b=n.n(v);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h()(this,e),u()(this,"DEFAULT_API_HEADERS",{"Content-Type":"application/vnd.api+json",Accept:"application/json"}),this.apiBase=t.apiBase||"/api",this.path=t.path||"",this.authenticate=t.authenticate||function(){return Promise.resolve({})},this.onUnauthorised=t.onUnauthorised||function(){return Promise.resolve({})},this.defaultHeaders=t.headers||this.DEFAULT_API_HEADERS}var t;return b()(e,[{key:"request",value:(t=s()(o().mark((function e(t,n,r){var i,s=this,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>3&&void 0!==a[3]?a[3]:{},e.next=3,this.callAuthenticate().then((function(){return s.fetch(t,n,r,i)})).then(this.checkForEmptyResponse).then((function(e){return s.checkForErrors(e,i)})).then((function(e){return e.json()})).catch(this.finalCatch);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"finalCatch",value:function(e){return void 0===e.errors?Promise.reject({title:"Error parsing"}):Promise.reject(E({},e))}},{key:"fetch",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o={method:n||"get",headers:this.defaultHeaders,credentials:"include"},i="".concat(this.apiBase).concat(this.path?this.path:"").concat(e||""),s=new URL(i,window.location.origin);if(r.params){var a=Object.keys(r.params).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r.params[e])})).join("&");s.search=new URLSearchParams(a)}return t&&(o.body=JSON.stringify(t)),fetch(s,o)}))},{key:"checkForEmptyResponse",value:function(e){return 204===e.status?{json:function(){return{}}}:e}},{key:"checkForErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(404===e.status&&t.ignore404)return{json:function(){return{}}};if(401===e.status)return this.onUnauthorised();var n=e.clone?e.clone().json():e;return 422===e.status?n.then((function(e){return Promise.reject(E(E({},e),{},{title:"Validation error"}))})):e.status>=400&&e.status<=600?n.then((function(e){return Promise.reject(e.errors[0])})):e}},{key:"callAuthenticate",value:function(){return Promise.resolve(this.authenticate()||!0)}},{key:"create",value:function(e,t){return this.request(e,t,"post")}},{key:"update",value:function(e,t){return this.request(e,t,"put")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,null,"get",t)}},{key:"destroy",value:function(e){return this.request(e,null,"delete")}}]),e}();function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const I=function(e){return new O(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))};function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(e){return e&&function(e,t){var n=e[t],r=e;return delete r[t],P(P({},r),n)}(e,"attributes")},T=function(e,t){var n,r=m()(e);return null===(n=Object.values(r[t]||{}))||void 0===n?void 0:n.map((function(e){return function(e,t){var n={};return Object.entries((null==e?void 0:e.relationships)||[]).forEach((function(e){var r=c()(e,2),o=r[0],i=r[1];n[o]=null==i?void 0:i.data.map((function(e){var n;return w(null==t||null===(n=t[e.type])||void 0===n?void 0:n[e.id])})).filter((function(e){return!!e}))})),delete e.relationships,P(P({},e),n)}(w(e),r)}))},V=function(){var e=s()(o().mark((function e(t,n){var r,i,s,a,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:{},i=c.length>3&&void 0!==c[3]?c[3]:{},e.next=4,t.get("/".concat(n),{params:r});case 4:return s=e.sent,e.next=7,T(s,(null==i?void 0:i.type)||n);case 7:return a=e.sent,e.abrupt("return",{collection:a,meta:s.meta,total:s.meta.total,json:s});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();const R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=(0,d.useState)({data:void 0,loading:!0,error:void 0}),o=c()(r,2),i=o[0],s=o[1],a=I({apiBase:p.dT}),l=P(P({},(null==t?void 0:t.params)||{}),{},{include:(null==t?void 0:t.include)||[]});return(0,d.useEffect)((function(){V(a,e,l,t).then((function(e){s({data:e,loading:void 0,error:void 0})}))}),n),i}},33660:(e,t,n)=>{"use strict";n.d(t,{T4:()=>a,TU:()=>c,qN:()=>u});var r=n(59713),o=n.n(r);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},c=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},l=function(e){return e.testResultProfiles?a(e.testResultProfiles):[]},u=function(e){return e.map((function(e){return s(s({},e),{},{ruleObjectsFailed:l(e),profiles:e.testResultProfiles})}))}},59088:(e,t,n)=>{"use strict";n.d(t,{xM:()=>r,pr:()=>o,k6:()=>i,td:()=>s,MO:()=>a});var r="@@COMPLIANCE/EXPORT",o="SELECT_ENTITY",i=function(e){return{type:r,payload:{format:e}}},s=function(){return{type:o,payload:{id:0,selected:!0}}},a=function(){return{type:o,payload:{id:0,selected:!1}}}},49690:(e,t,n)=>{"use strict";n.d(t,{ek:()=>P,rI:()=>w,B3:()=>R,UP:()=>C,Nw:()=>M,Q_:()=>$,zw:()=>q});var r=n(59713),o=n.n(r),i=n(77865),s=n.n(i),a=n(18546),c=n(62410),l=n(334),u=n(59088),d=n(83194),p=n(5705),f=n(4092),m=n(33660),y=n(50500),h=n(61156);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g="Never",E=function(e){var t=e.testResultProfiles,n=(void 0===t?[]:t).map((function(e){return new Date(e.lastScanned)})),r=new Date(Math.max.apply(null,n.filter((function(e){return isFinite(e)}))));return r instanceof Date&&isFinite(r)?r:g},O=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).every((function(e){return e.lastScanned===g||!0===e.compliant}))},j=function(e){var t=e.testResultProfiles,n=void 0===t?[]:t,r=n.reduce((function(e,t){return e+t.score}),0),o=n.reduce((function(e,t){return(0,m.TU)([t]).length+(0,m.T4)([t]).length>0?e+1:e}),0);return o?r/o:0},I=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).reduce((function(e,t){return e&&t.supported}),!0)},S=function(e){return e==={}?"":e.policies.map((function(e){return e.name})).join(", ")},P=function(e){var t=e.policyNames;return{title:t?s().createElement(f.Tooltip,{content:t},s().createElement(y.Z,{lines:2,width:540},t)):s().createElement(f.Text,{className:"grey-icon"},"No policies"),exportValue:t}},w=function(e){if(e.testResultProfiles&&e.testResultProfiles.length>0)return{title:s().createElement(l.Link,{to:{pathname:"/systems/".concat(e.id)}},"View report")}},T=function(e){return void 0!==e.osMajorVersion&&void 0!==e.osMinorVersion&&null!==e.osMajorVersion&&null!==e.osMinorVersion&&!(0===e.osMajorVersion&&0===e.osMinorVersion)},V=function(e,t){return{title:s().createElement(f.TextContent,null,t.name?s().createElement(l.Link,{to:{pathname:"/systems/".concat(t.id)}},t.name):e.display_name,T(t)&&s().createElement(f.Text,{component:f.TextVariants.small},"RHEL ",t.osMajorVersion,".",t.osMinorVersion)),exportValue:e.display_name||t.name}},R=function(e,t,n){var r=n.osMajorVersion,o=n.osMinorVersion,i=n.name;return s().createElement(f.TextContent,null,s().createElement(l.Link,{to:{pathname:"/systems/".concat(t)}},e||i),T({osMajorVersion:r,osMinorVersion:o})&&s().createElement(f.Text,{component:f.TextVariants.small},"RHEL ",r,".",o))},k=function(e,t){return!!(t||[]).find((function(t){return t.id===e}))},x=function(e){var t=e.testResultProfiles;return(void 0===t?[]:t).map((function(e){return e.ssgVersion})).filter((function(e){return!!e})).join(", ")},C=function(e){return e?e.reduce((function(e,t){var n=t.osMinorVersion;return null!=n&&(e[n]=e[n]||{osMinorVersion:n,count:0}).count++,e}),{}):{}},M=function(e){return Object.values(C(e)).sort((0,h.S)("osMinorVersion","desc"))},F=function(e,t,n,r){return t.map((function(t){void 0===t.facts&&(t.facts={});var o=e.map((function(e){return e.node})).find((function(e){return t.id===e.id}));if(void 0===o){if(!n)return;o={testResultProfiles:[],policies:[]}}return o.policyNames=S(o),o.rulesPassed=(0,m.TU)(o.testResultProfiles).length,o.rulesFailed=(0,m.T4)(o.testResultProfiles).length,o.lastScanned=E(o),o.compliant=O(o),o.score=j(o),o.supported=I(o),{id:t.id,selected:k(t.id,r),account:t.account,bios_uuid:t.bios_uuid,created:t.created,display_name:t.display_name||o.name,fqdn:t.fqdn,insights_id:t.insights_id,ip_addresses:t.ip_addresses,mac_addresses:t.mac_addresses,rhel_machine_id:t.rhel_machine_id,satellite_id:t.satellite_id,subscription_manager_id:t.subscription_manager_id,tags:t.tags,updated:t.updated,facts:{inventory:{hostname:void 0!==t.facts.inventory?t.facts.inventory.hostname:t.facts.hostname,machine_id:void 0!==t.facts.inventory?t.facts.inventory.machine_id:t.facts.machine_id,release:void 0!==t.facts.inventory?t.facts.inventory.release:t.facts.release},compliance:{display_name:V(t,o),policies:P(o),details_link:w(o),rules_passed:o.rulesPassed,rules_failed:{title:s().createElement(l.Link,{to:{pathname:"/systems/".concat(o.id),query:{hidePassed:!0}}},o.rulesFailed)},rules_failed_text:o.rulesFailed,compliance_score:(0,p.OF)(o),compliance_score_text:(0,p.Oq)(o),last_scanned:o.lastScanned instanceof Date?{title:s().createElement(c.Z,{date:Date.parse(o.lastScanned),type:"relative"})}:o.lastScanned,last_scanned_text:o.lastScanned,ssg_version:x(o),supported:o.supported}}}})).filter((function(e){return!!e}))},D=function(e){return e.map((function(e){var t=e.node;return b(b({},t),{},{policyNames:S({policies:null==t?void 0:t.policies,testResultProfiles:[]}),rulesPassed:(0,m.TU)(t.testResultProfiles).length,rulesFailed:(0,m.T4)(t.testResultProfiles).length,lastScanned:E(t),compliant:O(t),display_name:t.name,score:j(t),supported:I(t),ssgVersion:x(t),detailsLink:w(t)})}))},_=function(e,t){var n=e.rows.filter((function(n){return t.includes(n.id)&&!(e.selectedEntities||[]).map((function(e){return e.id})).includes(n.id)}));return b(b({},e),{},{selectedEntities:(e.selectedEntities||[]).concat(n)})},A=function(e,t){return b(b({},e),{},{selectedEntities:(e.selectedEntities||[]).filter((function(e){return!t.includes(e.id)}))})},L=function(e){return _(e,e.rows.map((function(e){return e.id})))},N=function(e){return A(e,e.rows.map((function(e){return e.id})))},Z=function(e,t){return _(e,[t])},U=function(e,t){return A(e,[t])},$=function(e,t){var n;return(0,a.Gg)((n={},o()(n,"GET_SYSTEMS_PENDING",(function(e){return b(b({},e),{},{rows:[],systems:void 0,systemsCount:void 0,columns:t,loaded:!1})})),o()(n,"GET_SYSTEMS_FULFILLED",(function(e,n){var r=n.systems,o=n.systemsCount;return b(b({},e),{},{systems:r,systemsCount:o,total:o,rows:D(r).map((function(t){return b(b({},t),{},{selected:k(t.id,e.selectedEntities)})})),columns:t,loaded:!0})})),o()(n,e.LOAD_ENTITIES_PENDING,(function(e){return b(b({},e),{},{total:e.systemsCount,rows:void 0!==e.systems?D(e.systems).map((function(t){return b(b({},t),{},{selected:k(t.id,e.selectedEntities)})})):[],columns:t,loaded:void 0!==e.systemsCount})})),o()(n,e.LOAD_ENTITIES_FULFILLED,(function(e){return b(b({},e),{},{total:e.systemsCount,rows:void 0!==e.systems?D(e.systems).map((function(t){return b(b({},t),{},{selected:k(t.id,e.selectedEntities)})})):[],columns:t,loaded:void 0!==e.systemsCount})})),o()(n,u.pr,(function(e,t){var n,r=t.payload,o=r.id,i=r.selected,s=r.clearAll;return(0===(n=0===o?i?L(e):N(e):i?Z(e,o):U(e,o)).selectedEntities.length||s)&&(n.selectedEntities=void 0),n})),o()(n,"SELECT_ENTITIES",(function(e,t){return{selectedEntities:t.payload.ids}})),n))},q=function(e,t,n){var r;return(0,a.Gg)((r={},o()(r,"UPDATE_SYSTEMS",(function(e,t){var n=t.systems,r=t.systemsCount;return b(b({},e),{},{systems:n,systemsCount:r})})),o()(r,"UPDATE_ROWS",(function(e){return b(b({},e),{},{loaded:!0,rows:F(e.systems||[],e.rows||[],n,e.selectedEntities)})})),o()(r,e.LOAD_ENTITIES_FULFILLED,(function(e){return b(b({},e),{},{rows:F(e.systems||[],e.rows,n,e.selectedEntities),total:n?e.total:e.systemsCount,columns:e.total>0?t:[{title:""}]})})),o()(r,u.xM,(function(e,t){var n=t.payload.format;return(0,d.k6)(e,n),e})),o()(r,u.pr,(function(e,t){var n,r=t.payload,o=r.id,i=r.selected,s=r.clearAll;return(0===(n=0===o?i?L(e):N(e):i?Z(e,o):U(e,o)).selectedEntities.length||s)&&(n.selectedEntities=void 0),n})),o()(r,"SELECT_ENTITIES",(function(e,t){return{selectedEntities:t.payload.ids}})),r))}}}]);
//# sourceMappingURL=EditPolicy.14992f082b782ba0dfaf.js.map
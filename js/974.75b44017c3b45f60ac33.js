(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[974],{19949:(e,t,r)=>{"use strict";r.d(t,{Z:()=>E});var n,o=r(32465),i=r(92950),l=r.n(i),a=r(45697),c=r.n(a),s=r(11100),u=r(86624),p=r(12340),f=r(97066),m=r(7162),d=r(33121),h=r(46829),y=r(28873),v=r(54288),b=(0,d.ZP)(n||(n=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      totalCount\n    }\n  }\n']))),g=function(e){var t=e.title,r=e.mainButton,n=e.client,o=(0,h.useQuery)(b,{fetchPolicy:"network-only",client:n}),i=o.data,a=o.error;if(o.loading)return l().createElement(y.Z,null);if(a){var c="Oops! Error loading System data: ".concat(a);return l().createElement(v.ErrorCard,{message:c})}var s=i.profiles.totalCount,u=s>1?"policies":"policy",p=s>1?"have":"has";return l().createElement(f.Bullseye,null,l().createElement(f.EmptyState,null,l().createElement(f.EmptyStateIcon,{style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"},size:"xl",title:"Compliance",icon:m.ZP}),l().createElement(f.Title,{headingLevel:"h1",size:"lg"},t),l().createElement("br",null),l().createElement(f.EmptyStateBody,null,s>0&&l().createElement(f.TextContent,null,l().createElement("a",{href:"insights/compliance/scappolicies"},s," ",u)," ",p," been created but ",p," no reports."),l().createElement(f.TextContent,null,"The Compliance service uses SCAP policies to track your organization's adherence to compliance requirements."),l().createElement(f.TextContent,null,"Get started by adding a policy, or read documentation about how to connect OpenSCAP to the Compliance service.")),l().createElement(f.EmptyStatePrimary,null,r),l().createElement(f.EmptyStateSecondaryActions,null,l().createElement(f.Button,{variant:"link",component:"a",target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2020-04/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/index"},"Learn about OpenSCAP and Compliance"))))};g.propTypes={title:c().string,mainButton:c().object,client:c().object},g.defaultProps={title:"No policies",mainButton:l().createElement(f.Button,{variant:"primary",component:"a",href:"/insights/compliance/scappolicies"},"Create new policy"),client:new s.fe({link:new u.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new p.h4})};const E=g},76450:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var n=r(92137),o=r(6610),i=r(5991),l=r(63349),a=r(10379),c=r(46070),s=r(77608),u=r(96156),p=r(87757),f=r.n(p),m=r(92950),d=r.n(m),h=r(45697),y=r.n(h),v=r(84914),b=r(85564),g=r.n(b),E=r(557),O=r(83215),P=r(16712);var w=function(e){(0,a.Z)(m,e);var t,r,p=(t=m,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var o=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function m(){var e;(0,o.Z)(this,m);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=p.call.apply(p,[this].concat(r)),(0,u.Z)((0,l.Z)(e),"formatRule",(function(e,t,r,n){var o=e.title,i=e.refId;return{id:"ssg:rhel".concat(n,"|").concat(t.split("xccdf_org.ssgproject.content_profile_")[1],"|").concat(i),description:o,systems:[r]}})),(0,u.Z)((0,l.Z)(e),"uniqIssuesBySystem",(function(e){var t=e.map((function(e){return e.id}));return e.filter((function(r,n){var o=t.indexOf(r.id);return o===n||(e[o].systems=Array.from(new Set(e[o].systems.concat(r.systems))))&&!1}))})),(0,u.Z)((0,l.Z)(e),"ruleProfile",(function(e,t){return t.profiles.find((function(t){return t.rules.find((function(t){return e.refId===t.refId}))}))})),(0,u.Z)((0,l.Z)(e),"rulesWithRemediations",(function(t,r){return t.filter((function(t){return t.remediationAvailable&&e.ruleProfile(t,r).supported&&!1===t.compliant})).map((function(t){var n=e.ruleProfile(t,r);return e.formatRule(t,n.refId,r.id,n.majorOsVersion)}))})),(0,u.Z)((0,l.Z)(e),"dataProvider",(function(){var t=e.props,r=t.allSystems,o=t.selectedRules,i={systems:[],issues:[]};return r.filter((function(e){return e.supported})).forEach(function(){var t=(0,n.Z)(f().mark((function t(r){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.systems.push(r.id),0!==o.length?i.issues.push(e.rulesWithRemediations(o,r)):i.issues.push(e.rulesWithRemediations(r.ruleObjectsFailed,r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Promise.all(i.issues).then((function(t){return i.issues=e.uniqIssuesBySystem(g()(t)),i}))})),(0,u.Z)((0,l.Z)(e),"notEmptyData",(0,n.Z)(f().mark((function t(){var r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dataProvider();case 2:return r=t.sent,t.abrupt("return",r.issues.length>0&&r.systems.length>0);case 4:case"end":return t.stop()}}),t)})))),(0,u.Z)((0,l.Z)(e),"remediationAvailable",(function(){var t=e.props,r=t.allSystems,n=t.selectedRules;return(n.length?n:r.flatMap((function(e){return e.ruleObjectsFailed}))).some((function(t){var n;return t.remediationAvailable&&((null===(n=t.profiles)||void 0===n?void 0:n.some((function(e){return e.supported})))||r.some((function(r){return e.ruleProfile(t,r).supported})))&&!1===t.compliant}))})),e}return(0,i.Z)(m,[{key:"render",value:function(){var e=this.props.addNotification;return d().createElement(d().Fragment,null,d().createElement(v.Z,{isDisabled:!(this.remediationAvailable()&&this.notEmptyData()),onRemediationCreated:function(t){return e(t.getNotification())},dataProvider:this.dataProvider,buttonProps:{ouiaId:"RemediateButton"}},d().createElement(P.ZP,{size:"sm",color:"var(--pf-c-button--m-primary--Color)"})," Remediate"))}}]),m}(d().Component);w.propTypes={selectedRules:y().array,allSystems:y().arrayOf(y().shape({id:y().string,name:y().string,supported:y().bool.isRequired,profiles:y().arrayOf(y().shape({refId:y().string,name:y().string,rules:y().arrayOf(y().shape({title:y().string,severity:y().string,rationale:y().string,refId:y().string,description:y().string,compliant:y().bool,identifier:y().string,references:y().string}))}))})),addNotification:y().func},w.defaultProps={allSystems:[]};const j=(0,E.connect)((function(){return{}}),(function(e){return{addNotification:function(t){return e((0,O.wN)(t))}}}))(w)},54288:(e,t,r)=>{"use strict";r(92950);var n=r(45697),o=r.n(n);r(97066),r(93929);o().string},74726:(e,t,r)=>{"use strict";r.d(t,{_c:()=>a,do:()=>c});var n=r(22122),o=r(92950),i=r.n(o),l=(r(20936),r(97066)),a=function(e){return i().createElement(l.TextInput,(0,n.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))},c=function(e){return i().createElement(l.TextArea,(0,n.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))}},25870:(e,t,r)=>{"use strict";r.d(t,{$9:()=>m,GC:()=>d,Jr:()=>v,zb:()=>E,KH:()=>O,PS:()=>P});var n=r(92950),o=r.n(n),i=r(45697),l=r.n(i),a=r(97066),c=r(68778),s=r(43047),u=r(69957),p=r(73479),f={title:l().string,identifier:l().object,profile:l().object,compliant:l().bool,remediationAvailable:l().bool,severity:l().string},m=function(e){var t=e.title,r=e.identifier;return o().createElement(a.TextContent,null,t,r?o().createElement(a.Text,{component:a.TextVariants.small},r.label):"")};m.propTypes=f;var d=function(e){return e.profile.name};d.propTypes=f;var h=function(){return o().createElement("span",null,o().createElement(s.ZP,{className:"ins-u-failed"})," High")},y=function(){return o().createElement("span",null,o().createElement(u.ZP,{className:"ins-u-warning"})," Medium")},v=function(){return o().createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",role:"img",style:{verticalAlign:"-0.125em"},xmlns:"http://www.w3.org/2000/svg"},o().createElement("path",{d:"M2 0h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm6.67 10.46a1.67 1.67 0 1 0 0 3.338 1.67 1.67 0 0 0 0-3.338zm-1.586-6l.27 4.935a.435.435 0 0 0 .434.411H9.55c.232 0 .422-.18.435-.411l.27-4.936A.435.435 0 0 0 9.818 4h-2.3c-.25 0-.448.21-.435.46z",fill:"#3A9CA6",fillRule:"evenodd"}))},b=function(){return o().createElement("span",null,o().createElement(v,null)," Low")},g=function(){return o().createElement("span",null,o().createElement(p.ZP,null)," Unknown")},E=function(e){var t=e.severity;return{high:o().createElement(h,null),medium:o().createElement(y,null),low:o().createElement(b,null)}[null==t?void 0:t.toLowerCase()]||o().createElement(g,null)};E.propTypes=f;var O=function(e){return e.compliant?o().createElement(c.ZP,{className:"ins-u-passed"}):o().createElement(s.ZP,{className:"ins-u-failed"})};O.propTypes=f;var P=function(e){return e.remediationAvailable?o().createElement(c.ZP,{className:"ins-u-passed"}):"No"};P.propTypes=f},94263:(e,t,r)=>{"use strict";r.d(t,{VG:()=>s,GC:()=>u,zb:()=>p,KH:()=>f,PS:()=>m});var n=r(92950),o=r.n(n),i=r(6877),l=r(16712),a=r(79886),c=r(25870),s={title:"Name",sortByProp:"title",renderFunc:(0,a.SO)(c.$9)},u={title:"Policy",sortByFunction:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderFunc:(0,a.SO)(c.GC)},p={title:"Severity",sortByProp:"severity",transforms:[i.fitContent],sortByArray:["high","medium","low","unknown"],renderFunc:(0,a.SO)(c.zb)},f={title:"Passed",sortByProp:"compliant",renderFunc:(0,a.SO)(c.KH)},m={title:o().createElement("span",null,o().createElement(l.ZP,null)," Ansible"),original:"Ansible",props:{tooltip:"Ansible"},transforms:[i.fitContent],sortByProp:"remediationAvailable",renderFunc:(0,a.SO)(c.PS)}},91989:(e,t,r)=>{"use strict";r.d(t,{Z:()=>N});var n=r(22122),o=r(96156),i=r(81253),l=r(92950),a=r.n(l),c=r(45697),s=r.n(c),u=r(76450),p=r(86052),f=r(82176),m=r(97066),d=r(67),h=function(e){var t=e.rule,r=t.refId,n=t.description,o=t.identifier,i=t.references,l=t.rationale,c="rule-child-row-".concat(r);return a().createElement("div",{key:c,style:{marginTop:"var(--pf-global--spacer--lg)"}},a().createElement(m.Stack,{id:"rule-description-".concat(c),className:"margin-bottom-lg"},a().createElement(m.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},a().createElement(m.Text,{className:"pf-c-form__label",component:m.TextVariants.h5},a().createElement("b",null,"Description"))),a().createElement(m.StackItem,{isFilled:!0},n)),a().createElement(m.Stack,{id:"rule-identifiers-references-".concat(c),className:"margin-bottom-lg"},a().createElement(m.Grid,null,o&&o.length>0&&a().createElement(m.GridItem,{span:2},a().createElement(m.Text,{className:"pf-c-form__label",component:m.TextVariants.h5},a().createElement("b",null,"Identifier")),a().createElement(m.Text,null,o.map((function(e,t){return a().createElement(d.MT,{href:e.system,target:"_blank",key:"".concat(r,"-identifier-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))),i&&i.length>0&&a().createElement(m.GridItem,{span:10},a().createElement(m.Text,{className:"pf-c-form__label",component:m.TextVariants.h5},a().createElement("b",null,"References")),a().createElement(m.Text,null,i.map((function(e,t){return a().createElement(d.MT,{href:e.href,target:"_blank",key:"".concat(r,"-reference-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))))),l&&a().createElement(m.Stack,{id:"rule-rationale-".concat(c),style:{marginBottom:"var(--pf-global--spacer--lg)"}},a().createElement(m.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},a().createElement(m.Text,{className:"pf-c-form__label",component:m.TextVariants.h5},a().createElement("b",null,"Rationale"))),a().createElement(m.StackItem,{isFilled:!0},l)))};h.propTypes={rule:s().object};const y=h;var v=r(92223);const b=function(e){return[{cells:[{title:a().createElement(v.Z,null,a().createElement(m.Bullseye,null,a().createElement(m.EmptyState,{variant:m.EmptyStateVariant.full},a().createElement(m.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),a().createElement(m.EmptyStateBody,null,"This filter criteria matches no rules. ",a().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:e.length}}]}]};var g=r(43047),E=r(69957),O=r(73479),P=r(25870),w=a().createElement("span",null,a().createElement(g.ZP,{className:"ins-u-failed"})," High"),j=a().createElement("span",null,a().createElement(E.ZP,{className:"ins-u-warning"})," Medium"),T=a().createElement("span",null,a().createElement(P.Jr,null)," Low"),x=a().createElement("span",null,a().createElement(O.ZP,null)," Unknown"),C=r(89421),Z=function(e,t,r){return e.filter((function(e){return t.map((function(t){return r(e,t)})).filter((function(e){return!!e})).length>0}))},S=function(e,t,r){var n=[];return e.forEach((function(e){t.map((function(t){return r(e,t)})).filter((function(e){return!!e})).length>0&&n.push(e)})),n},k=[{type:C.Yu.text,label:"Name",filter:function(e,t){return Z(e,[t],(function(e,t){return e.title.toLowerCase().includes(t.toLowerCase())||e.identifier&&e.identifier.label.toLowerCase().includes(t.toLowerCase())||e.references.filter((function(e){return e.label.toLowerCase().includes(t.toLowerCase())})).length>0}))}},{type:C.Yu.checkbox,label:"Severity",items:[{label:w,value:"high"},{label:j,value:"medium"},{label:T,value:"low"},{label:x,value:"unknown"}],filter:function(e,t){return S(e,t,(function(e,t){return e.severity===t}))}}],F={type:C.Yu.checkbox,label:"Passed",items:[{label:"Passed rules",value:"passed"},{label:"Failed rules",value:"failed"}],filter:function(e,t){return S(e,t,(function(e,t){return e.compliant===("passed"===t)}))}},V={type:C.Yu.checkbox,label:"Remediation available",items:[{label:"Remediation available",value:"true"}],filter:function(e,t){return e.filter((function(e){return"true"!==t[0]||!0===e.remediationAvailable}))}};const I=function(e){var t=e.showPassFailFilter,r=e.policies,n=e.remediationAvailableFilter,o=[].concat(k);return t&&o.push(F),r&&r.length>1&&o.push(function(e){return{type:C.Yu.checkbox,label:"Policy",items:e.map((function(e){return{label:e.name,value:e.id}})),filter:function(e,t){return Z(e,t,(function(e,t){return(e.profile.policy?e.profile.policy.id:e.profile.id)===t}))}}}(r)),n&&o.push(V),o};var R=r(94263),B=["system","profileRules","columns","remediationsEnabled","remediationAvailableFilter","selectedFilter","handleSelect","selectedRefIds","hidePassed","options"];function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){var t=e.system,r=e.profileRules,o=e.columns,l=void 0===o?[R.VG,R.GC,R.zb,R.KH,R.PS]:o,c=e.remediationsEnabled,s=void 0===c||c,m=e.remediationAvailableFilter,d=void 0!==m&&m,h=e.selectedFilter,v=void 0!==h&&h,g=e.handleSelect,E=e.selectedRefIds,O=void 0===E?[]:E,P=e.hidePassed,w=void 0!==P&&P,j=e.options,T=(0,i.Z)(e,B),x=(0,f.uJ)(r),C=l.filter((function(e){return"Passed"===e.title})).length>0,Z=r.filter((function(e){return!!e.profile})).map((function(e){var t=e.profile;return{id:t.policy?t.policy.id:t.id,name:t.name}}));return a().createElement(p.v,(0,n.Z)({"aria-label":"Rules Table",items:x,columns:l,isStickyHeader:!0,filters:D({filterConfig:I({showPassFailFilter:C,policies:Z,remediationAvailableFilter:d})},w&&{activeFilters:{passed:["failed"]}}),options:D(D({},j),{},{identifier:function(e){return e.refId},selectable:!!g||s,onSelect:g,preselected:O,detailsComponent:y,emptyRows:b(l),selectedFilter:v},s?{dedicatedAction:function(e){var r=e.selected;return a().createElement(u.Z,{allSystems:[{id:t.id,profiles:t.testResultProfiles,ruleObjectsFailed:[],supported:t.supported}],selectedRules:(r||[]).filter((function(e){return e.remediationAvailable}))})}}:{})},T))};A.propTypes={profileRules:s().array,loading:s().bool,hidePassed:s().bool,system:s().object,remediationsEnabled:s().bool,remediationAvailableFilter:s().bool,selectedRefIds:s().array,selectedFilter:s().bool,handleSelect:s().func,columns:s().array,options:s().object};const N=A},10530:(e,t,r)=>{"use strict";r.d(t,{Hv:()=>D,uU:()=>V,TB:()=>k,b4:()=>F});var n=r(85061),o=r(81253),i=r(92950),l=r.n(i),a=r(45697),c=r.n(a),s=r(97066),u=r(67),p=r(22122),f=r(32465),m=r(46829),d=r(33121),h=r(91290),y=r(11443);const v=function(e){var t=e.profile,r=e.newOsMinorVersion;return"RHEL".concat(" ",t.osMajorVersion,".").concat(t.osMinorVersion||r)};var b,g=function(e){var t=e.count,r=void 0===t?0:t;return l().createElement(s.Badge,{isRead:!0},"".concat(r," ").concat((0,y._6)(r,"system")))};g.propTypes={profile:c().object,count:c().number};var E=function(e){var t=e.profile,r=e.newOsMinorVersion;return l().createElement(s.Text,{component:s.TextVariants.p},"SSG version: ",t.ssgVersion," ",l().createElement(s.Popover,{position:"right",bodyContent:l().createElement(O,{profile:t,newOsMinorVersion:r}),footerContent:l().createElement(u.bL,null)},l().createElement("span",{style:{cursor:"pointer"}},l().createElement(h.ZP,{className:"grey-icon"}))))};E.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var O=function(e){var t=e.profile,r=e.newOsMinorVersion;return l().createElement(s.TextContent,{style:{fontSize:"var(--pf-c-popover--FontSize)"}},l().createElement(s.Text,null,"This is the latest supported version of the SCAP Security Guide (SSG) for"," ",l().createElement(v,{profile:t,newOsMinorVersion:r})),l().createElement(s.Text,null,l().createElement(v,{profile:t,newOsMinorVersion:r})," systems assigned to this policy will report using this rule list."))};O.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var P=(0,d.ZP)(b||(b=(0,f.Z)(["\n  query benchmarkQuery($id: String!) {\n    benchmark(id: $id) {\n      id\n      osMajorVersion\n      rules {\n        id\n        title\n        severity\n        rationale\n        refId\n        description\n        remediationAvailable\n        identifier\n      }\n    }\n  }\n"]))),w=function(e){var t,r,n=e.profile,o=e.columns,i=e.handleSelect,a=e.systemCount,c=e.selectedRuleRefIds,f=e.rulesTableProps,d=e.newOsMinorVersion,h=(0,m.useQuery)(P,{variables:{id:n.benchmark.id},skip:!i||!(null!==(t=n.benchmark)&&void 0!==t&&t.id)}),y=h.data,b=h.error,O=h.loading,w=i?null==y||null===(r=y.benchmark)||void 0===r?void 0:r.rules:null==n?void 0:n.rules;return l().createElement(l().Fragment,null,l().createElement(s.Grid,null,l().createElement(s.TextContent,{className:"pf-u-mt-md"},l().createElement(s.Text,{component:s.TextVariants.h3},l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(v,{profile:n,newOsMinorVersion:d})),l().createElement(g,{count:a})),l().createElement(E,{profile:n,newOsMinorVersion:d}))),l().createElement(u.tC,{stateValues:{error:b,loading:O,rules:w}},l().createElement(u.K7,{stateKey:"loading"},l().createElement(s.Spinner,null)),l().createElement(u.K7,{stateKey:"rules"},l().createElement(u.iK,(0,p.Z)({remediationAvailableFilter:!0,remediationsEnabled:!1,columns:o,profileRules:[{profile:n,rules:w||[]}],selectedRefIds:c,handleSelect:i&&function(e){return i(n,d,e)}},f)))))};w.propTypes={profile:c().object,newOsMinorVersion:c().string,columns:c().array,handleSelect:c().func,systemCount:c().object,selectedRuleRefIds:c().array,rulesTableProps:c().object};const j=w;var T=r(96156);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,T.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e,t,r){return e.id===t.id&&e.osMinorVersion===(r||t.osMinorVersion)},S=function(e,t,r){var n=(e||[]).find((function(e){return Z(e,t,r)}));return(null==n?void 0:n.ruleRefIds)||[]},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.only,i=e.map((function(e){var r,n=t.find((function(t){return Z(t,e)}));return n?o?n:void 0:(e.rules||console.error("Profile ".concat(e.id," is missing rules for selection!")),e.osMinorVersion||console.error("Profile ".concat(e.id," is missing osMinorVersion for selection!")),{id:e.id,osMinorVersion:e.osMinorVersion,ruleRefIds:(null===(r=e.rules)||void 0===r?void 0:r.map((function(e){return e.refId})))||[]})})).filter((function(e){return!!e}));return o?i:[].concat((0,n.Z)(t),(0,n.Z)(i))},F=function(e){var t={};return e.forEach((function(e){var r=e.profile,o=e.newOsMinorVersion;if(null!=r&&r.id){var i=o||r.osMinorVersion;t[r.id]=[].concat((0,n.Z)(t[r.id]||[]),[i])}})),t},V=function(e,t){return e.flatMap((function(e){return(t[e.id]||[void 0]).map((function(t){return C(C({},e),{},{osMinorVersion:t})}))}))},I=["tabsData","defaultTab","selectedRuleRefIds","setSelectedRuleRefIds","columns","level"],R=function(e,t){var r=e.id,n=e.osMinorVersion;return"rules-".concat(r,"-").concat(n||t)},B=function(e,t){if(e&&0!==e.length){if(!t){var r=e[0];t={id:r.profile.id,osMinorVersion:r.profile.osMinorVersion||r.newOsMinorVersion}}return R(t)}},L=function(e){var t=e.tabsData,r=e.defaultTab,i=e.selectedRuleRefIds,a=e.setSelectedRuleRefIds,c=e.columns,p=e.level,f=void 0===p?0:p,m=(0,o.Z)(e,I),d=function(e,t,r){var o=(i||[]).filter((function(r){return!Z(r,e,t)})),l={id:e.id,osMinorVersion:t||e.osMinorVersion,ruleRefIds:r};a([l].concat((0,n.Z)(o)))};return l().createElement(u.tn,{level:f,defaultTab:B(t,r)},null==t?void 0:t.map((function(e){var t=e.profile,r=e.newOsMinorVersion,n=e.systemCount;return l().createElement(s.Tab,{key:R(t,r),eventKey:R(t,r),title:l().createElement("span",null,l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(v,{profile:t,newOsMinorVersion:r})),l().createElement(s.Badge,{isRead:!0},n))},l().createElement(j,{profile:t,newOsMinorVersion:r,columns:c,rulesTableProps:m,systemCount:n,selectedRuleRefIds:S(i,t,r),handleSelect:a?d:void 0}))})))};L.propTypes={tabsData:c().arrayOf(c().shape({profile:c().object.isRequired,selectedRuleRefIds:c().arrayOf(c().string),newOsMinorVersion:c().string,systemCount:c().number})).isRequired,selectedRuleRefIds:c().arrayOf(c().shape({id:c().string,ruleRefIds:c().arrayOf(c().string)})),setSelectedRuleRefIds:c().func,columns:c().arrayOf(c().object),defaultTab:c().shape({id:c().string,osMinorVersion:c().string}),level:c().number};const D=L},21262:(e,t,r)=>{"use strict";r.d(t,{i:()=>d,Z:()=>E});var n=r(96156),o=r(92950),i=r.n(o),l=r(45697),a=r.n(l),c=r(97066),s=r(69957),u=r(91290),p=r(67);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d="https://access.redhat.com/documentation/en-us/red_hat_insights/2020-10/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/con-compl-assess-overview_compl-assess-overview#con-compl-assess-supported-configurations_compl-assess-overview",h=i().createElement(i().Fragment,null,i().createElement(c.Text,{variant:"p",style:{marginBottom:"1rem"}},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),i().createElement(c.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),y=function(e){var t=e.children,r=e.variant,n=void 0===r?"plural":r;return i().createElement(c.Popover,{id:"unsupported-popover",maxWidth:"25rem",headerContent:"Unsupported SSG versions",bodyContent:"plural"===n?h:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:i().createElement(p.bL,null)},t)};y.propTypes={children:a().node,variant:a().oneOf(["singular","plural"])};var v=function(e){var t=e.children,r=e.content;return i().createElement(c.Tooltip,{content:r,position:"bottom"},t)};v.propTypes={content:a().string,children:a().node};var b=function(e){var t=e.variant,r=e.children,n=e.tooltipProps,o={tooltip:{Component:v,componentProps:n},popover:{Component:y,componentProps:{showHeader:n.showPopupHeader,variant:n.messageVariant}}}[t],l=o.Component,a=o.componentProps;return i().createElement(l,a,r)};b.propTypes={children:a().node,variant:a().oneOf(["tooltip","popover"]),tooltipProps:a().object};var g=function(e){var t=e.children,r=e.showWarningIcon,n=void 0===r||r,o=e.showHelpIcon,l=void 0!==o&&o,a=e.style,c=e.tooltipText,p=e.messageVariant,f={variant:c?"tooltip":"popover",tooltipProps:m(m({},c&&{content:i().createElement("div",null,c)}),{},{messageVariant:p})},d=c?{}:{cursor:"pointer"};return i().createElement("span",{style:m(m({},a),{},{display:"inline-block"})},n&&i().createElement(b,f,i().createElement("span",{style:d,className:"pf-u-mr-xs"},i().createElement(s.ZP,{color:"var(--pf-global--warning-color--100)"}))),t,l&&i().createElement(b,f,i().createElement("span",{style:d,className:"pf-u-ml-xs"},i().createElement(u.ZP,null))))};g.propTypes={showWarningIcon:a().bool,showHelpIcon:a().bool,style:a().object,tooltipText:a().string,children:a().node,variant:a().string,messageVariant:a().string,showPopupHeader:a().bool};const E=g},67:(e,t,r)=>{"use strict";r.d(t,{mR:()=>xe,MU:()=>Fe,OF:()=>A,MT:()=>Ct,X8:()=>le,mf:()=>j,AY:()=>x,Ir:()=>y,JS:()=>jt,V_:()=>ot,xB:()=>$e,PL:()=>M,NP:()=>z,o$:()=>Ue,w8:()=>We,_z:()=>vt,yL:()=>V,ko:()=>ne,Tq:()=>H,vu:()=>ee,vm:()=>ze,Ek:()=>Ge,Jm:()=>ce,tn:()=>se,iK:()=>Tt.Z,Se:()=>fe,K7:()=>ue,tC:()=>me,Zr:()=>Pt,bL:()=>Et,UN:()=>ve,Hv:()=>wt.Hv,cT:()=>bt.Z,Vs:()=>de,fz:()=>Ee,Oq:()=>D,fQ:()=>et});var n={};r.r(n),r.d(n,{nameFilter:()=>tt});var o=r(85061),i=r(92950),l=r.n(i),a=r(6877),c=r(96541),s=r(45697),u=r.n(s),p=r(97066),f=r(334),m=r(79886),d=function(e){var t=e.id,r=e.policy,n=e.policyType;return l().createElement(p.TextContent,null,l().createElement(f.Link,{to:"/scappolicies/"+t},r.name),l().createElement(x,null,n))};d.propTypes={id:u().string,policy:u().object,policyType:u().string};const h=[{title:"Name",props:{width:45},sortByProp:"name",renderFunc:(0,m.SO)(d)},{title:"Operating system",transforms:[a.fitContent],props:{width:15},sortByProp:"majorOsVersion",renderFunc:function(e,t,r){return"RHEL ".concat(r.majorOsVersion)}},{title:"Systems",props:{width:15},sortByProp:"totalHostCount",renderFunc:function(e,t,r){return r.totalHostCount>0?r.totalHostCount:l().createElement(ve,{count:r.totalHostCount,variant:"count"})}},{title:"Business objective",sortByFunction:function(e){var t;return null==e||null===(t=e.businessObjective)||void 0===t?void 0:t.title},renderFunc:function(e,t,r){return r.businessObjective&&r.businessObjective.title||"--"}},{title:"Compliance threshold",sortByProp:"complianceThreshold",renderFunc:function(e,t,r){return"".concat(r.complianceThreshold,"%")}}],y=function(){return l().createElement(a.Table,{"aria-label":"policies-table",ouiaId:"PoliciesTable",cells:h,rows:(0,o.Z)(Array(5)).map((function(){return{cells:[{title:l().createElement(c.Z,null),colSpan:5}]}}))},l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null))};var v=r(22122),b=r(81253),g=r(43047),E=r(98446),O=r(27839),P=["error"],w=function(e){var t=e.error,r=(0,b.Z)(e,P);return t.networkError&&401===t.networkError.statusCode?(window.insights.chrome.auth.logout(!0),!1):t.networkError&&403===t.networkError.statusCode?l().createElement(O.Z,{serviceName:"Compliance"}):t.networkError&&404===t.networkError.statusCode?l().createElement(E.Z,null):l().createElement("section",(0,v.Z)({},r,{className:"pf-l-page__main-section pf-c-page__main-section ins-c-component_invalid-componet"}),l().createElement(g.ZP,{size:"xl",style:{color:"var(--pf-global--danger-color--100)"}}),l().createElement(p.Title,{headingLevel:"h1"},"There was an error"),l().createElement(p.Text,null,"If you need to contact Red Hat Support about this, this is the exact error:",l().createElement(p.Text,null,t.message)),l().createElement(p.Button,{variant:"link",ouiaId:"ErrorPageGoBackButton",onClick:history.goBack},"Go back"))};w.propTypes={error:u().object};const j=w;var T=function(e){var t=e.children;return l().createElement(p.Text,{style:{color:"var(--pf-global--Color--200)"},component:p.TextVariants.small},t)};T.propTypes={children:u().node};const x=T;var C=r(6455),Z=function(e){var t=e.input,r=e.options,n=t.name,i=t.onChange,a=t.value;return l().createElement(l().Fragment,null,r.map((function(e,t){var r=e.label,c=e.value,s=e.defaultChecked;return l().createElement(p.Checkbox,{key:c,id:c,label:r,name:"".concat(n,"[").concat(t,"]"),value:c,isChecked:""===a?s:a.includes(c),onChange:function(e){return function(e,t){var r=(0,o.Z)(new Set(a));return e?r.push(t):r.splice(r.indexOf(t),1),i(r)}(e,c)}})})))};Z.propTypes={input:u().shape({name:u().string.isRequired,onChange:u().func,value:u().string}),options:u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,defaultChecked:u().bool})).isRequired};u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,defaultChecked:u().bool})).isRequired;var S=r(50500),k=function(){return l().createElement(p.Tooltip,{position:"right",content:"A policy of this type is already in use. Only one policy per policy type can be created for a major release of RHEL."},l().createElement(p.Label,{color:"orange",style:{lineHeight:"1.5em"}},"In use"))},F=function(e){var t=e.profiles,r=e.onClick;return l().createElement(l().Fragment,null,0===(null==t?void 0:t.length)&&l().createElement(p.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(p.Text,null,"Select an operating system to view policy types.")),l().createElement(p.Grid,{hasGutter:!0},t.map((function(e){var t=e.description,n=e.name,o=e.id,i=e.disabled;return l().createElement(l().Fragment,{key:"profile-select-".concat(o)},l().createElement(p.GridItem,{span:8,rowSpan:2},l().createElement(p.TextContent,{style:{lineHeight:"2em",color:i?"var(--pf-c-content--blockquote--Color)":""}},l().createElement(p.Text,null,l().createElement(C.Z,{component:"input",type:"radio",name:"profile",value:JSON.stringify(e),onClick:function(){return r(JSON.stringify(e))},disabled:i})," ".concat(n," "),i&&l().createElement(k,null))),l().createElement(p.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(p.Text,{component:p.TextVariants.p},l().createElement(S.Z,{key:"profile-select-text-".concat(o),lines:3},t)))))}))))};F.propTypes={profiles:u().array,onClick:u().func},F.defaultProps={profiles:[],onClick:function(){return{}}};const V=F;var I=r(73479),R=r(68778),B=r(11443),L=function(e){return e.rulesPassed+e.rulesFailed===0?l().createElement(I.ZP,{color:"var(--pf-global--disabled-color--100)"}):e.compliant?l().createElement(R.ZP,{color:"var(--pf-global--success-color--200)"}):l().createElement(g.ZP,{color:"var(--pf-global--danger-color--100)"})},D=function(e){return!1===e.supported?" Unsupported":e.rulesPassed+e.rulesFailed===0?" N/A":" "+(0,B.P0)(e.score)};const A=function(e){return l().createElement(p.Text,null,e.supported?l().createElement(p.Tooltip,{content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},l().createElement(L,(0,v.Z)({key:"system-compliance-icon-".concat(e.id)},e)),D(e)):D(e))};var N=r(24561);const M=function(){return l().createElement(N.ZP,{speed:2,width:1e3,height:400,viewBox:"0 0 1000 400",backgroundcolor:"#f3f3f3",foregroundcolor:"#ecebeb"},l().createElement("rect",{x:"-3",y:"7",rx:"3",ry:"3",width:"760",height:"19"}),l().createElement("rect",{x:"823",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"910",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"6",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"68",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"133",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"3",y:"110",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"1",y:"149",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"1",y:"185",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-1",y:"224",rx:"0",ry:"0",width:"187",height:"16"}),l().createElement("rect",{x:"-4",y:"267",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-6",y:"306",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"-6",y:"342",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-8",y:"381",rx:"0",ry:"0",width:"187",height:"16"}))},H=function(){return l().createElement(N.ZP,{height:320,width:1550,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},l().createElement("rect",{x:"18",y:"50",rx:"4",ry:"4",width:"478",height:"15"}),l().createElement("rect",{x:"19",y:"18",rx:"3",ry:"3",width:"220",height:"9"}),l().createElement("circle",{cx:"118",cy:"156",r:"73"}),l().createElement("rect",{x:"1002",y:"40",rx:"0",ry:"0",width:"69",height:"23"}),l().createElement("rect",{x:"47",y:"77",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"36",y:"77",rx:"0",ry:"0",width:"16",height:"0"}),l().createElement("rect",{x:"409",y:"149",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"214",y:"145",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"216",y:"119",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"526",y:"100",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"122",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"146",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"170",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"194",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"218",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"529",y:"275",rx:"0",ry:"0",width:"231",height:"7"}))};var _=r(67585),q=r(56163),G=r.n(q),Y=function(e){var t=e.policy;return l().createElement(p.Card,{ouiaId:"PolicyDetailsCard"},l().createElement(p.CardHeader,null,l().createElement(p.Text,{style:{fontSize:20}},l().createElement("b",null,"Policy details"))),l().createElement(p.CardBody,null,l().createElement(p.TextContent,null,l().createElement(p.Text,{component:p.TextVariants.h5},"Compliance threshold",l().createElement(We,null)),l().createElement(p.Text,{className:"threshold-tooltip",component:p.TextVariants.p},(0,B.P0)(t.complianceThreshold,1)),l().createElement(p.Text,{component:p.TextVariants.h5},"Business objective",l().createElement($e,null)),l().createElement(p.Text,{component:p.TextVariants.p},t.businessObjective&&t.businessObjective.title||"-"),l().createElement(p.Text,{component:p.TextVariants.h5},"Policy description"),l().createElement(p.Text,{component:p.TextVariants.p},l().createElement(_.Z,{text:G()(t.description||""),length:380,inline:!0})),l().createElement(p.Text,{component:p.TextVariants.h5},"Operating system"),l().createElement(p.Text,{component:p.TextVariants.p},"RHEL ",t.majorOsVersion),l().createElement(p.Text,{component:p.TextVariants.h5},"Policy type "),l().createElement(p.Text,{component:p.TextVariants.p},t.policyType),l().createElement(p.Text,{component:p.TextVariants.h5},"Reference ID"),l().createElement(p.Text,{component:p.TextVariants.p},t.refId))))};Y.propTypes={policy:u().object};const z=Y;var K=["children"],J=["children"],U={children:u().node},W=function(e){var t=e.children,r=(0,b.Z)(e,K);return l().createElement(p.TextListItem,(0,v.Z)({},r,{component:p.TextListItemVariants.dt}),t)};W.propTypes=U;var $=function(e){var t=e.children,r=(0,b.Z)(e,J);return l().createElement(p.TextListItem,(0,v.Z)({},r,{component:p.TextListItemVariants.dd}),t)};$.propTypes=U;var Q=function(e){var t=e.profile;return l().createElement(l().Fragment,null,l().createElement(p.TextList,{component:p.TextListVariants.dl},l().createElement(W,null,l().createElement(p.Text,{className:"ins-c-non-bold-h2"},"Policy details")),l().createElement(W,null,"Operating system"),l().createElement($,null,"RHEL ",t.majorOsVersion),l().createElement(W,null,"Compliance threshold"),l().createElement($,null,(0,B.P0)(t.complianceThreshold,1)),l().createElement(W,null,"Business objective"),l().createElement($,null,t.businessObjective?t.businessObjective.title:"--")),l().createElement(f.Link,{to:"/scappolicies/"+t.policy.id},"View policy"))};Q.propTypes={profile:u().shape({id:u().string,complianceThreshold:u().number,businessObjective:u().object,majorOsVersion:u().string,policy:u().shape({id:u().string}),benchmark:u().shape({version:u().string})})};var X=function(e){var t=e.profile;return l().createElement(p.TextContent,{className:"policy-details"},l().createElement(Q,{profile:t}))};X.propTypes={profile:u().object};const ee=X;var te=r(48273),re=function(e){var t,r,n=e.percent,o=e.failed;return 100===n?(r="Success",t=te.ProgressVariant.success):o?(r="Error",t=te.ProgressVariant.danger):(r="Progress",t=te.ProgressVariant.info),l().createElement(te.Progress,{id:"finished-create-policy",value:n,title:r,variant:t,className:"wizard-progress-bar"})};re.propTypes={percent:u().number,failed:u().bool};const ne=re;var oe=r(52710),ie=["children","defaultTab","level"],le=function(e){return e.children},ae=function(e,t){var r=(0,oe.Wb)(e).split("|");return{levels:r,currentAnchor:r[t]||e}};u().number,u().node;var ce=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=ae(r,n).currentAnchor;return t.map((function(e){return e.props.eventKey===o?e:void 0})).filter((function(e){return!!e}))};ce.propTypes={children:u().node,defaultTab:u().string,level:u().number},ce.defaultProps={level:0};var se=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=(0,b.Z)(e,ie),i=(0,f.useHistory)().push,a=(0,f.useLocation)(),c=a.pathname,s=a.state,u=ae(r,n),m=u.currentAnchor,d=u.levels;return l().createElement(p.Tabs,(0,v.Z)({},o,{onSelect:function(e,t){e.preventDefault();var r=t.replace("#",""),o=d;o[n]=r,i({state:s,to:c,hash:o.slice(0,n+1).join("|")})},activeKey:m}),t)};se.defaultProps={level:0},se.propTypes={children:u().node,defaultTab:u().string,level:u().number};var ue=function(e){return e.children},pe={stateValues:u().object,children:u().node},fe=function(e){var t=e.stateValues;return e.children.flatMap((function(e){return e})).filter((function(e){return t[e.props.stateKey]}))};fe.propTypes=pe;var me=function(e){var t=e.stateValues,r=e.children;return l().createElement(fe,{stateValues:t},l().createElement(ue,{key:"error-state",stateKey:"error"},l().createElement(j,{error:t.error})),r)};me.propTypes=pe;var de="Policies without systems will not have reports.",he=function(e){var t=e.showTooltip,r=e.children;return t?l().createElement(p.Tooltip,{position:p.TooltipPosition.bottom,content:de},r):r};he.propTypes={showTooltip:u().bool,children:u().node};var ye=function(e){var t,r=e.count,n=e.variant;switch(n){case"count":t=r;break;case"compact":t="No Systems";break;case"full":t=de;break;default:t=r}return l().createElement(he,{showTooltip:"count"===n||"compact"===n},l().createElement(Ee,null,t))};ye.defaultProps={variant:"compact"},ye.propTypes={count:u().number.isRequired,variant:u().string};const ve=ye;var be=r(69957),ge=function(e){var t=e.children;return l().createElement(l().Fragment,null,l().createElement(be.ZP,{className:"ins-u-warning"}),l().createElement(p.Text,{component:"span",className:"ins-c-warning-text"}," ",t))};ge.propTypes={children:u().node};const Ee=ge;var Oe=r(96156),Pe=["to","hash","children","state","backgroundLocation"];function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,Oe.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Te=function(e){var t=e.to,r=e.hash,n=e.children,o=e.state,i=e.backgroundLocation,a=(0,b.Z)(e,Pe),c=je(je({},(0,f.useLocation)()),i),s=je(je({},o),{},{background:c});return l().createElement(f.Link,(0,v.Z)({to:{pathname:t,state:s,hash:r}},a),n)};Te.propTypes={backgroundLocation:u().object,children:u().node,hash:u().string,state:u().object,to:u().string.isRequired};const xe=Te;var Ce=["href"],Ze=["children"],Se=function(e){var t=e.href,r=(0,b.Z)(e,Ce);return l().createElement(f.Link,(0,v.Z)({},r,{to:t}))};Se.propTypes={href:u().string};var ke=function(e){var t=e.children,r=(0,b.Z)(e,Ze);return l().createElement(p.BreadcrumbItem,(0,v.Z)({},r,{component:Se}),t)};ke.propTypes={children:u().node};const Fe=ke;var Ve=r(86052),Ie=function(e){var t;return l().createElement(p.TextContent,null,l().createElement(f.Link,{to:"/reports/"+e.id,style:{marginRight:".5rem"}},null===(t=e.policy)||void 0===t?void 0:t.name),l().createElement(l().Fragment,null,l().createElement(Ue,{profile:e,position:"right"}),l().createElement(x,null,e.policyType)))};Ie.propTypes={profile:u().object};var Re=function(e){var t=e.majorOsVersion,r=e.ssgVersion,n=e.unsupportedHostCount,o=e.policy,i=0===n;return r="SSG: "+r,l().createElement(l().Fragment,null,"RHEL ",t,null===o&&r&&l().createElement(p.Text,null,l().createElement(x,null,i?r:l().createElement(bt.Z,null,r))))};Re.propTypes={majorOsVersion:u().string,ssgVersion:u().string,unsupportedHostCount:u().number,policy:u().object};var Be=function(e){var t=e.testResultHostCount,r=void 0===t?0:t,n=e.compliantHostCount,o=void 0===n?0:n,i=e.unsupportedHostCount,a=void 0===i?0:i;return l().createElement(l().Fragment,null,l().createElement(p.Progress,{measureLocation:"outside",value:r?100/r*o:0}),l().createElement(x,null,"".concat(o," of ").concat(r," systems "),a>0&&l().createElement(bt.Z,{tooltipText:"Insights cannot provide a compliance score for systems running an unsupported version of the SSG at the time this report was created, as the SSG version was not supported by RHEL.",style:{marginLeft:".5em"}},l().createElement("strong",{className:"ins-c-warning-text"},a," unsupported"))))};Be.propTypes={testResultHostCount:u().number,compliantHostCount:u().number,unsupportedHostCount:u().number};const Le=[{title:"Policy",sortByProp:"name",props:{width:55},renderFunc:(0,m.SO)(Ie)},{title:"Operating system",transforms:[a.fitContent],sortByProp:"majorOsVersion",props:{width:20},renderFunc:(0,m.SO)(Re)},{title:"Systems meeting compliance",transforms:[a.fitContent],sortByFunction:function(e){return 100/e.testResultHostCount*e.compliantHostCount},props:{width:25},renderFunc:(0,m.SO)(Be)}];var De=r(28481),Ae=r(89421),Ne=[{type:Ae.Yu.text,label:"Policy name",filter:function(e,t){var r=t.toLowerCase();return e.filter((function(e){return[e.name,e.policy.name].join().toLowerCase().includes(r)}))}}],Me=function(e){return[{type:Ae.Yu.checkbox,label:"Policy type",filter:function(e,t){return e.filter((function(e){var r=e.policyType;return t.includes(r)}))},items:e.map((function(e){return{label:e,value:e}}))}]},He=function(e){return[{type:Ae.Yu.checkbox,label:"Operating system",filter:function(e,t){return e.filter((function(e){var r=e.majorOsVersion;return t.includes(r)}))},items:e.map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]},_e=[{type:Ae.Yu.checkbox,label:"Systems meeting compliance",filter:function(e,t){return e.filter((function(e){var r=e.testResultHostCount,n=e.compliantHostCount,o=Math.round(100/r*n);return t.map((function(e){var t=e.split("-"),r=(0,De.Z)(t,2),n=r[0],i=r[1];return o>=n&&o<=i})).filter((function(e){return!!e})).length>0}))},items:[{label:"90 - 100%",value:"90-100"},{label:"70 - 89%",value:"70-89"},{label:"50 - 69%",value:"50-69"},{label:"Less than 50%",value:"0-49"}]}],qe=function(e){var t=e.profiles,r=(0,m.jj)(t.map((function(e){return e.policyType})).filter((function(e){return!!e}))),n=(0,m.jj)(t.map((function(e){return e.majorOsVersion})).filter((function(e){return!!e})));return l().createElement(Ve.v,{"aria-label":"Reports",ouiaId:"ReportsTable",columns:Le,items:t,emptyRows:et,isStickyHeader:!0,filters:{filterConfig:[].concat((0,o.Z)(Ne),(0,o.Z)(r.length>0&&Me(r)||[]),(0,o.Z)(n.length>0&&He(n)||[]),(0,o.Z)(_e))}})};qe.propTypes={profiles:u().array};const Ge=qe;var Ye=r(19949);const ze=function(){return l().createElement(Ye.Z,{title:"No policies are reporting",mainButton:l().createElement(xe,{to:"/scappolicies/new"},l().createElement(p.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))})};var Ke=r(91290),Je=function(e){var t=e.profile,r=e.position,n=void 0===r?"top":r,o=t.policy,i=t.policyType,a=t.complianceThreshold,c=t.majorOsVersion,s=t.businessObjective;return l().createElement(p.Popover,{position:n,headerContent:l().createElement(p.TextContent,null,null==o?void 0:o.name,l().createElement(p.Text,{component:p.TextVariants.small},i)),footerContent:l().createElement(f.Link,{to:"/scappolicies/"+(null==o?void 0:o.id)},"View policy"),bodyContent:l().createElement(p.TextContent,{className:"policy-details"},l().createElement(p.TextList,{component:p.TextListVariants.dl},l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Operating system"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},"RHEL ",c),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Compliance threshold"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},(0,B.P0)(a,1)),s&&l().createElement(l().Fragment,null,l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Business objective"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},s.title))))},l().createElement(p.Button,{variant:"link",ouiaId:"PopoverViewPolicyLink",isInline:!0},l().createElement(Ke.ZP,{className:"grey-icon"})))};Je.propTypes={profile:u().object,position:u().string};const Ue=Je,We=function(){return l().createElement(p.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,'The compliance threshold defines what percentage of rules must be met in order for a system to be determined "compliant".')},l().createElement("span",null," ",l().createElement(Ke.ZP,{className:"grey-icon"})))},$e=function(){return l().createElement(p.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,"This is an optional field that can be used to label policies that are related to specific business objectives.")},l().createElement("span",null," ",l().createElement(Ke.ZP,{className:"grey-icon"})))};var Qe=r(92223),Xe=function(){return l().createElement(Qe.Z,null,l().createElement(p.Bullseye,null,l().createElement(p.EmptyState,{variant:p.EmptyStateVariant.full},l().createElement(p.Title,{headingLevel:"h5",size:"lg"},"No matching policies found"),l().createElement(p.EmptyStateBody,null,"This filter criteria matches no policies. ",l().createElement("br",null)," Try changing your filter settings."))))},et=[{cells:[{title:function(){return l().createElement(Xe,null)},props:{colSpan:3}}]}],tt={type:Ae.Yu.text,label:"Name",filter:function(e,t){return e.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())}))}},rt=function(){return l().createElement("div",null,l().createElement(xe,{to:"/scappolicies/new"},l().createElement(p.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy")))},nt=function(e){var t=e.policies,r=e.location,o=e.history,i=Object.values(n);return l().createElement(Ve.v,{"aria-label":"Policies",ouiaId:"PoliciesTable",className:"compliance-policies-table",columns:h,items:t,emptyRows:et,isStickyHeader:!0,filters:{filterConfig:i},options:{dedicatedAction:rt},actionResolver:function(){return[{title:"Delete policy",onClick:function(e,n,i){var l=i.itemId,a=t.find((function(e){return e.id===l}));o.push("/scappolicies/".concat(l,"/delete"),{policy:a,background:r})}},{title:"Edit policy",onClick:function(e,n,i){var l=i.itemId,a=t.find((function(e){return e.id===l}));o.push("/scappolicies/".concat(l,"/edit"),{policy:a,background:r,state:{policy:a}})}}]}})};nt.propTypes={policies:u().array.isRequired,history:u().object.isRequired,location:u().object.isRequired},nt.defaultProps={policies:[]};const ot=(0,f.withRouter)(nt);var it=r(6610),lt=r(5991),at=r(63349),ct=r(10379),st=r(46070),ut=r(77608),pt=r(46314),ft=r(74726),mt=r(59854),dt=r.n(mt),ht=r(70597);var yt=function(e){(0,ct.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,ut.Z)(t);if(r){var o=(0,ut.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,st.Z)(this,e)});function o(){var e;(0,it.Z)(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r)),(0,Oe.Z)((0,at.Z)(e),"state",{validThreshold:(0,ht.KJ)(e.props.previousThreshold),threshold:dt()(e.props.previousThreshold||100,1)}),(0,Oe.Z)((0,at.Z)(e),"handleThresholdChange",(function(t){return e.setState({validThreshold:(0,ht.KJ)(t),threshold:dt()(t,1)})})),e}return(0,lt.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.threshold,r=e.validThreshold;return l().createElement(l().Fragment,null,l().createElement(p.FormGroup,{fieldId:"policy-threshold",validated:r?"default":"error",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended",labelIcon:l().createElement(We,null),label:"Compliance threshold (%)"},l().createElement(C.Z,{name:"complianceThreshold",id:"complianceThreshold",isRequired:!0,onChange:this.handleThresholdChange,validated:r?"default":"error",defaultValue:t,"aria-label":"compliance threshold",component:ft._c,type:"number",style:{width:"60%",display:"block"}})))}}]),o}(l().Component);yt.propTypes={previousThreshold:u().number};const vt=(0,pt.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(yt);var bt=r(21262),gt=r(15265);const Et=function(){return l().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:bt.i},"Supported SSG versions ",l().createElement(gt.ZP,null))};var Ot=function(e){var t=e.children;return l().createElement(p.Text,{component:"h2",style:{color:"var(--pf-global--Color--200)",lineHeight:"2rem"}},t)};Ot.propTypes={children:u().node};const Pt=Ot;var wt=r(10530);const jt=function(){return l().createElement(p.Bullseye,null,l().createElement(p.EmptyState,{variant:p.EmptyStateVariant.full},l().createElement(p.Title,{headingLevel:"h2",size:"lg",style:{fontWeight:"bold"}},"No systems on this policy"),l().createElement(p.EmptyStateBody,null,l().createElement(p.TextContent,null,l().createElement(p.Text,{component:p.TextVariants.p},"Add systems to this policy from the systems page"),l().createElement(p.Text,{style:{color:"var(--pf-global--warning-color--100)"}},l().createElement(be.ZP,null)," ",de)))))};var Tt=r(91989),xt=["children","href"];const Ct=function(e){var t=e.children,r=e.href,n=(0,b.Z)(e,xt);return r&&l().createElement("a",(0,v.Z)({href:r},n),t)||t||""}},70597:(e,t,r)=>{"use strict";r.d(t,{$H:()=>n,KJ:()=>o,Ay:()=>i,hT:()=>l,Qy:()=>a});var n=function(e,t,r){return!!(e&&t&&r)},o=function(e){return e<101&&e>=0},i=function(e,t,r){return!!(e&&t&&r&&o(r))},l=function(e){return(null==e?void 0:e.length)>0},a=function(e){return!!e&&e.length>0}},11443:(e,t,r)=>{"use strict";r.d(t,{P0:()=>n,_6:()=>o});var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=null==e?void 0:e.toFixed(t);return n?n+(r?"%":""):"N/A"},o=function(e,t,r){return r||(r=t+"s"),e>1||0===e?r:t}},79886:(e,t,r)=>{"use strict";r.d(t,{jj:()=>c,Sj:()=>s,SO:()=>u,dY:()=>f,qk:()=>m,$s:()=>d,eV:()=>h});var n=r(22122),o=r(85061),i=r(92950),l=r.n(i),a=r(64640),c=function(e){return(0,o.Z)(new Set(e))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(r,n){var o="asc"!=t,i=r&&r[e]||"",l=n&&n[e]||"";return(0,a.Z)({desc:o})(i,l)}},u=function(e,t){return function(r,o,i){return l().createElement(e,(0,n.Z)({},i,t))}},p=function(e,t){return"function"==typeof e?e(t):t[e]},f=function(e,t,r){return t.sort((function(t,n){return"asc"===r?String(p(e,t)).localeCompare(String(p(e,n))):-String(p(e,t)).localeCompare(String(p(e,n)))}))},m=function(e,t,r,n){var o=r.flatMap((function(r){return e.filter((function(e){return e[t]===r}))}));return"asc"!==n?o.reverse():o},d=function e(t,r,n){var o=r.split("."),i=o.shift();return void 0!==t[i]?o.length>0?e(t[i],o.join("."),n):t[i]:n},h=function(e){return e.split(/[-_\W]+/g).map((function(e){return e.trim()})).map((function(e){return e[0].toUpperCase()+e.substring(1)})).join("")}},86052:(e,t,r)=>{"use strict";r.d(t,{v:()=>Q});var n=r(96156),o=r(37948),i=r(28481),l=r(85061),a=r(92950),c=r.n(a),s=r(6877),u=r(79886);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(e){return e.map((function(e){return f(f({},e),function(e){return e.sortByProp||e.sortByFunction}(e)?{transforms:(0,u.jj)([].concat((0,l.Z)((null==e?void 0:e.transforms)||[]),[s.sortable]))}:{})}))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return("function"==typeof e.onSelect)+(void 0!==e.detailsComponent)};const h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,a.useState)(t.sortBy||{index:0,direction:"asc"}),n=(0,i.Z)(r,2),o=n[0],l=n[1],c=function(e,t,r){return l({index:t,direction:r})},s=e[o.index-d(t)],p=function(e){return null!=s&&s.sortByArray?(0,u.qk)(e,null==s?void 0:s.sortByProp,null==s?void 0:s.sortByArray,o.direction):(0,u.dY)((null==s?void 0:s.sortByProp)||(null==s?void 0:s.sortByFunction),e,o.direction)};return{sorter:p,tableProps:{onSort:c,sortBy:o,cells:m(e)}}};function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,r=void 0===t?10:t,n=!1!==(null==e?void 0:e.pagination),o=(0,a.useState)({perPage:r,page:1}),l=(0,i.Z)(o,2),c=l[0],s=l[1],u=function(e){return s(v(v({},c),e))},p=function(e,t){return u(v(v({},c),{},{page:t}))},f=function(e,t){return u({page:1,perPage:t})},m=function(e){var t=c.page,r=c.perPage,n=(t-1)*r,o=n+r;return e.slice(n,o)},d=function(e){var t=e<0?c.page+e:e;u({page:t>0?t:1})};return n?{paginator:m,setPage:d,toolbarProps:{pagination:v(v({},c),{},{onSetPage:p,onPerPageSelect:f})}}:{}};var g=r(45697),E=r.n(g),O=r(97066),P=r(92223),w=function(e){var t=e.kind,r=void 0===t?"results":t;return c().createElement(P.Z,null,c().createElement(O.Bullseye,null,c().createElement(O.EmptyState,{variant:O.EmptyStateVariant.full},c().createElement(O.Title,{headingLevel:"h5",size:"lg"},"No matching ",r," found"),c().createElement(O.EmptyStateBody,null,"This filter criteria matches no ",r,".",c().createElement("br",null),"Try changing your filter settings."))))};w.propTypes={kind:E().string};var j=[{cells:[{title:function(){return c().createElement(w,null)},props:{colSpan:3}}]}];function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=function(e){var t,r;return e.key||(null===(t=e.original)||void 0===t?void 0:t.toLowerCase())||(null===(r=e.title)||void 0===r?void 0:r.toLowerCase())},Z=function(e,t){var r=e;return t.forEach((function(e){e&&(r=e(r))})),r},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){return Z(e,t)}))},k=function(e,t,r,n){return r.flatMap((function(r){var o=function(e,t){return x(x({},e.rowProps),{},{itemId:e.itemId,cells:t.map((function(t){return{title:t.renderFunc?t.renderFunc(void 0,void 0,e):e[C(t)]}}))})}(e,t);return r?r(o,e,t,n):o}))};const F=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.transformer,o=void 0===n?[]:n,i=r.rowTransformer,l=void 0===i?[]:i,a=r.emptyRows||j,c=o?S(e,o):e,s=null!=r&&r.filter?r.filter(c):c,u=null!=r&&r.sorter?r.sorter(s):s,p=null!=r&&r.paginator?null==r?void 0:r.paginator(u):u,f=p.length>0?p.flatMap((function(e,r){return k(e,t,l,r)})).filter((function(e){return!!e})):a,m=null!=r&&r.pagination?x(x({},r.pagination),{},{itemCount:s.length}):void 0;return{tableProps:{rows:f},toolbarProps:{pagination:m}}};var V=r(65115);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return e[t]},L=function(e,t){return R(R({},e),{},"string"==typeof t?{itemId:B(e,t)}:{itemId:t(e)})};const D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(null==t?void 0:t.identifier)||B;return e.map((function(e){return L(e,r)}))};function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=function(e,t,r){return void 0!==(null==r?void 0:r.detailsComponent)&&function(e,t,r){return{parent:2*t,fullWidth:!0,cells:[{title:c().createElement(r,{rule:e,key:"item-"+e.rowId})}]}}(e,t,r.detailsComponent)};const H=function(e){var t=!!e.detailsComponent,r=(0,a.useState)([]),n=(0,i.Z)(r,2),o=n[0],c=n[1];return t?{transformer:function(t,r,n,i){var l=o.includes(r.itemId);return[N(N({},t),{},{isOpen:l}),M(r,i,e)]},tableProps:{onCollapse:function(e,t,r,n){o.includes(n.itemId)?c(o.filter((function(e){return e!==n.itemId}))):c([].concat((0,l.Z)(o),[n.itemId]))}}}:{}},_=function(e){var t=!!e.dedicatedAction,r=e.dedicatedAction,n=e.AdditionalDedicatedActions,o=e.selected;return t?{toolbarProps:{dedicatedAction:c().createElement("div",null,r&&c().createElement(r,o&&{selected:o}),n&&c().createElement(n,o&&{selected:o}))}}:{}};function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Y=r(22122),z=r(81253),K=r(49629),J=r(32875),U=["items","columns","filters","options","toolbarProps"];function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var $=function(e){var t=e.items,r=void 0===t?[]:t,i=e.columns,l=void 0===i?[]:i,a=e.filters,u=void 0===a?[]:a,p=e.options,f=void 0===p?{}:p,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.toolbarProps,i=r.tableProps,l=D(e,r),a=h(t,r),c=a.tableProps,s=a.sorter,u=b(r),p=u.toolbarProps,f=u.setPage,m=u.paginator,d=(0,o.Z)(G(G({},r),{},{setPage:f})),y=d.toolbarProps,v=d.filter,g=d.selectedFilterToolbarProps,E=H(r),O=E.transformer,P=E.tableProps,w=(0,V.n)(G(G({},r),{},{items:s(l),filter:v,paginator:m,setPage:f})),j=w.transformer,T=w.toolbarProps,x=w.tableProps,C=w.selectedItems,Z=_(G(G({},r),{},{selected:C,additionalDedicatedActions:null==g?void 0:g.dedicatedAction})).toolbarProps,S=F(l,c.cells,{emptyRows:r.emptyRows,transformer:[j],rowTransformer:[O],pagination:null==p?void 0:p.pagination,paginator:m,filter:v,sorter:s}),k=S.toolbarProps,I=S.tableProps,R=G(G(G(G(G(G(G({},p),T),y),g),Z),k),n),B=G(G(G(G(G({cells:t},I),c),x),P),i);return{toolbarProps:R,tableProps:B}}(r,l,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({filters:u,toolbarProps:e.toolbarProps,tableProps:(0,z.Z)(e,U)},f)),d=m.toolbarProps,y=m.tableProps;return c().createElement(c().Fragment,null,c().createElement(K.Z,d),c().createElement(s.Table,y,c().createElement(s.TableHeader,null),c().createElement(s.TableBody,null)),c().createElement(J.Z,{isFooter:!0},c().createElement(O.Pagination,(0,Y.Z)({variant:O.PaginationVariant.bottom},d.pagination))))};$.propTypes={items:E().array.isRequired,columns:E().arrayOf(E().shape({title:E().node,transforms:E().array,sortByProperty:E().string,sortByArray:E().array,sortByFunction:E().func,renderFunc:E().func})).isRequired,filters:E().object,options:E().object,toolbarProps:E().object};const Q=$},65115:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b,n:()=>E});var n=r(81253),o=r(96156),i=r(92137),l=r(28481),a=r(85061),c=r(87757),s=r.n(c),u=r(92950),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e.itemId)}))},f=["selectNone","selectedIds"];function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=function(e){return e?"Unselect":"Select"},y=function(e){return e.map((function(e){return e.itemId}))},v=function(e,t){return Array.from(new Set([].concat((0,a.Z)(e),(0,a.Z)(t))))},b=function(e){var t,r,n,o=e.total,a=e.onSelect,c=e.preselected,p=e.itemIdsInTable,f=e.itemIdsOnPage,m=e.identifier,d=void 0===m?"id":m,y=!!a,b=(0,u.useState)(c),g=(0,l.Z)(b,2),E=g[0],O=g[1],P=(E||[]).length,w=f().length,j=P===o,T=0===P,x=(t=f(),0!==(r=E||[]).length&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e)})).length===e.length}(t,r)),C=0===o,Z=0!==(n=P)&&(n===o||null),S=function(e,t){return"".concat(e," selected")}(P),k=function(){var e=(0,i.Z)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:r=e.sent,O(r),a&&a(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(e){return v(E,e)},V=function(e){return E.filter((function(t){return!e.includes(t)}))},I=function(){return[]},R=function(){return k(I)},B=function(){return k((function(){var e=f();return v(E,e).length===E.length?V(e):F(e)}))};return(0,u.useEffect)((function(){O(c)}),[c]),y?{selectedIds:E,selectNone:R,tableProps:{onSelect:o>0?function(e,t,r,n){return k((function(){return t?F([n[d]]):V([n[d]])}))}:void 0,canSelectAll:!1},toolbarProps:{bulkSelect:{toggleProps:{children:[S]},isDisabled:C,items:[{title:"Select none",onClick:R,props:{isDisabled:T}},{title:"".concat(h(x)," page (").concat(w," items)"),onClick:B},{title:"".concat(h(j)," all (").concat(o," items)"),onClick:function(){return k((0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=4;break}e.t0=[],e.next=9;break;case 4:return e.t1=F,e.next=7,p();case 7:e.t2=e.sent,e.t0=(0,e.t1)(e.t2);case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)}))))}}],checked:Z,onSelect:C?void 0:B}}}:{}},g=function(e,t){return d(d({},e),{},{rowProps:{selected:(t||[]).includes(e.itemId)}})},E=function(e){var t=e.onSelect,r=e.items,o=e.filter,i=e.paginator,l=e.preselected,a=e.setPage,c=!!t,s=r.map((function(e){return g(e,l)})),m=s.length,h=o?o(s):s,v=h.length,E=v!==m,O=i?i(h):h,P=O.length,w=E?v:m,j=(0,u.useMemo)((function(){return a}),[]);(0,u.useEffect)((function(){0===P&&j(-1)}),[P,j]);var T=b({total:w,onSelect:t,preselected:l,itemIdsInTable:function(){return y(E?h:s)},itemIdsOnPage:function(){return y(O)},identifier:"itemId"}),x=T.selectNone,C=T.selectedIds,Z=(0,n.Z)(T,f);return c?d({transformer:function(e){return g(e,C)},selectedItems:p(s,C),selected:C,clearSelection:x},Z):{}}},37948:(e,t,r)=>{"use strict";r.d(t,{Z:()=>k});var n=r(85061),o=r(96156),i=r(28481),l=r(90484),a=r(92950),c=r.n(a),s=r(81253),u=r(6610),p=r(89421),f=function(e){return e.split(" ").join("").toLowerCase()};const m=function e(t){var r=this;(0,u.Z)(this,e),(0,o.Z)(this,"buildFilterFilterString",(function(e,t){var r=e.type,n=e.filterString;if("hidden"!==r&&!t)return[];switch(r){case p.Yu.text:return[n(t)];case p.Yu.checkbox:return t.map((function(e){return n(e)}));case p.Yu.group:return n(t);case"hidden":return n();default:return[]}})),(0,o.Z)(this,"combineFilterStrings",(function(e){var t=e.map((function(e){return e.length})).filter((function(e){return e>0})).length>=2;return e.map((function(e){return e.join(" or ")})).join(t?" and ":"")})),(0,o.Z)(this,"buildFilterString",(function(e){var t=r.config.map((function(t){return r.buildFilterFilterString(t,e[f(t.label)])})).filter((function(e){return e.length>0}));return r.combineFilterStrings(t)})),this.filterConfig=t,this.config=this.filterConfig.config};var d=function(e){return function(t){return String(t.value)===String(e)}};const h=function e(t){var r=this;(0,u.Z)(this,e),(0,o.Z)(this,"textFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:t}]}:null})),(0,o.Z)(this,"checkboxFilterChip",(function(e,t){return t&&t.length>0?{category:e,chips:t.map((function(t){return{name:r.filterConfig.labelForValue(t,e)}}))}:null})),(0,o.Z)(this,"radioFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:r.filterConfig.labelForValue(t,e)}]}:null})),(0,o.Z)(this,"groupFilterChip",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=Object.keys(t).flatMap((function(e){var n=r.items.find(d(e));return Object.keys(t[e]).map((function(r){return t[e][r]?null==n?void 0:n.items.find(d(r)):null}))})).filter((function(e){return!!e}));return t&&n.length>0?{category:e,chips:n.map((function(e){return{name:e.label}}))}:null})),(0,o.Z)(this,"chipFor",(function(e,t){var n=r.filterConfig.getCategoryForLabel(e),o=n||{label:e,type:null},i=o.label;switch(o.type){case p.Yu.text:return r.textFilterChip(i,t);case p.Yu.checkbox:return r.checkboxFilterChip(i,t);case p.Yu.radio:return r.radioFilterChip(i,t);case p.Yu.group:return r.groupFilterChip(i,t,n);default:return null}})),(0,o.Z)(this,"chipsFor",(function(e){return Object.keys(e).map((function(t){return r.chipFor(t,e[t])})).filter((function(e){return!!e}))})),this.filterConfig=t,this.config=this.filterConfig.config};function y(e){var t=function(e,t){if("object"!==(0,l.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!==(0,l.Z)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===(0,l.Z)(t)?t:String(t)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e){return"Filter by ".concat(e.toLowerCase())};var E=r(97066),O=r(45697),P=r.n(O),w=function(e){var t=e.isChecked,r=e.setActiveFilter;return c().createElement(E.Switch,{label:"Selected only",isChecked:t,onChange:function(){return r("selected",!t)}})};w.propTypes={isChecked:P().bool,setActiveFilter:P().func};const j=w,T=function(e){var t=e.setActiveFilter,r=e.activeFilters,n=!!e.selectedFilter,o={type:"hidden",label:"selectFilter",key:"selected",default:!0,filter:function(e,t){return e.filter((function(e){var r;return(null==e||null===(r=e.rowProps)||void 0===r?void 0:r.selected)===t}))}},i=!0===r.selected;return n?{filterItem:o,toolbarProps:{dedicatedAction:c().createElement(j,{setActiveFilter:t,isChecked:i})}}:{}};function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e){return Object.values(e).filter((function(e){return(0,l.Z)(e)===Object?Object.values(e).length>0:(0,l.Z)(e)===Array?e.length>0:!!e}))},S=new function e(t){var r=this;(0,u.Z)(this,e),(0,o.Z)(this,"chipBuilder",null),(0,o.Z)(this,"filterBuilder",null),(0,o.Z)(this,"addConfigItem",(function(e){return r.config=r.config.filter((function(t){return t.label!==e.label})).concat(e)})),(0,o.Z)(this,"getChipBuilder",(function(e){return e&&(r.config=e),r.chipBuilder=r.chipBuilder?r.chipBuilder:new h(r)})),(0,o.Z)(this,"getFilterBuilder",(function(e){return e&&(r.config=e),r.filterBuilder=r.filterBuilder?r.filterBuilder:new m(r)})),(0,o.Z)(this,"toTextFilterConfig",(function(e,t,r){return{type:p.Yu.text,label:e.label,placeholder:g(e.label),id:f(e.label),filterValues:(0,o.Z)({value:r},e.event||"onChange",(function(r,n){t(f(e.label),n)}))}})),(0,o.Z)(this,"toCheckboxFilterConfig",(function(e,t,r){return{type:p.Yu.checkbox,label:e.label,placeholder:g(e.label),id:f(e.label),filterValues:{value:r,items:e.items,onChange:function(r,n){t(f(e.label),n)}}}})),(0,o.Z)(this,"toRadioFilterConfig",(function(e,t,r){return{type:p.Yu.radio,label:e.label,placeholder:g(e.label),id:f(e.label),filterValues:{value:r,items:e.items,onChange:function(r,n){t(f(e.label),n)}}}})),(0,o.Z)(this,"toGroupedFilterConfig",(function(e,t,r){return{type:p.Yu.group,label:e.label,id:f(e.label),filterValues:{selected:r,onChange:function(r,n){t(f(e.label),n)},groups:e.items.map((function(e){return b(b({},e),{},{type:"checkbox",items:e.items.map((function(e){return b(b({},e),{},{type:"checkbox"})}))})}))}}})),(0,o.Z)(this,"toFilterConfigItem",(function(e,t,n){switch(e.type){case p.Yu.text:return r.toTextFilterConfig(e,t,n);case p.Yu.checkbox:return r.toCheckboxFilterConfig(e,t,n);case p.Yu.radio:return r.toRadioFilterConfig(e,t,n);case p.Yu.group:return r.toGroupedFilterConfig(e,t,n);default:return null}})),(0,o.Z)(this,"buildConfiguration",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;return b(b({},n),{},{items:(o||r.config).map((function(n){return r.toFilterConfigItem(n,e,t[f(n.label)])})).filter((function(e){return!!e}))})})),(0,o.Z)(this,"defaultValueForFilter",(function(e){switch(e.type){case p.Yu.text:return"";case p.Yu.checkbox:return[];case"hidden":return e.default||!1;default:return}})),(0,o.Z)(this,"initialDefaultState",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={};return(t||r.config).forEach((function(t){var o=f(t.key||t.label);n[o]=e[o]||r.defaultValueForFilter(t)})),n})),(0,o.Z)(this,"categoryLabelForValue",(function(e){var t=r.config.filter((function(t){return!!t.items&&t.items.map((function(e){return e.value})).includes(e)}))[0];return t?t.label:e})),(0,o.Z)(this,"getCategoryForLabel",(function(e){return r.config.filter((function(t){return f(t.key||t.label)===f(e)}))[0]||{}})),(0,o.Z)(this,"getItemByLabelOrValue",(function(e,t){var n=r.getCategoryForLabel(t),o=((n.type!==p.Yu.group?n.items:n.items.flatMap((function(e){return e.items.map((function(t){return b(b({},t),{},{parentValue:e.value})}))})))||[]).filter((function(t){return t.value===e||t.label===e}));return 1===o.length?o[0]:o.length>1?(console.info("Multiple items found for ".concat(e," in ").concat(t,"! Returning first one.")),o[0]):void console.info("No item found for "+e+" in ",t)})),(0,o.Z)(this,"labelForValue",(function(e,t){var n=r.getItemByLabelOrValue(e,t);return n?n.label:e})),(0,o.Z)(this,"valueForLabel",(function(e,t){var n=r.getItemByLabelOrValue(e,t);return n?n.value:e})),(0,o.Z)(this,"applyFilterToObjectArray",(function(e,t){var o=(0,n.Z)(e);return Object.keys(t).forEach((function(e){var n=r.getCategoryForLabel(e),i=t[e];n&&i&&(i.length>0||"hidden"===n.type&&"boolean"==typeof i)&&(o=n.filter(o,i))})),o})),(0,o.Z)(this,"removeFilterFromFilterState",(function(e,t){return"string"==typeof e?"":e.filter((function(e){return e!==t}))})),(0,o.Z)(this,"removeFilterFromGroupFilterState",(function(e,t,r){var n=e[r.parentValue],i=r.value,l=(n[i],(0,s.Z)(n,[i].map(y)));return b(b({},e),{},(0,o.Z)({},r.parentValue,l))})),(0,o.Z)(this,"removeFilterWithChip",(function(e,t){var n=e.category,i=e.chips[0].name,l=r.getItemByLabelOrValue(i,n),a=l?l.value:i,c=f(n),s=t[c],u=(r.getCategoryForLabel(n).type===p.Yu.group?r.removeFilterFromGroupFilterState:r.removeFilterFromFilterState)(s,a,l);return b(b({},t),{},(0,o.Z)({},c,u))})),this.config=t}([]);const k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filters,r=e.setPage,l=e.selectedFilter,c=!!t,s=t||{},u=s.filterConfig,p=void 0===u?[]:u,f=s.activeFilters,m=(0,a.useState)(S.initialDefaultState(f,p)),d=(0,i.Z)(m,2),h=d[0],y=d[1],v=function(e,t){y(C(C({},h),{},(0,o.Z)({},e,t))),r&&r(1)},b=function(e){S.addConfigItem(e),y(S.initialDefaultState(h))},g=function(){return y(S.initialDefaultState())},E=function(e){return y(S.removeFilterWithChip(e,h))},O=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?g():E(t[0])},P=function(e){return S.applyFilterToObjectArray(e,h)},w=T({activeFilters:h,setActiveFilter:v,selectedFilter:l}),j=w.toolbarProps,x=w.filterItem,k=(0,a.useMemo)((function(){return Z(h)}),[h]),F=[].concat((0,n.Z)(p),(0,n.Z)(x?[x]:[]));return(0,a.useEffect)((function(){return S.config=[],F.filter((function(e){return!!e})).forEach(b),y(S.initialDefaultState(f||[]),p),function(){S.config=[]}}),[]),c?{filter:P,selectedFilterToolbarProps:j,toolbarProps:{filterConfig:S.buildConfiguration(v,h,{},F),activeFiltersConfig:{filters:S.getChipBuilder(F).chipsFor(h),onDelete:O}},setActiveFilter:v,activeFilters:h,activeFilterValues:k,addConfigItem:b,filterConfigBuilder:S,filterString:function(){return S.getFilterBuilder(F).buildFilterString(h)}}:{}}},82176:(e,t,r)=>{"use strict";r.d(t,{T4:()=>l,TU:()=>a,KI:()=>s,qN:()=>u,uJ:()=>p});var n=r(96156);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},a=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},c=function(e){return e.testResultProfiles?l(e.testResultProfiles):[]},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return e&&!!t.supported}),!0)},u=function(e){return e.map((function(e){return i(i({},e),{},{ruleObjectsFailed:c(e),supported:s(e.testResultProfiles),profiles:e.testResultProfiles})}))},p=function(e){return e.flatMap((function(e){return e.rules.map((function(t){var r=t.identifier&&JSON.parse(t.identifier);return i(i({},t),{},{references:t.references?JSON.parse(t.references):[],identifier:r&&r.label?r:null,profile:e.profile})}))}))}},75347:()=>{},36648:()=>{},31777:()=>{},34017:()=>{},59905:()=>{},64604:()=>{}}]);
//# sourceMappingURL=../sourcemaps/974.2175863d707bddded9f0.js.map